[{"authors":null,"categories":null,"content":"I am a PhD student in Quantitative Genetics of Animal Breeding at Huazhong Agricultural University. My research interests include applying genomic selection in animal breeding.\nI am always eager to learn and try new things!\n","date":1687219200,"expirydate":-62135596800,"kind":"term","lang":"en","lastmod":1687219200,"objectID":"2525497d367e79493fd32b198b28f040","permalink":"/author/quanshun-mei/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/author/quanshun-mei/","section":"authors","summary":"I am a PhD student in Quantitative Genetics of Animal Breeding at Huazhong Agricultural University. My research interests include applying genomic selection in animal breeding.\nI am always eager to learn and try new things!","tags":null,"title":"Quanshun Mei","type":"authors"},{"authors":null,"categories":null,"content":"   Table of Contents  What you will learn Program overview Courses in this program Meet your instructor FAQs    What you will learn  Fundamental Python programming skills Statistical concepts and how to apply them in practice Gain experience with the Scikit, including data visualization with Plotly and data wrangling with Pandas  Program overview The demand for skilled data science practitioners is rapidly growing. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis posuere tellus ac convallis placerat. Proin tincidunt magna sed ex sollicitudin condimentum. Sed ac faucibus dolor, scelerisque sollicitudin nisi.\nCourses in this program  Python basics Build a foundation in Python.   Visualization Learn how to visualize data with Plotly.   Statistics Introduction to statistics for data science.   Meet your instructor Quanshun Mei FAQs Are there prerequisites? There are no prerequisites for the first course.\n How often do the courses run? Continuously, at your own pace.\n  Begin the course   ","date":1611446400,"expirydate":-62135596800,"kind":"section","lang":"en","lastmod":1611446400,"objectID":"59c3ce8e202293146a8a934d37a4070b","permalink":"/courses/example/","publishdate":"2021-01-24T00:00:00Z","relpermalink":"/courses/example/","section":"courses","summary":"An example of using Wowchemy's Book layout for publishing online courses.","tags":null,"title":"ğŸ“Š Learn Data Science","type":"book"},{"authors":null,"categories":null,"content":"Build a foundation in Python.\n  1-2 hours per week, for 8 weeks\nLearn   Quiz What is the difference between lists and tuples? Lists\n Lists are mutable - they can be changed Slower than tuples Syntax: a_list = [1, 2.0, 'Hello world']  Tuples\n Tuples are immutable - they can\u0026rsquo;t be changed Tuples are faster than lists Syntax: a_tuple = (1, 2.0, 'Hello world')   Is Python case-sensitive? Yes\n","date":1609459200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1609459200,"objectID":"17a31b92253d299002593b7491eedeea","permalink":"/courses/example/python/","publishdate":"2021-01-01T00:00:00Z","relpermalink":"/courses/example/python/","section":"courses","summary":"Build a foundation in Python.\n","tags":null,"title":"Python basics","type":"book"},{"authors":null,"categories":null,"content":"Learn how to visualize data with Plotly.\n  1-2 hours per week, for 8 weeks\nLearn   Quiz When is a heatmap useful? Lorem ipsum dolor sit amet, consectetur adipiscing elit.\n Write Plotly code to render a bar chart import plotly.express as px data_canada = px.data.gapminder().query(\u0026quot;country == 'Canada'\u0026quot;) fig = px.bar(data_canada, x='year', y='pop') fig.show()  ","date":1609459200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1609459200,"objectID":"1b341b3479c8c6b1f807553b77e21b7c","permalink":"/courses/example/visualization/","publishdate":"2021-01-01T00:00:00Z","relpermalink":"/courses/example/visualization/","section":"courses","summary":"Learn how to visualize data with Plotly.\n","tags":null,"title":"Visualization","type":"book"},{"authors":null,"categories":null,"content":"Introduction to statistics for data science.\n  1-2 hours per week, for 8 weeks\nLearn The general form of the normal probability density function is:\n$$ f(x) = \\frac{1}{\\sigma \\sqrt{2\\pi} } e^{-\\frac{1}{2}\\left(\\frac{x-\\mu}{\\sigma}\\right)^2} $$\n The parameter $\\mu$ is the mean or expectation of the distribution. $\\sigma$ is its standard deviation. The variance of the distribution is $\\sigma^{2}$.   Quiz What is the parameter $\\mu$? The parameter $\\mu$ is the mean or expectation of the distribution.\n","date":1609459200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1609459200,"objectID":"6f4078728d71b1b791d39f218bf2bdb1","permalink":"/courses/example/stats/","publishdate":"2021-01-01T00:00:00Z","relpermalink":"/courses/example/stats/","section":"courses","summary":"Introduction to statistics for data science.\n","tags":null,"title":"Statistics","type":"book"},{"authors":[],"categories":null,"content":" Click on the Slides button above to view the built-in slides feature.   Slides can be added in a few ways:\n Create slides using Wowchemy\u0026rsquo;s Slides feature and link using slides parameter in the front matter of the talk file Upload an existing slide deck to static/ and link using url_slides parameter in the front matter of the talk file Embed your slides (e.g. Google Slides) or presentation video on this page using shortcodes.  Further event details, including page elements such as image galleries, can be added to the body of this page.\n","date":1906549200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1906549200,"objectID":"a8edef490afe42206247b6ac05657af0","permalink":"/talk/example-talk/","publishdate":"2017-01-01T00:00:00Z","relpermalink":"/talk/example-talk/","section":"event","summary":"An example talk using Wowchemy's Markdown slides feature.","tags":[],"title":"Example Talk","type":"event"},{"authors":[],"categories":[],"content":"\rblupADC- New features in genomis selection\rğŸ¤  In the previous version of blupADC, we have given a comprehensive description of perform BLUP analysis in genomic selection. In order to further simplify the usage of blupADC, we have incorporated R6 package, which supports oriented programming. In the below, we will give server examples of how to perform single trait and multiple traits analysis of PBLUP, GBLUP and ssGBLUP. Also, user can perform cross validation in an easy way in the latest version of blupADC.\nğŸ‘‰ Note: For the latest version of blupADC, user has to install package blupSUP at first, in which example data and software (e.g.Â DMU and BLUPF90) are included in this package .\n\rExample\rSingle-trait BLUP model\rlibrary(blupSUP)\rlibrary(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupSUP\u0026quot;)\r#prepare parameters the BLUP analysis\rblup_par=BLUPpar$new(\rphe_file=paste0(data_path,\u0026quot;/phenotype.txt\u0026quot;), phe_colnames=c(\u0026quot;Id\u0026quot;,\u0026quot;Mean\u0026quot;,\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;,\u0026quot;Litter\u0026quot;,\u0026quot;Trait1\u0026quot;,\u0026quot;Trait2\u0026quot;,\u0026quot;Age\u0026quot;),\rdmu_integer_n=5, #number of integer variable in the phenotype file (required by DMU)\ranalysis_model=\u0026quot;PBLUP_A\u0026quot;,\rkinship_file=paste0(data_path,\u0026quot;/pedigree.txt\u0026quot;))\r#define the model effect of Trait1\rmyblup=BLUP$new(fixed=Trait1~Sex+Herd_Year_Season, #fixed effect\rrandom=~Id+Litter, #random effect pars=blup_par) #blup_par has been defined previously\rmyblup\r## \u0026lt;BLUP::DMU\u0026gt; ## \u0026lt;ADCmodel::1 trait\u0026gt; ## ----Trait:Trait1~Sex(fixed)+Herd_Year_Season(fixed)+Id(random)+Litter(random)\r#BLUP analysis of Trait1\rmyblup$run(output_path=\u0026quot;D:/test\u0026quot;,task_type=\u0026quot;DMU\u0026quot;) # default using DMU #myblup$run(output_path=\u0026quot;D:/test\u0026quot;,task_type=\u0026quot;BLUPF90\u0026quot;) #using BLUPF90 for analysis \r#output of BLUP analysis\rebv=myblup$ebv #breeding value\rh2=myblup$h2 #heritability and its SE\ruser_defined_h2=myblup$cal_se(~Id1/(Id1+Litter1+Res1)) #user defined expression of calculating h2 based on delta method\r#GBLUP-A analysis myblup$pars$kinship_file=paste0(data_path,\u0026quot;/G_Ainv_col_three.txt\u0026quot;)\rmyblup$pars$analysis_model=\u0026quot;GBLUP_A\u0026quot;\rmyblup$run(task_type=\u0026quot;DMU\u0026quot;)\r#ssGBLUP-A analysis myblup$pars$kinship_file=paste0(data_path,\u0026quot;/\u0026quot;,c(\u0026quot;pedigree.txt\u0026quot;,\u0026quot;G_A_col_three.txt\u0026quot;))\rmyblup$pars$analysis_model=\u0026quot;SSBLUP_A\u0026quot;\rmyblup$run(task_type=\u0026quot;DMU\u0026quot;)\r\rMultiple traits BLUP model\rlibrary(blupSUP)\rlibrary(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupSUP\u0026quot;)\r#prepare parameters the BLUP analysis\rblup_par=BLUPpar$new(\rphe_file=paste0(data_path,\u0026quot;/phenotype.txt\u0026quot;), phe_colnames=c(\u0026quot;Id\u0026quot;,\u0026quot;Mean\u0026quot;,\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;,\u0026quot;Litter\u0026quot;,\u0026quot;Trait1\u0026quot;,\u0026quot;Trait2\u0026quot;,\u0026quot;Age\u0026quot;),\rdmu_integer_n=5, #number of integer variable in the phenotype file (required by DMU)\ranalysis_model=\u0026quot;PBLUP_A\u0026quot;,\rkinship_file=paste0(data_path,\u0026quot;/pedigree.txt\u0026quot;))\r#define the effect of Trait1 for BLUP analysis\rmyblup=BLUP$new(fixed=Trait1~Sex+Herd_Year_Season, #fixed effect\rrandom=~Id+Litter, #random effect pars=blup_par) #blup_par has been defined previously\rmyblup$run(output_path=\u0026quot;D:/test\u0026quot;,task_type=\u0026quot;DMU\u0026quot;) # default using DMU myblup\rmyblup\r## \u0026lt;BLUP::DMU\u0026gt; ## \u0026lt;ADCmodel::1 trait\u0026gt; ## ----Trait:Trait1~Sex(fixed)+Herd_Year_Season(fixed)+Id(random)+Litter(random)\r#Multiple traits analysis\r#add model effect of Trait2 in BLUP analysis\rmyblup$add_model(fixed=Trait2~Herd_Year_Season,random=~Id,covariate=~Age)\rmyblup\r## \u0026lt;BLUP::DMU\u0026gt; ## \u0026lt;ADCmodel::2 traits\u0026gt; ## ----Trait:Trait1~Sex(fixed)+Herd_Year_Season(fixed)+Id(random)+Litter(random)\r## ----Trait:Trait2~Herd_Year_Season(fixed)+Id(random)+Age(covariate)\rmyblup$run() #Multiple traits analysis #remove Trait2 in BLUP analysis #myblup$rm_model(\u0026quot;Trait2\u0026quot;) #output of BLUP analysis\rebv=myblup$ebv #breeding value\rh2=myblup$h2 #heritability and its SE\rgenR2=myblup$r2 #genetic correlation and its SE user_defined_h2=myblup$cal_se(~Id1/(Id1+Litter1+Res1)) #user defined expression of calculating h2 based on delta method\ruser_defined_genR2=myblup$cal_se(~Id1_2/sqrt(Id1 * Id2)) #user defined expression of calculating genR2 based on delta method\r#random effect names from multiple traits model were defined in: rownames(myblup$vars_se$vars_mat) \r\rCross Validation\rlibrary(blupSUP)\rlibrary(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupSUP\u0026quot;)\r#prepare parameters the BLUP analysis\rblup_par=BLUPpar$new(\rphe_file=paste0(data_path,\u0026quot;/phenotype.txt\u0026quot;), phe_colnames=c(\u0026quot;Id\u0026quot;,\u0026quot;Mean\u0026quot;,\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;,\u0026quot;Litter\u0026quot;,\u0026quot;Trait1\u0026quot;,\u0026quot;Trait2\u0026quot;,\u0026quot;Age\u0026quot;),\rdmu_integer_n=5, #number of integer variable in the phenotype file (required by DMU)\ranalysis_model=\u0026quot;PBLUP_A\u0026quot;,\rkinship_file=paste0(data_path,\u0026quot;/pedigree.txt\u0026quot;))\r#define the effect of Trait1 for BLUP analysis\rmyblup=BLUP$new(fixed=Trait1~Sex+Herd_Year_Season, #fixed effect\rrandom=~Id+Litter, #random effect pars=blup_par) #blup_par has been defined previously\r#define the training and test datasets by holdout myCV=CVpredi$new(myblup, #has been defined previously partion_type=\u0026quot;holdout\u0026quot;, #the type of data partioning\rratio=0.6) #the ratio of train_size/(train_size+test_size)\r#get the prediction accuracy myCV$predict_sets()\raccu=myCV$accuracy\rbias=myCV$bias\rtrain_set=myCV$datasets$train_sets[[1]] #train set was used in analysis\rtest_set=myCV$datasets$test_sets[[1]] #train set was used in analysis ebv_set=myCV$datasets$ebv_sets[[1]] #train set was used in analysis #define the training and test datasets by kfold myCV=CVpredi$new(myblup, #has been defined previously partion_type=\u0026quot;kfold\u0026quot;, #the type of data partioning\rratio=0.6, #the ratio of train_size/(train_size+test_size)\rkfold=5, #number of fold seed=9894) #random seed number for partioning data,default is 9894 #get the prediction accuracy myCV$predict_sets() #perform analysis in all folds #myCV$predict_sets(2) # only perform analysis in the first fold accu=myCV$accuracy\rbias=myCV$bias\rtrain_set2=myCV$datasets$train_sets[[2]] #train set was used in analysis of fold2\rtest_set2=myCV$datasets$test_sets[[2]] #train set was used in analysis of fold2\rebv_set2=myCV$datasets$ebv_sets[[2]] #train set was used in analysis of fold2\r\r\r","date":1689472848,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1689472848,"objectID":"539905e284e415014f2111580cd823f6","permalink":"/post/r6-genomic-predictionselection/blup/","publishdate":"2023-07-16T10:00:48+08:00","relpermalink":"/post/r6-genomic-predictionselection/blup/","section":"post","summary":"Object-oriented programming in GS of blupADC","tags":[],"title":"blupADC-Genomic prediction(selection)","type":"post"},{"authors":["Yuanxin Miao#","Yunxia Zhao#","Siqi Wan#","Quanshun Mei","Heng Wang","Chuanke Fu","Xinyun Li","Shuhong Zhao","Xuewen Xu","Tao Xiang"],"categories":null,"content":"\r\n\r\n\r\n","date":1687219200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1687219200,"objectID":"7ff13bc5356551cc20fe097aef2dca32","permalink":"/publication/ploggenetics/","publishdate":"2023-06-20T00:00:00Z","relpermalink":"/publication/ploggenetics/","section":"publication","summary":"The loin muscle depth (LMD) is positively correlated with lean meat content and can therefore be used to estimate the lean meat content of pigs. The loin muscle depth is a quantitative trait that is influenced by whole-genome distributed polygenes. To identify the possible candidate genes and mutations impacting the LMD, we used genome-wide association study (GWAS), which is commonly used to identify candidate genomic regions associated with complex growth traits, to mapping the genomic regions. As over 90% of the identified variants have been localized to non-coding regions of the pig genome and their functions in phenotype regulation are poorly understood, we further combined 3D epigenomics to understand the mechanism of genetic variants regulating LMD. In combination with different types of data and analyses, we identified a 10 kb quantitative trait locus (QTL) on chromosome 17 that was significantly associated with LMD. We identified the BMP2 gene as a major candidate gene, and SNP rs1111440035 and rs321846600 were identified as likely candidate mutations affecting the LMD. Our study is unique in its attempt to identify candidate genetic variants by integrating GWAS and 3D epigenomics in pigs.","tags":["Source Themes"],"title":"Integrated analysis of genome-wide association studies and 3D epigenomic characteristics reveal the BMP2 gene regulating loin muscle depth in Yorkshire pigs","type":"publication"},{"authors":null,"categories":null,"content":"JUMP is a Julia Package (binary version) for genomic selection(prediction) with BLUP and Bayesian methods! In the current stage, i just use this to achieve my analysis. Some functions are under releasing, speed and memory performance would be the next step target!\n","date":1679875200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1679875200,"objectID":"81c0cc6bad1fee49d3a3b98aad81f51e","permalink":"/project/jump/jump/","publishdate":"2023-03-27T00:00:00Z","relpermalink":"/project/jump/jump/","section":"project","summary":"Julia Package (binary version) for genomic selection (prediction) with BLUP and Bayesian methods!","tags":["Genomic Prediction"],"title":"JUMP","type":"project"},{"authors":[],"categories":[],"content":"","date":1679386944,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1679386944,"objectID":"c5a0c2312834bfc6cc602e78c776e73b","permalink":"/publication/","publishdate":"2023-03-21T16:22:24+08:00","relpermalink":"/publication/","section":"","summary":"","tags":[],"title":"Publication","type":"page"},{"authors":["Quanshun Mei","Huiming Liu","Shuhong Zhao","Tao Xiang","Ole F Christensen"],"categories":null,"content":"\r\n\r\n\r\n","date":1679011200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1679011200,"objectID":"7176333f6c8a233660b87e4e8996bb65","permalink":"/publication/2023.gse/","publishdate":"2023-03-17T00:00:00Z","relpermalink":"/publication/2023.gse/","section":"publication","summary":"Dairy cattle production systems are mostly based on purebreds, but recently the use of crossbreeding has received increased interest. For genetic evaluations including crossbreds, several methods based on single-step genomic best linear unbiased prediction (ssGBLUP) have been proposed, including metafounder ssGBLUP (MF-ssGBLUP) and breed-specific ssGBLUP (BS-ssGBLUP). Ideally, models that account for breed effects should perform better than simple models, but knowledge on the performance of these methods is lacking for two-way crossbred cattle. In addition, the differences in the estimates of genetic parameters (such as the genetic variance component and heritability) between these methods have rarely been investigated. Therefore, the aims of this study were to (1) compare the estimates of genetic parameters for average daily gain (ADG) and feed conversion ratio (FCR) between these methods; and (2) evaluate the impact of these methods on the predictive ability for crossbred performance.","tags":["Source Themes"],"title":"Genomic evaluation for two-way crossbred performance in cattle","type":"publication"},{"authors":["Quanshun Mei","Zulma G Vitezica","Jielin Li","Shuhong Zhao","Andres Legarra","Tao Xiang"],"categories":null,"content":"\r\n\r\n\r\n","date":1666396800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1666396800,"objectID":"ef15e94dcb86505cd69cf41f6ada674f","permalink":"/publication/2022.gse/","publishdate":"2022-10-22T00:00:00Z","relpermalink":"/publication/2022.gse/","section":"publication","summary":"At the beginning of genomic selection, some Chinese companies genotyped pigs with different single nucleotide polymorphism (SNP) arrays. The obtained genomic data are then combined and to do this, several imputation strategies have been developed. Usually, only additive genetic effects are considered in genetic evaluations. However, dominance effects that may be important for some traits can be fitted in a mixed linear model as either â€˜classicalâ€™ or â€˜genotypicâ€™ dominance effects. Their influence on genomic evaluation has rarely been studied. Thus, the objectives of this study were to use a dataset from Canadian Yorkshire pigs to (1) compare different strategies to combine data from two SNP arrays (Affymetrix 55K and Illumina 42K) and identify the most appropriate strategy for genomic evaluation and (2) evaluate the impact of dominance effects (classicalâ€™ and â€˜genotypicâ€™) and inbreeding depression effects on genomic predictive abilities for average daily gain (ADG), backfat thickness (BF), loin muscle depth (LMD), days to 100 kg (AGE100), and the total number of piglets born (TNB) at first parity.","tags":["Source Themes"],"title":"Impacts of additive, dominance, and inbreeding depression effects on genomic evaluation by combining two SNP chips in Canadian Yorkshire pigs bred in China","type":"publication"},{"authors":[],"categories":["Rlmt"],"content":"Table of Contents    Rlmt: R warrper of the Linear Mixed Models Toolbox (LMT)   Contents  OVERVIEW   GETTING STARTED  ğŸ™ŠInstallation ğŸ™ŠExamples   Usage        Rlmt: R warrper of the Linear Mixed Models Toolbox (LMT) Contents   OVERVIEW\n  GETTING STARTED\n  USAGE\n   OVERVIEW â€‹\tThe Linear mixed Models Toolbox (lmt) is a stand-alone single executable software for for large scale linear mixed model analysis. lmt has been used successfully for genetic evaluation data sets with \u0026raquo;200k genotyped animals, \u0026raquo;15m animals, \u0026raquo;500m equations. More details about lmt can be found in website: lmt website\nâ€‹\tIn order to further assistance the use of lmt, i developed an R package: Rlmt for interfacing with lmt. This R package is developed via R6 package which can provides an implementation of encapsulated object-oriented programming for R. And this makes the grammar of Rlmt looks like easy and elegant (i hope ğŸ˜„).\nâ€‹\tAbout the usage of lmt in academic and commercial, user should follow the rules as mentioned in lmt website.\nGETTING STARTED ğŸ™ŠInstallation Rlmt links to R packages R6. This package should be installed before installing Rlmt. Rlmt is available by sending a request to the author (hzau_qsmei@163.com),\nğŸ™ŠExamples  Ex 1. PBLUP Ex 2. SSGBLUP Ex 3. Multiple traits analysis Ex 4. Several special models Ex 5. Switch to different BLUP analysis Ex 6. Modify jobs  Usage Rlmt provides several files which are saved in ~/Rlmt/extdata. We can get the path of these files by typing\nsystem.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;Rlmt\u0026quot;) # path of provided files\r Ex 1. PBLUP library(Rlmt)\r# path of example data example_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;Rlmt\u0026quot;) #construct lmt_data object\rmydata=lmt_data$new(phe_file=paste0(example_path,\u0026quot;/data.csv\u0026quot;),\tped_file=paste0(example_path,\u0026quot;/pedigree_unsorted.csv\u0026quot;)) #construct lmt_models object\rmymodels=lmt_models$new(fixed=tr1~f11+f12+f13,covariate=~c1c1,random=~id)\r#construct Rlmt object\rmylmt=Rlmt$new(models=mymodels,data=mydata,software_path=\u0026quot;....../lmt\u0026quot;)\r#do analysis\rmylmt$do_analysis(\u0026quot;....../test_Result\u0026quot;) #output path\r Ex 2. SSGBLUP library(Rlmt)\r# path of example data example_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;Rlmt\u0026quot;) #construct lmt_data object\rmydata=lmt_data$new(phe_file=paste0(example_path,\u0026quot;/data.csv\u0026quot;),\tped_file=paste0(example_path,\u0026quot;/pedigree_unsorted.csv\u0026quot;),\tgeno_file=paste0(example_path,\u0026quot;/genotypes.txt\u0026quot;),\tgeno_id_file=paste0(example_path,\u0026quot;/genoids.csv\u0026quot;))\r#construct lmt_models object\rmymodels=lmt_models$new(fixed=tr1~f11+f12+f13,covariate=~c1c1,random=~id)\rmymodels$pars$blup_type=\u0026quot;SS_GBLUP\u0026quot;\r#construct Rlmt object\rmylmt=Rlmt$new(models=mymodels,data=mydata,software_path=\u0026quot;....../lmt\u0026quot;)\r#do analysis\rmylmt$do_analysis(\u0026quot;....../Rlmt/test_Result\u0026quot;) #output path  Ex 3. Multiple traits analysis m2=lmt_formulas$new(fixed=tr2~f11+f12+f13,covariate=~c1c1,random=~id) #creat lmt_formulas object\rmylmt$models$add_formulas(m2)\rmylmt$do_analysis(\u0026quot;....../test_Result\u0026quot;) #multple traits analysis\rm2=lmt_formulas$new(fixed=tr2~f11+f13,covariate=~c1c1+c1c2+c2c1,random=~id) #modify effect of tr2\rmylmt$models$add_formulas(m2)\rmylmt$do_analysis(\u0026quot;....../Rlmt/test_Result\u0026quot;) #output path mylmt$models$rm_formulas(\u0026quot;tr2\u0026quot;) #removes trait: tr2 in analysis\rmylmt$do_analysis(\u0026quot;....../Rlmt/test_Result\u0026quot;) #output path  Ex 4. Several special models # maternal effect\rm1=lmt_formulas$new(fixed=tr1~f11+f12+f13,covariate=~c1c1,random=~id+dam) # permanent effect\rm1=lmt_formulas$new(fixed=tr1~f11+f12+f13,covariate=~c1c1,random=~id+dam+pe) #nested effect\rm1=lmt_formulas$new(fixed=tr1~f11+f12,covariate=~f13(c1c1),random=~id+dam+pe)\r#user defined polynomial expression m1=lmt_formulas$new(fixed=tr1~f11+f12,covariate=~c1c1,random=~id+dam+pe,,polyno=c1c1~{x^2}+{exp(x)}) #3-order Legendre polynomials\rm1=lmt_formulas$new(fixed=tr1~f11+f12,covariate=~c1c1,random=~id+dam+pe,,polyno=c1c1~{l1}+{l2}+{l3}) #random regression with 3-order Legendre polynomials\rm1=lmt_formulas$new(fixed=tr1~f11+f12+f13,random=~c1c1(id)+c1c1(dam)+c1c1(pe),polyno=c1c1~{l1}+{l2}+{l3}) # genetic group as extra random effect\rmylmt$models$pars$gg_type=\u0026quot;extra\u0026quot;\rmylmt$models$add_formulas(m1)\rmylmt$models$add_formulas(m1) #update effect\rmylmt$do_analysis(\u0026quot;....../test_Result\u0026quot;) #do analysis\r Ex 5. Switch to different BLUP analysis library(Rlmt)\r# path of example data example_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;Rlmt\u0026quot;) #construct lmt_data object\rmydata=lmt_data$new(phe_file=paste0(example_path,\u0026quot;/data.csv\u0026quot;),\tped_file=paste0(example_path,\u0026quot;/pedigree_unsorted.csv\u0026quot;),\tgeno_file=paste0(example_path,\u0026quot;/genotypes.txt\u0026quot;),\tgeno_id_file=paste0(example_path,\u0026quot;/genoids.csv\u0026quot;))\r#construct lmt_models object\rmymodels=lmt_models$new(fixed=tr1~f11+f12+f13,covariate=~c1c1,random=~id)\rmylmt$models$pars$meta_gamma=0.5 #Metafounder\rmymodels$pars$blup_type=\u0026quot;SS_TBLUP\u0026quot; #SS_TBLUP\rmymodels$pars$blup_type=\u0026quot;SS_SNPBLUP\u0026quot; #SS_SNPBLUP\rmymodels$pars$blup_type=\u0026quot;External_BLUP\u0026quot; #External_BLUP\rmylmt$data$grm$file=\u0026quot;test_external.bin\u0026quot; #External_BLUP\r#ssGBLUP with two genomic factors\rmydata=lmt_data$new(phe_file=paste0(example_path,\u0026quot;/data.csv\u0026quot;), ped_file=paste0(example_path,\u0026quot;/pedigree_unsorted.csv\u0026quot;),\tgeno_file=paste0(example_path,c(\u0026quot;/genotypes1.txt\u0026quot;,\u0026quot;/genotypes2.txt\u0026quot;)),\tgeno_id_file=paste0(example_path,c(\u0026quot;/genoids1.txt\u0026quot;,\u0026quot;/genoids2.txt\u0026quot;)))\rmymodels=lmt_models$new(fixed=tr1~f11+f12+f13,covariate=~c1c1,random=~id1+id2) mylmt$do_analysis(\u0026quot;/usr/home/qgg/qumei/Rlmt/test_Result\u0026quot;) #do analysis\r Ex 6. Modify jobs #sampler m_jobs=lmt_jobs$new(type=\u0026quot;sample\u0026quot;)\rmymodels$pars$jobs=m_jobs\rm_jobs$samplers$type=c(\u0026quot;singlepass\u0026quot;,\u0026quot;blocked\u0026quot;)\rmylmt$do_analysis(\u0026quot;....../test_Result\u0026quot;) #output path\r#solver m_jobs=mymodels$pars$jobs\rm_jobs$type=\u0026quot;mcemreml\u0026quot;\rm_jobs$conv=-9.21034\rm_jobs$rounds=300\rmylmt$do_analysis(\u0026quot;....../test_Result\u0026quot;) #output path\r#pevsolve\rm_jobs=lmt_jobs$new(type=\u0026quot;pevsolve\u0026quot;)\rmymodels$pars$jobs=m_jobs\rmylmt$do_analysis(\u0026quot;....../test_Result\u0026quot;) #output path\r ","date":1661212800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1661265156,"objectID":"517c5ffbfe28d0bf75f2de1c6302fec1","permalink":"/post/rlmt-overview/overview/","publishdate":"2022-08-23T00:00:00Z","relpermalink":"/post/rlmt-overview/overview/","section":"post","summary":"Overview of package:Rlmt ","tags":[],"title":"R package:Rlmt- Overview","type":"post"},{"authors":["Fang Fang","Jielin Li","Meng Guo","Quanshun Mei","Mei Yu","Huiming Liu","Andres Legarra","Tao Xiang"],"categories":null,"content":"\r\n\r\n\r\n","date":1658016000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1658016000,"objectID":"d245d9ed575c7b3050786b259de135ad","permalink":"/publication/2022.jas_co_author/","publishdate":"2022-07-17T00:00:00Z","relpermalink":"/publication/2022.jas_co_author/","section":"publication","summary":"Joint genomic evaluation by combining data recordings and genomic information from different pig herds and populations is of interest for pig breeding companies because the efficiency of genomic selection (GS) could be further improved. In this work, an efficient strategy of joint genomic evaluation combining data from multiple pig populations is investigated. Total teat number (TTN), a trait that is equally recorded on 13,060 American Yorkshire (AY) populations (~14.68 teats) and 10,060 Danish Yorkshire (DY) pigs (~14.29 teats), was used to explore the feasibility and accuracy of GS combining datasets from different populations. We first estimated the genetic correlation (rg) of TTN between AY and DY pig populations (â rg = 0.79, se = 0.23). Then we employed the genome-wide association study to identify quantitative trait locus (QTL) regions that are significantly associated with TTN and investigate the genetic architecture of TTN in different populations. Our results suggested that the genomic regions controlling TTN are slightly different in the two Yorkshire populations, where the candidate QTL regions were on SSC 7 and SSC 8 for the AY population and on SSC 7 for the DY population. Finally, we explored an optimal way of genomic prediction for TTN via three different genomic best linear unbiased prediction models and we concluded that when TTN across populations are regarded as different, but correlated, traits in a multitrait model, predictive abilities for both Yorkshire populations improve. As a conclusion, joint genomic evaluation for target traits in multiple pig populations is feasible in practice and more accurate, provided a proper model is used.","tags":["Source Themes"],"title":"Genomic evaluation and genome-wide association studies for total number of teats in a combined American and Danish Yorkshire pig populations selected in China","type":"publication"},{"authors":null,"categories":null,"content":"Using C++ to re-write R package-blupADC to improve the speed and memory performance!\n","date":1651017600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1651017600,"objectID":"85a95d198c6cb87ea3d03db429ad58c8","permalink":"/project/blupadc_c++/blupadc_c++/","publishdate":"2022-04-27T00:00:00Z","relpermalink":"/project/blupadc_c++/blupadc_c++/","section":"project","summary":"C++ version of blupADC.","tags":["Deep Learning"],"title":"blupADC-C++","type":"project"},{"authors":["Quanshun Mei","Chuanke Fu","Jielin Li","Shuhong Zhao","Tao Xiang"],"categories":null,"content":"\r\n\r\n\r\n","date":1631836800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1631836800,"objectID":"2078c56d6505484948920455caea5f98","permalink":"/publication/2022.blupadc/","publishdate":"2021-09-17T00:00:00Z","relpermalink":"/publication/2022.blupadc/","section":"publication","summary":"Genetic analysis is a systematic and complex procedure in animal and plant breeding. With fast development of high-throughput genotyping techniques and algorithms, animal and plant breeding has entered into a genomic era. However, there is a lack of software, which can be used to process comprehensive genetic analyses, in the routine animal and plant breeding program. To make the whole genetic analysis in animal and plant breeding straightforward, we developed a powerful, robust and fast R package that includes genomic data format conversion, genomic data quality control and genotype imputation, breed composition analysis, pedigree tracing, analysis and visualization, pedigree-based and genomic-based relationship matrix construction, and genomic evaluation. In addition, to simplify the application of this package, we also developed a shiny toolkit for users.","tags":["Source Themes"],"title":"blupADC - An R package and shiny toolkit for comprehensive genetic data analysis in animal and plant breeding","type":"publication"},{"authors":["Quanshun Mei","Chuanke Fu","Goutam Sahana","Yilong Chen","Lilin Yin","Yuanxin Miao","Shuhong Zhao","Tao Xiang"],"categories":null,"content":"\r\r","date":1626480000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1626480000,"objectID":"f86d34600453217bd987b888aaa55264","permalink":"/publication/2021.jas/","publishdate":"2021-07-17T00:00:00Z","relpermalink":"/publication/2021.jas/","section":"publication","summary":"Semen traits are crucial in commercial pig production since semen from boars is widely used in artificial insemination for both purebred and crossbred pig production. Revealing the genetic architecture of semen traits potentially promotes the efficiencies of improving semen traits through artificial selection. This study is aimed to identify candidate genes related to the semen traits in Duroc boars. First, we identified the genes that were significantly associated with three semen traits, including sperm motility (MO), sperm concentration (CON), and semen volume (VOL) in a Duroc boar population through a genome-wide association study (GWAS). Second, we performed a weighted gene co-expression network analysis (WGCNA). A total of 2, 3, and 20 single-nucleotide polymorphisms were found to be significantly associated with MO, CON, and VOL, respectively. Based on the haplotype block analysis, we identified one genetic region associated with MO, which explained 6.15% of the genetic trait variance. ENSSSCG00000018823 located within this region was considered as the candidate gene for regulating MO. Another genetic region explaining 1.95% of CON genetic variance was identified, and, in this region, B9D2, PAFAH1B3, TMEM145, and CIC were detected as the CON-related candidate genes. Two genetic regions that accounted for 2.23% and 2.48% of VOL genetic variance were identified, and, in these two regions, WWC2, CDKN2AIP, ING2, TRAPPC11, STOX2, and PELO were identified as VOL-related candidate genes. WGCNA analysis showed that, among these candidate genes, B9D2, TMEM145, WWC2, CDKN2AIP, TRAPPC11, and PELO were located within the most significant module eigengenes, confirming these candidate genesâ€™ role in regulating semen traits in Duroc boars. The identification of these candidate genes can help to better understand the genetic architecture of semen traits in boars. Our findings can be applied for semen traits improvement in Duroc boars.","tags":["Source Themes"],"title":"Identification of new semen trait-related candidate genes in Duroc boars through genome-wide association and weighted gene co-expression network analyses","type":"publication"},{"authors":null,"categories":null,"content":"The Linear mixed Models Toolbox (lmt) is a stand-alone single executable software for for large scale linear mixed model analysis. lmt has been used successfully for genetic evaluation data sets with \u0026raquo;200k genotyped animals, \u0026raquo;15m animals, \u0026raquo;500m equations.\nIn order to further assistance the use of lmt, I developed an R package: Rlmt for interfacing with lmt. This R package is developed via R6 package which can provides an implementation of encapsulated object-oriented programming for R. And this makes the grammar of Rlmt looks like easy and elegant (i hope ğŸ˜„).\n","date":1619481600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1619481600,"objectID":"d647e2919e8870dfedc1feaf3c671269","permalink":"/project/rlmt/rlmt/","publishdate":"2021-04-27T00:00:00Z","relpermalink":"/project/rlmt/rlmt/","section":"project","summary":"R interface with LMT(Linear Mixed Models Toolbox) software in QGG, Aarhus University","tags":["Deep Learning"],"title":"Rlmt","type":"project"},{"authors":[],"categories":["shiny","online"],"content":"\r\rğŸ™€å¤§å®¶å¥½ï¼Œä»æœ¬èŠ‚å¼€å§‹ï¼Œæˆ‘å°†ç»™å¤§å®¶åˆ†äº« blupADC-online (åœ¨çº¿ç‰ˆ)çš„ä½¿ç”¨è¯´æ˜ã€‚å¯èƒ½æœ‰åŒå­¦ä¼šé—®ï¼šæ—¢ç„¶å·²ç»æœ‰äº†blupADC è¿™ä¸ªpackageäº†ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¿˜è¦å¼€å‘blupADC-online å‘¢ï¼Ÿ\nå…¶å®ï¼ŒblupADC-onlineå¯ä»¥çœ‹æˆæ˜¯blupADC packageçš„ç®€åŒ–ç‰ˆã€‚å‡¡æ˜¯blupADC-online èƒ½å®ç°çš„åŠŸèƒ½ï¼Œ blupADCpackageå‡èƒ½å®ç°ã€‚ä½†æ˜¯ï¼Œè€ƒè™‘åˆ°éƒ¨åˆ†ç”¨æˆ·å¯èƒ½å¯¹Rä¸å¤ªäº†è§£ï¼Œå› æ­¤æˆ‘ä»¬æƒ³åˆ°äº†å¼€å‘blupADC-online ã€‚é€šè¿‡blupADC-online ï¼Œç”¨æˆ·å³ä½¿æ²¡æœ‰ç¼–ç¨‹åŸºç¡€ä¹Ÿèƒ½å¾ˆå¿«çš„å®Œæˆç›¸åº”çš„åˆ†æğŸ’¯ã€‚\næœ¬èŠ‚ï¼Œæˆ‘ä»¬ç»™å¤§å®¶å¸¦æ¥çš„æ˜¯å¦‚ä½•é€šè¿‡blupADC-online å®ŒæˆDMUç›¸å…³çš„åˆ†æã€‚\nâœ‹ç™»å½•\råœ¨æµè§ˆå™¨æ ç›´æ¥è¾“å…¥ç½‘å€: http://47.95.251.15:443/sample-apps/blupADC/ å³å¯ç™»å½•åˆ°blupADC-onlineä¸»ç•Œé¢ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\né¦–å…ˆæˆ‘ä»¬åœ¨èœå•æ ç‚¹å‡»DMUå›¾æ ‡ï¼Œå³å¯å‘ç°æœ‰ä¸‰ä¸ªå­èœå•ï¼Œä»ä¸Šåˆ°ä¸‹ä¾æ¬¡æ˜¯ï¼š\nDIRã€SOL å’Œ Run DMUã€‚æœ¬èŠ‚çš„é‡ç‚¹å°±æ˜¯ä»‹ç»è¿™ä¸‰ä¸ªå­èœå•ç•Œé¢ã€‚\nå¦‚æœå¤§å®¶äº‹å…ˆå·²ç»äº†è§£è¿‡run_DMU å‡½æ•°çš„è¯ï¼Œé‚£ä¹ˆæœ¬èŠ‚å†…å®¹å¯èƒ½å¯¹å¤§å®¶æ¥è¯´å°±æ¯”è¾ƒç†Ÿæ‚‰äº†ã€‚å¦‚æœæ²¡æœ‰äº‹å…ˆäº†è§£ä¹Ÿæ²¡å…³ç³»ï¼Œå› ä¸ºç›¸å…³çš„æ“ä½œè¿˜æ˜¯éå¸¸ç®€å•çš„ã€‚\n\râœ‹DIRç•Œé¢\rç‚¹å‡»DIRèœå•ï¼Œæˆ‘ä»¬å°±èƒ½è¿›å…¥ DIRç•Œé¢ã€‚DIRç•Œé¢çš„ä¸»è¦åŠŸèƒ½æ˜¯ç”Ÿæˆ DMUæ ¼å¼çš„å‚æ•°æ–‡ä»¶ã€‚ä¸‹é¢æˆ‘ä»¬æ¥å¯¹ç•Œé¢å†…çš„å„ä¸ªå‚æ•°è¿›è¡Œé€ä¸€è®²è§£ï¼š\nBasic information\r\rNumber of trait: è¦åˆ†æçš„æ€§çŠ¶çš„æ•°ç›®\rNumber of integer variable: è¡¨å‹æ•°æ®ä¸­ï¼Œæ•´å‹å˜é‡çš„ä¸ªæ•°\rName of genetic effect: é—ä¼ æ•ˆåº”çš„åç§°(ä¸€èˆ¬ä¸ºåŠ¨æ¤ç‰©ä¸ªä½“Id)\rUpload colnames of phenotype data: ä¸Šä¼ è¡¨å‹æ•°æ®çš„åˆ—åæ–‡ä»¶ã€‚æ–‡ä»¶æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š\r\rNote: åˆ—åæ–‡ä»¶çš„æ ¼å¼ä¸ºï¼šnè¡Œ1åˆ—ã€‚æ¯è¡Œä»£è¡¨çš„æ˜¯è¡¨å‹æ•°æ®çš„åˆ—åã€‚\n\rFile path and name\r\rRelationship file path: äº²ç¼˜å…³ç³»æ–‡ä»¶çš„è·¯å¾„\n\rRelationship file name: äº²ç¼˜å…³ç³»æ–‡ä»¶çš„åç§°ã€‚\né’ˆå¯¹ä¸åŒçš„Analysis modelï¼Œæˆ‘ä»¬éœ€è¦æä¾›ä¸åŒçš„äº²ç¼˜å…³ç³»æ–‡ä»¶ã€‚å…·ä½“å¯¹åº”å…³ç³»ä¸ºï¼š\n\rPBLUP_A: äº²ç¼˜å…³ç³»æ–‡ä»¶ä¸ºç³»è°±æ–‡ä»¶\rGBLUP_A: äº²ç¼˜å…³ç³»æ–‡ä»¶ä¸ºåŸºå› ç»„äº²ç¼˜å…³ç³»çŸ©é˜µçš„é€†çŸ©é˜µæ–‡ä»¶\rGBLUP_AD: äº²ç¼˜å…³ç³»æ–‡ä»¶ä¸ºåŸºå› ç»„äº²ç¼˜å…³ç³»çŸ©é˜µçš„é€†çŸ©é˜µæ–‡ä»¶\rSSBLUP_A: äº²ç¼˜å…³ç³»æ–‡ä»¶ä¸ºç³»è°±æ–‡ä»¶åŠåŸºå› ç»„äº²ç¼˜å…³ç³»çŸ©é˜µæ–‡ä»¶\r\rPhenotype file path: è¡¨å‹æ–‡ä»¶çš„è·¯å¾„\n\rPhenotype file name: è¡¨å‹æ–‡ä»¶çš„åç§°\n\r\r\rDMU parameter\r\rDMU module: DMUè¿›è¡Œé—ä¼ è¯„ä¼°æ—¶æ‰€é€‰ç”¨çš„æ¨¡å—ï¼Œé»˜è®¤ä¸º dmuai ã€‚\n\rDMU algorithm code: æ–¹å·®ç»„åˆ†ä¼°è®¡æ‰€ç”¨çš„ç®—æ³•ï¼Œé»˜è®¤ä¸º 1ã€‚\n\rAnalysis model: è¿›è¡Œé—ä¼ è¯„ä¼°æ‰€é€‰ç”¨çš„æ¨¡å‹ã€‚å¯é€‰æ¨¡å‹åŒ…æ‹¬ï¼š\n\rPBLUP_A: ç³»è°±åŠ æ€§æ•ˆåº”æ¨¡å‹\rGBLUP_A: åŸºå› ç»„åŠ æ€§æ•ˆåº”æ¨¡å‹\rGBLUP_AD:åŸºå› ç»„åŠ æ€§-æ˜¾æ€§æ•ˆåº”æ¨¡å‹\rSSBLUP_A:ä¸€æ­¥æ³•åŠ æ€§æ•ˆåº”æ¨¡å‹\r\r\rå½“ç”¨æˆ·ä¸Šä¼ è¡¨å‹æ•°æ®çš„åˆ—åæ–‡ä»¶åï¼Œå½“å‰ç•Œé¢å†…ä¾¿ä¼šæ–°å¢å‡ ä¸ªçª—å£ï¼Œå¦‚ä¸‹ï¼š\nç”¨æˆ·å¯ä»¥é€šè¿‡è®¾ç½®Number of traitæ¥è°ƒæ•´å°çª—å£çš„ä¸ªæ•°ã€‚\ne.g.Â å½“è®¾ç½®Number of traitä¸º3æ—¶ï¼Œå°±ä¼šç”Ÿæˆ3ä¸ªå°çª—å£ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\nç”¨æˆ·å¯ä»¥åœ¨çª—å£å†…è¾“å…¥æƒ³è¦åˆ†æçš„æ€§çŠ¶åç§°åŠå¯¹åº”çš„å›ºå®šæ•ˆåº”ã€éšæœºæ•ˆåº”å’Œåå˜é‡æ•ˆåº”çš„åç§°ã€‚ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·è¾“å…¥ï¼Œé€‰æ‹©æ€§çŠ¶å’Œæ•ˆåº”åç§°æ—¶å¯é€šè¿‡ä¸‹æ‹‰èœå•é€‰å–ï¼Œå¦‚ä¸‹ï¼š\nä¸‹é¢ä»¥ä¸€ä¸ªå…·ä½“çš„ä¾‹å­è¿›è¡Œè¯´æ˜ï¼š\ne.g.Â æƒ³è¦åˆ†æçš„æ€§çŠ¶ä¸ºï¼šADG ;\nå›ºå®šæ•ˆåº”åŒ…æ‹¬ï¼š Sex å’Œ Breed;\néšæœºæ•ˆåº”åŒ…æ‹¬Id ;\nåå˜é‡æ•ˆåº”åŒ…æ‹¬ï¼šAge_at_off_testã€‚\né‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦åœ¨çª—å£å†…è¾“å…¥å¯¹åº”çš„ä¿¡æ¯å³å¯ï¼Œå¦‚ä¸‹ï¼š\nè¾“å…¥å®Œç›¸åº”çš„æ•ˆåº”åï¼Œåœ¨ç•Œé¢çš„æ­£ä¸‹æ–¹ä¼šå®æ—¶æ˜¾ç¤ºæ‰€ç”Ÿæˆçš„ dir å‚æ•°æ–‡ä»¶å†…å®¹ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š\nç”¨æˆ·å¯ä»¥é€šè¿‡ä¸‹æ–¹çš„ Download DIRæŒ‰é”®å³å¯å°†ç”Ÿæˆçš„ dir æ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°ã€‚\n\r\râœ‹SOLç•Œé¢\rç‚¹å‡»å·¦ä¾§çš„SOLå­èœå•ï¼Œæˆ‘ä»¬å°±èƒ½è¿›å…¥SOLç•Œé¢ã€‚\nSOLç•Œé¢çš„ä¸»è¦åŠŸèƒ½æ˜¯æ•´ç†DMUè¾“å‡ºçš„ç»“æœï¼Œå¿«é€Ÿå¾—åˆ°EBVã€æ®‹å·®ã€æ ¡æ­£è¡¨å‹å’ŒDEBVç­‰ç»“æœã€‚ä¸‹é¢æˆ‘ä»¬æ¥å¯¹ç•Œé¢å†…çš„å„ä¸ªå‚æ•°è¿›è¡Œé€ä¸€è®²è§£ï¼š\n\rNumber of trait: è¦åˆ†æçš„æ€§çŠ¶çš„æ•°ç›®\rGenetic number in SOL file: SOLæ–‡ä»¶ä¸­ï¼Œé—ä¼ æ•ˆåº”æ‰€å¯¹åº”çš„æ•°å­—ä»£ç \rName of genetic effect: é—ä¼ æ•ˆåº”çš„åç§°(ä¸€èˆ¬ä¸ºåŠ¨æ¤ç‰©ä¸ªä½“Id)\r\rPhenotype\r\rUpload colnames of phenotype data: ä¸Šä¼ è¡¨å‹æ•°æ®çš„åˆ—åæ–‡ä»¶ã€‚\rUpload phenotype data: ä¸Šä¼ è¡¨å‹æ•°æ®æ–‡ä»¶\r\r\rDEBV(å¯é€‰:å½“éœ€è¦è®¡ç®—DEBVæ—¶ï¼Œæ‰éœ€è¦ä¸Šä¼ ç›¸åº”çš„æ–‡ä»¶ã€‚)\r\rUpload pedigree file: ä¸Šä¼ ç³»è°±æ•°æ®æ–‡ä»¶\rUpload subset id: ä¸Šä¼ éœ€è¦è®¡ç®—DEBVçš„ä¸ªä½“å·æ•°æ®æ–‡ä»¶\r\r\rDMU result\r\rUpload SOL file: ä¸Šä¼ DMUè¾“å‡ºçš„SOLæ–‡ä»¶\rUpload RESIDUAL file: ä¸Šä¼ DMUè¾“å‡ºçš„RESIDUALæ–‡ä»¶\rUpload PAROUT file: ä¸Šä¼ DMUè¾“å‡ºçš„PAROUT æ–‡ä»¶\r\rå’Œä¹‹å‰çš„ç±»ä¼¼ï¼Œå½“æˆ‘ä»¬ä¸Šä¼ äº†è¡¨å‹æ•°æ®çš„åˆ—åæ–‡ä»¶åï¼Œå½“å‰ç•Œé¢å†…åŒæ ·ä¼šæ–°å¢å‡ ä¸ªçª—å£ï¼Œå¦‚ä¸‹ï¼š\nå½“æˆ‘ä»¬è¾“å…¥äº†å¯¹åº”çš„æ€§çŠ¶åç§°åï¼Œç•Œé¢æ­£ä¸‹æ–¹å°±ä¼šä»¥è¡¨æ ¼çš„å½¢å¼ å®æ—¶æ˜¾ç¤º ä¸ªä½“å¯¹åº”çš„EBV, æ®‹å·®ï¼Œæ ¡æ­£è¡¨å‹å’Œ DEBVï¼Œå¦‚ä¸‹ï¼š\nç”¨æˆ·å¯ä»¥åœ¨è¡¨æ ¼å†…è½»æ¾çš„å®ŒæˆæŸ¥è¯¢ã€æ’åºç­‰æ“ä½œã€‚\nç”¨æˆ·å¯ä»¥é€šè¿‡ä¸‹æ–¹çš„ Download corrected pheæŒ‰é”®å³å¯å°†æ ¡æ­£è¡¨å‹æ–‡ä»¶ä¸‹è½½åˆ°æœ¬åœ°ã€‚\n\r\râœ‹Run dmuç•Œé¢\rç‚¹å‡»å·¦ä¾§çš„Run DMUå­èœå•ï¼Œæˆ‘ä»¬å°±èƒ½è¿›å…¥Run DMU ç•Œé¢ã€‚\nRun DMUç•Œé¢çš„ä¸»è¦åŠŸèƒ½æ˜¯å¿«é€Ÿå¸®æˆ‘ä»¬å®ŒæˆDMUç›¸å…³çš„åˆ†æã€‚å…¶å®ï¼ŒRun DMUç•Œé¢çš„åŠŸèƒ½å¯ä»¥çœ‹æˆæ˜¯ DIRç•Œé¢å’Œ SOLç•Œé¢åŠŸèƒ½çš„é›†åˆä½“ã€‚ä¸è¿‡ï¼ŒäºŒè€…æœ€é‡è¦çš„åŒºåˆ«æ˜¯ï¼ŒRun DMUç•Œé¢èƒ½è‡ªåŠ¨å¸®æˆ‘ä»¬è°ƒç”¨DMUè½¯ä»¶å¹¶å®Œæˆç›¸åº”çš„åˆ†æã€‚\næ€»ç»“èµ·æ¥å°±æ˜¯ï¼šé€šè¿‡Run DMU ç•Œé¢ï¼Œæˆ‘ä»¬åªéœ€è¦æä¾›ç›¸å…³çš„æ€§çŠ¶åç§°å’Œè¡¨å‹ã€ç³»è°±ç­‰æ•°æ®æ–‡ä»¶åï¼Œå°±èƒ½å¾—åˆ°æœ€ç»ˆçš„ä¸ªä½“è‚²ç§å€¼ã€æ®‹å·®ã€æ ¡æ­£è¡¨å‹å’ŒDEBVç­‰ç»“æœã€‚\nRun DMU ç•Œé¢å†…çš„å„ä¸ªå‚æ•°åœ¨ DIRç•Œé¢å’ŒSOLç•Œé¢å†…éƒ½æœ‰è¯¦ç»†è®²è§£ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚\nå®Œæˆäº†å‰æœŸçš„æ•°æ®å‡†å¤‡å·¥ä½œåï¼Œç”¨æˆ·åªéœ€è¦ç‚¹å‡» Run DMU æŒ‰é”®ï¼Œå°±èƒ½å¼€å§‹DMUçš„åˆ†æäº†ã€‚\nç”±äºä¸åŒæ•°æ®é‡çš„åˆ†ææ—¶é—´æ˜¯ä¸åŒçš„ï¼Œå› æ­¤éœ€è¦è€å¿ƒçš„ç­‰å¾…ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œå‡ åˆ†é’Ÿå°±èƒ½å¾—åˆ°ç»“æœã€‚ç»“æœå¦‚ä¸‹æ‰€ç¤ºï¼š\nç”¨æˆ·é€šè¿‡ç‚¹å‡»ä¸‹æ–¹çš„ Download EBVæŒ‰é”®å³å¯å°†ç”Ÿæˆçš„æ–‡ä»¶ä¿å­˜åˆ°æœ¬åœ°ã€‚\n\r","date":1619049600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1619104301,"objectID":"1c2e38a35338970012171a927ee72425","permalink":"/post/feature-9-shiny_blupadc/online_dmu/","publishdate":"2021-04-22T00:00:00Z","relpermalink":"/post/feature-9-shiny_blupadc/online_dmu/","section":"post","summary":"blupADC-online","tags":[],"title":"shiny-blupADC 1","type":"post"},{"authors":[],"categories":["BLUPF90"],"content":"Table of Contents  Oveview Example  Single trait model - Pedigree BLUP Single trait model - GBLUP Single trait model - Single-step BLUP Multiple traits model - Pedigree BLUP Single trait - pedigree BLUP model(with user-provided prior) Single trait - pedigree BLUP model( with maternal effect) Single trait - pedigree BLUP model( with permanent effect) Single trait - pedigree BLUP model( with random regression effect) Single trait model - BLUP (gibbs sampling)   Parameter    Oveview ğŸ‘»In the previous section, we have given detailed description about the interface with DMU by run_DMU function. In this chapter, we will introduce the usage of run_BLUPF90 function.\nNote: the usage of run_BLUPF90 and run_DMU is similar. Thus, we recommend to have a look at the usage of run_DMU function.\nğŸ‘‰ Note: Package blupADC has encapsulated the basic module of BLUPF90 (renumf90, remlf90, airemlf90, and blupf90), if you want to use more modules, please download from websit (BLUPF90 download website).\nFor commercial use of BLUPF90, user must contact the author of BLUPF90 !!!\nğŸ‘‰ Note: Package blupADC now supports object-oriented programming in running BLUPF90, which should be more easier in analysis, see more details!\nExample Single trait model - Pedigree BLUP library(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupSUP\u0026quot;) # path of provided files run_BLUPF90(\rphe_col_names=c(\u0026quot;Id\u0026quot;,\u0026quot;Mean\u0026quot;,\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;,\u0026quot;Litter\u0026quot;,\u0026quot;Trait1\u0026quot;,\u0026quot;Trait2\u0026quot;,\u0026quot;Age\u0026quot;), # colnames of phenotype target_trait_name=list(c(\u0026quot;Trait1\u0026quot;)), #trait name fixed_effect_name=list(c(\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;)), #fixed effect name\rrandom_effect_name=list(c(\u0026quot;Id\u0026quot;,\u0026quot;Litter\u0026quot;)), #random effect name\rcovariate_effect_name=NULL, #covariate effect name\rgenetic_effect_name=\u0026quot;Id\u0026quot;, #genetic effect name phe_path=data_path, #path of phenotype file\rphe_name=\u0026quot;phenotype.txt\u0026quot;, #name of phenotype file\ranalysis_model=\u0026quot;PBLUP_A\u0026quot;, #model of genetic evaluation\rrelationship_path=data_path, #path of relationship file relationship_name=\u0026quot;pedigree.txt\u0026quot;, #name of relationship file output_result_path=getwd() # output path )  Single trait model - GBLUP library(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupSUP\u0026quot;) # path of provided files run_BLUPF90(\rphe_col_names=c(\u0026quot;Id\u0026quot;,\u0026quot;Mean\u0026quot;,\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;,\u0026quot;Litter\u0026quot;,\u0026quot;Trait1\u0026quot;,\u0026quot;Trait2\u0026quot;,\u0026quot;Age\u0026quot;), # colnames of phenotype target_trait_name=list(c(\u0026quot;Trait1\u0026quot;)), #trait name fixed_effect_name=list(c(\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;)), #fixed effect name\rrandom_effect_name=list(c(\u0026quot;Id\u0026quot;,\u0026quot;Litter\u0026quot;)), #random effect name\rcovariate_effect_name=NULL, #covariate effect name\rgenetic_effect_name=\u0026quot;Id\u0026quot;, #genetic effect name phe_path=data_path, #path of phenotype file\rphe_name=\u0026quot;phenotype.txt\u0026quot;, #name of phenotype file\ranalysis_model=\u0026quot;GBLUP_A\u0026quot;, #model of genetic evaluation\rrelationship_path=data_path, #path of relationship file relationship_name=\u0026quot;blupf90_genumeric\u0026quot;, #name of relationship file output_result_path=getwd() # output path )  Single trait model - Single-step BLUP library(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupSUP\u0026quot;) # path of provided files run_BLUPF90(\rphe_col_names=c(\u0026quot;Id\u0026quot;,\u0026quot;Mean\u0026quot;,\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;,\u0026quot;Litter\u0026quot;,\u0026quot;Trait1\u0026quot;,\u0026quot;Trait2\u0026quot;,\u0026quot;Age\u0026quot;), # colnames of phenotype target_trait_name=list(c(\u0026quot;Trait1\u0026quot;)), #trait name fixed_effect_name=list(c(\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;)), #fixed effect name\rrandom_effect_name=list(c(\u0026quot;Id\u0026quot;,\u0026quot;Litter\u0026quot;)), #random effect name\rcovariate_effect_name=NULL, #covariate effect name\rgenetic_effect_name=\u0026quot;Id\u0026quot;, #genetic effect name phe_path=data_path, #path of phenotype file\rphe_name=\u0026quot;phenotype.txt\u0026quot;, #name of phenotype file\ranalysis_model=\u0026quot;SSBLUP_A\u0026quot;, #model of genetic evaluation\rrelationship_path=data_path, #path of relationship file relationship_name=c(\u0026quot;pedigree.txt\u0026quot;,\u0026quot;blupf90_genumeric\u0026quot;), #name of relationship file output_result_path=getwd() # output path )  Similar to run_DMU function, through modifying the two parameters: analysis_model and relationship_name , we can perform Pedigree-BLUP, GBLUP, and SSBLUP analysis(PS: blupf90_genumeric is generated through cal_kinship functionï¼Œsee more details about cal_kinship function).\nMultiple traits model - Pedigree BLUP The following code is about the usage of multiple traits model through BLUPF90:\nlibrary(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupSUP\u0026quot;) # path of provided files run_BLUPF90(\rphe_col_names=c(\u0026quot;Id\u0026quot;,\u0026quot;Mean\u0026quot;,\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;,\u0026quot;Litter\u0026quot;,\u0026quot;Trait1\u0026quot;,\u0026quot;Trait2\u0026quot;,\u0026quot;Age\u0026quot;), # colnames of phenotype target_trait_name=list(c(\u0026quot;Trait1\u0026quot;),c(\u0026quot;Trait2\u0026quot;)), #trait name fixed_effect_name=list(c(\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;),c(\u0026quot;Herd_Year_Season\u0026quot;)), #fixed effect name\rrandom_effect_name=list(c(\u0026quot;Id\u0026quot;,\u0026quot;Litter\u0026quot;),c(\u0026quot;Id\u0026quot;)), #random effect name\rcovariate_effect_name=list(NULL,\u0026quot;Age\u0026quot;), #covariate effect name\rgenetic_effect_name=\u0026quot;Id\u0026quot;, #genetic effect name phe_path=data_path, #path of phenotype file\rphe_name=\u0026quot;phenotype.txt\u0026quot;, #name of phenotype file\ranalysis_model=\u0026quot;PBLUP_A\u0026quot;, #model of genetic evaluation\rrelationship_path=data_path, #path of relationship file relationship_name=c(\u0026quot;pedigree.txt\u0026quot;), #name of relationship file output_result_path=getwd() # output path )  Single trait - pedigree BLUP model(with user-provided prior) library(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupSUP\u0026quot;) # path of provided files run_BLUPF90(phe_col_names=c(\u0026quot;Id\u0026quot;,\u0026quot;Mean\u0026quot;,\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;,\u0026quot;Litter\u0026quot;,\r\u0026quot;Trait1\u0026quot;,\u0026quot;Trait2\u0026quot;,\u0026quot;Age\u0026quot;), # colnames of phenotype\rtarget_trait_name=list(c(\u0026quot;Trait1\u0026quot;)), #trait name fixed_effect_name=list(c(\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;)), #fixed effect name\rrandom_effect_name=list(c(\u0026quot;Id\u0026quot;,\u0026quot;Litter\u0026quot;)), #random effect name\rcovariate_effect_name=NULL, #covariate effect name\rgenetic_effect_name=\u0026quot;Id\u0026quot;,\t#genetic effect name\rphe_path=data_path, #path of phenotype file\rphe_name=\u0026quot;phenotype.txt\u0026quot;, #name of phenotype file\rprovided_BLUPF90_prior_file_path=data_path, #path of user-provided prior file\rprovided_BLUPF90_prior_file_name=\u0026quot;BLUPF90_Prior\u0026quot;, #name of user-provided prior file\rprovided_BLUPF90_prior_effect_name=c(\u0026quot;Id\u0026quot;,\u0026quot;Litter\u0026quot;,\u0026quot;Residual\u0026quot;),\ranalysis_model=\u0026quot;PBLUP_A\u0026quot;, #model of genetic evaluation\rrelationship_path=data_path, #path of relationship file relationship_name=\u0026quot;pedigree.txt\u0026quot;, #name of relationship file output_result_path=getwd() # output path )\r Single trait - pedigree BLUP model( with maternal effect) library(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupSUP\u0026quot;) # path of provided files run_BLUPF90(\rphe_col_names=c(\u0026quot;Herd\u0026quot;,\u0026quot;B_month\u0026quot;,\u0026quot;D_age\u0026quot;,\u0026quot;Litter\u0026quot;,\u0026quot;Sex\u0026quot;,\u0026quot;HY\u0026quot;,\u0026quot;ID\u0026quot;,\u0026quot;DAM\u0026quot;,\u0026quot;L_Dam\u0026quot;,\r\u0026quot;W_birth\u0026quot;,\u0026quot;W_2mth\u0026quot;,\u0026quot;W_4mth\u0026quot;,\u0026quot;G_0_2\u0026quot;,\u0026quot;G_0_4\u0026quot;,\u0026quot;G_2_4\u0026quot;), # colnames of phenotype\rtarget_trait_name=list(c(\u0026quot;W_birth\u0026quot;)), #trait name fixed_effect_name=list(c(\u0026quot;B_month\u0026quot;,\u0026quot;D_age\u0026quot;,\u0026quot;Litter\u0026quot;,\u0026quot;Sex\u0026quot;,\u0026quot;HY\u0026quot;)), #fixed effect name\rrandom_effect_name=list(c(\u0026quot;ID\u0026quot;,\u0026quot;L_Dam\u0026quot;)), #random effect name\rmaternal_effect_option=c(\u0026quot;mat\u0026quot;),\rgenetic_effect_name=\u0026quot;ID\u0026quot;, #genetic effect name covariate_effect_name=NULL, #covariate effect name\rphe_path=data_path, #path of phenotype file\rphe_name=\u0026quot;maternal_data\u0026quot;, #name of phenotype file\ranalysis_model=\u0026quot;PBLUP_A\u0026quot;, #model of genetic evaluation\rrelationship_path=data_path, #path of relationship file relationship_name=\u0026quot;maternal_pedigree\u0026quot;, #name of relationship file output_result_path=getwd() # output path )\r Single trait - pedigree BLUP model( with permanent effect) library(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupSUP\u0026quot;) # path of provided files run_BLUPF90(\rphe_col_names=c(\u0026quot;id\u0026quot;,\u0026quot;year_grp\u0026quot;,\u0026quot;breed\u0026quot;,\u0026quot;time\u0026quot;,\u0026quot;t_dato\u0026quot;,\r\u0026quot;age\u0026quot;,\u0026quot;L1\u0026quot;,\u0026quot;L2\u0026quot;,\u0026quot;L3\u0026quot;,\u0026quot;gh\u0026quot;), # colnames of phenotype\rtarget_trait_name=list(c(\u0026quot;gh\u0026quot;)), #trait name fixed_effect_name=list(c(\u0026quot;year_grp\u0026quot;,\u0026quot;breed\u0026quot;,\u0026quot;time\u0026quot;)), #fixed effect name\rrandom_effect_name=list(c(\u0026quot;id\u0026quot;,\u0026quot;t_dato\u0026quot;)), #random effect name\rcovariate_effect_name=list(c(\u0026quot;age\u0026quot;)), #covariate effect name\tgenetic_effect_name=\u0026quot;id\u0026quot;, #genetic effect name\rincluded_permanent_effect=list(c(TRUE)), #whether include permant effect\rphe_path=data_path, #path of phenotype file\rphe_name=\u0026quot;rr_data\u0026quot;, #name of phenotype file\ranalysis_model=\u0026quot;PBLUP_A\u0026quot;, #model of genetic evaluation\rrelationship_path=data_path, #path of relationship file relationship_name=\u0026quot;rr_pedigree\u0026quot;, #name of relationship file output_result_path=getwd() # output path )\r Single trait - pedigree BLUP model( with random regression effect) library(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupSUP\u0026quot;) # path of provided files run_BLUPF90(\rphe_col_names=c(\u0026quot;id\u0026quot;,\u0026quot;year_grp\u0026quot;,\u0026quot;breed\u0026quot;,\u0026quot;time\u0026quot;,\u0026quot;t_dato\u0026quot;,\r\u0026quot;age\u0026quot;,\u0026quot;L1\u0026quot;,\u0026quot;L2\u0026quot;,\u0026quot;L3\u0026quot;,\u0026quot;gh\u0026quot;), # colnames of phenotype\rtarget_trait_name=list(c(\u0026quot;gh\u0026quot;)), #trait name fixed_effect_name=list(c(\u0026quot;year_grp\u0026quot;,\u0026quot;breed\u0026quot;,\u0026quot;time\u0026quot;)), #fixed effect name\rrandom_effect_name=list(c(\u0026quot;id\u0026quot;,\u0026quot;t_dato\u0026quot;)), #random effect name\rcovariate_effect_name=list(c(\u0026quot;age\u0026quot;)), #covariate effect name\tgenetic_effect_name=\u0026quot;id\u0026quot;, #genetic effect name random_regression_effect_name=list(c(\u0026quot;L1\u0026amp;id\u0026amp;pe_effect\u0026quot;,\u0026quot;L2\u0026amp;id\u0026amp;pe_effect\u0026quot;)), #random regression effect name\rphe_path=data_path, #path of phenotype file\rphe_name=\u0026quot;rr_data\u0026quot;, #name of phenotype file\ranalysis_model=\u0026quot;PBLUP_A\u0026quot;, #model of genetic evaluation\rrelationship_path=data_path, #path of relationship file relationship_name=\u0026quot;rr_pedigree\u0026quot;, #name of relationship file output_result_path=getwd() # output path )\r Single trait model - BLUP (gibbs sampling) library(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupSUP\u0026quot;) # path of provided files run_BLUPF90(\rphe_col_names=c(\u0026quot;Id\u0026quot;,\u0026quot;Mean\u0026quot;,\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;,\u0026quot;Litter\u0026quot;,\u0026quot;Trait1\u0026quot;,\u0026quot;Trait2\u0026quot;,\u0026quot;Age\u0026quot;), # colnames of phenotype target_trait_name=list(c(\u0026quot;Trait1\u0026quot;)), #trait name fixed_effect_name=list(c(\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;)), #fixed effect name\rrandom_effect_name=list(c(\u0026quot;Id\u0026quot;,\u0026quot;Litter\u0026quot;)), #random effect name\rcovariate_effect_name=NULL, #covariate effect name\rgenetic_effect_name=\u0026quot;Id\u0026quot;, #genetic effect name phe_path=data_path, #path of phenotype file\rphe_name=\u0026quot;phenotype.txt\u0026quot;, #name of phenotype file\ranalysis_model=\u0026quot;PBLUP_A\u0026quot;, #model of genetic evaluation\rrelationship_path=data_path, #path of relationship file relationship_name=\u0026quot;pedigree.txt\u0026quot;, #name of relationship file BLUPF90_algorithm=\u0026quot;Gibbs\u0026quot;,\routput_result_path=getwd() # output path )  Parameter Many parameters in run_BLUPF90 are the same as in run_DMU function(see more details).\nğŸ’«Thus, we will introduce specific parameters in run_BLUPF90 function.\n  1ï¼šBLUPF90_algorithm\nAlgorithm of estimating variance components, character class. Default is \u0026ldquo;EM_REML\u0026rdquo;.\n \u0026quot;AI_REML\u0026quot; \u0026quot;EM_REML\u0026quot; \u0026quot;BLUP\u0026quot; : no need to estimate variance components, solve mixed linear model directly.    2ï¼šprovided_blupf90_prior_file_path\n  File path of user-provided prior file, character class.\nNote: The format of BLUPF90 prior file is different to the format of DMU prior file. In the next section, i will give a detailed introduction.\n 3ï¼šprovided_blupf90_prior_file_name  File name of user-provided prior file, character class.\n 4ï¼šprovided_blupf90_prior_effect_name  Effect name of user-provided prior file, character class.\n 5ï¼šBLUPf90_software_path  Path of software BLUPF90 , character class.\n","date":1618963200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1618991259,"objectID":"539a6cc626f30df5ec24577dc6f65ed3","permalink":"/post/feature-8-run_blupf90/blupf90/","publishdate":"2021-04-21T00:00:00Z","relpermalink":"/post/feature-8-run_blupf90/blupf90/","section":"post","summary":"Genetic evaluation with software BLUPF90","tags":[],"title":"R package:blupADC-Feature 8","type":"post"},{"authors":[],"categories":["DMU"],"content":"Table of Contents  Overview Example  Single trait - pedigree BLUP model Single trait - GBLUP model Single trait - single-step BLUP model Multiple traits - pedigree BLUP model Single trait - pedigree BLUP model(with user-provided prior) Single trait - pedigree BLUP model( with maternal effect) Single trait - pedigree BLUP model( with permanent effect) Single trait - pedigree BLUP model( with random regression effect) Single trait - pedigree BLUP model( with social genetic effect) Single trait - pedigree BLUP model( with social genetic effect) ğŸ¤¡Basic ğŸ‘ºAdvanced      Overview ğŸ¤  In the previous section, we have given detailed description about data preparation. In the following section, we will introduce genetic evaluation software in animal and plant breeding. Nowadays, in the filed of animal and plant breeding, two of the most famous breeding software are DMU and BLUPF90 ( cited over than one thousand).\nAlthough these two softwares have many advantages, these two softwares have one common pitfall: it is a little difficult to use for freshman(need to prepare parameter file). Thus, in order to overcome this pitfall, package blupADC provides run_DMU and run_BLUPF90 for interfacing DMU and BLUPF90 in an easy way.\nIn this section, we will give detail description about run_DMU function.\nğŸ‘‰ Note: Package blupADC has encapsulated the basic module of DMU(dmu1,dmuai, and dmu5) , more modules could be download from website(DMU download website).\nFor commercial use of DMU, user must contact the author of DMU !!!\nğŸ‘‰ Note: Package blupADC now supports object-oriented programming in running DMU, which should be more easier in analysis, see more details!\nExample Single trait - pedigree BLUP model library(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupSUP\u0026quot;) # path of provided files run_DMU(\rphe_col_names=c(\u0026quot;Id\u0026quot;,\u0026quot;Mean\u0026quot;,\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;,\u0026quot;Litter\u0026quot;,\u0026quot;Trait1\u0026quot;,\u0026quot;Trait2\u0026quot;,\u0026quot;Age\u0026quot;), # colnames of phenotype\rtarget_trait_name=list(c(\u0026quot;Trait1\u0026quot;)), #trait name fixed_effect_name=list(c(\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;)), #fixed effect name\rrandom_effect_name=list(c(\u0026quot;Id\u0026quot;,\u0026quot;Litter\u0026quot;)), #random effect name\rcovariate_effect_name=NULL, #covariate effect name\rgenetic_effect_name=\u0026quot;Id\u0026quot;,\t#genetic effect name phe_path=data_path, #path of phenotype file\rphe_name=\u0026quot;phenotype.txt\u0026quot;, #name of phenotype file\rinteger_n=5, #number of integer variable analysis_model=\u0026quot;PBLUP_A\u0026quot;, #model of genetic evaluation\rdmu_module=\u0026quot;dmuai\u0026quot;, #modeule of estimating variance components relationship_path=data_path, #path of relationship file relationship_name=\u0026quot;pedigree.txt\u0026quot;, #name of relationship file output_result_path=getwd() # output path )\r Single trait - GBLUP model library(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupSUP\u0026quot;) # path of provided files run_DMU(\rphe_col_names=c(\u0026quot;Id\u0026quot;,\u0026quot;Mean\u0026quot;,\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;,\u0026quot;Litter\u0026quot;,\u0026quot;Trait1\u0026quot;,\u0026quot;Trait2\u0026quot;,\u0026quot;Age\u0026quot;), # colnames of phenotype target_trait_name=list(c(\u0026quot;Trait1\u0026quot;)), #trait name fixed_effect_name=list(c(\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;)), #fixed effect name\rrandom_effect_name=list(c(\u0026quot;Id\u0026quot;,\u0026quot;Litter\u0026quot;)), #random effect name\rcovariate_effect_name=NULL, #covariate effect name\rgenetic_effect_name=\u0026quot;Id\u0026quot;,\t#genetic effect name\rphe_path=data_path, #path of phenotype file\rphe_name=\u0026quot;phenotype.txt\u0026quot;, #name of phenotype file\rinteger_n=5, #number of integer variable analysis_model=\u0026quot;GBLUP_A\u0026quot;, #model of genetic evaluation\rdmu_module=\u0026quot;dmuai\u0026quot;, #modeule of estimating variance components relationship_path=data_path, #path of relationship file relationship_name=\u0026quot;G_Ainv_col_three.txt\u0026quot;, #name of relationship file output_result_path=getwd() # output path )\r Single trait - single-step BLUP model library(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupSUP\u0026quot;) # path of provided files run_DMU(\rphe_col_names=c(\u0026quot;Id\u0026quot;,\u0026quot;Mean\u0026quot;,\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;,\u0026quot;Litter\u0026quot;,\u0026quot;Trait1\u0026quot;,\u0026quot;Trait2\u0026quot;), # colnames of phenotype target_trait_name=list(c(\u0026quot;Trait1\u0026quot;)), #trait name fixed_effect_name=list(c(\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;)), #fixed effect name\rrandom_effect_name=list(c(\u0026quot;Id\u0026quot;,\u0026quot;Litter\u0026quot;)), #random effect name\rcovariate_effect_name=NULL, #covariate effect name\rgenetic_effect_name=\u0026quot;Id\u0026quot;,\t#genetic effect name\rphe_path=data_path, #path of phenotype file\rphe_name=\u0026quot;phenotype.txt\u0026quot;, #name of phenotype file\rinteger_n=5, #number of integer variable analysis_model=\u0026quot;SSBLUP_A\u0026quot;, #model of genetic evaluation\rdmu_module=\u0026quot;dmuai\u0026quot;, #modeule of estimating variance components relationship_path=data_path, #path of relationship file relationship_name=c(\u0026quot;pedigree.txt\u0026quot;,\u0026quot;G_A_col_three.txt\u0026quot;), #name of relationship file output_result_path=getwd() # output path )\r Through modifying the two parameters: analysis_model and relationship_name , we can perform Pedigree-BLUP, GBLUP, and SSBLUP analysis (PS: we can get G_Ainv_col_three.txt and G_A_col_three.txt by cal_kinship functionï¼Œsee more details about cal_kinship function).\nThe above example is single-trait model, while in actual breeding, multiple traits model is also common. Similarly, we only need to modify several parameters to perform multiple traits model:\nMultiple traits - pedigree BLUP model library(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupSUP\u0026quot;) # path of provided files run_DMU(\rphe_col_names=c(\u0026quot;Id\u0026quot;,\u0026quot;Mean\u0026quot;,\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;,\u0026quot;Litter\u0026quot;,\u0026quot;Trait1\u0026quot;,\u0026quot;Trait2\u0026quot;,\u0026quot;Age\u0026quot;), # colnames of phenotype target_trait_name=list(c(\u0026quot;Trait1\u0026quot;),c(\u0026quot;Trait2\u0026quot;)), #trait name fixed_effect_name=list(c(\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;),c(\u0026quot;Herd_Year_Season\u0026quot;)), #fixed effect name\rrandom_effect_name=list(c(\u0026quot;Id\u0026quot;,\u0026quot;Litter\u0026quot;),c(\u0026quot;Id\u0026quot;)), #random effect name\rcovariate_effect_name=list(NULL,\u0026quot;Age\u0026quot;), #covariate effect name\rgenetic_effect_name=\u0026quot;Id\u0026quot;,\t#genetic effect name\rphe_path=data_path, #path of phenotype file\rphe_name=\u0026quot;phenotype.txt\u0026quot;, #name of phenotype file\rinteger_n=5, #number of integer variable analysis_model=\u0026quot;PBLUP_A\u0026quot;, #model of genetic evaluation\rdmu_module=\u0026quot;dmuai\u0026quot;, #modeule of estimating variance components relationship_path=data_path, #path of relationship file relationship_name=\u0026quot;pedigree.txt\u0026quot;, #name of relationship file output_result_path=getwd() # output path )\r Single trait - pedigree BLUP model(with user-provided prior) library(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupSUP\u0026quot;) # path of provided files run_DMU(phe_col_names=c(\u0026quot;Id\u0026quot;,\u0026quot;Mean\u0026quot;,\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;,\u0026quot;Litter\u0026quot;,\r\u0026quot;Trait1\u0026quot;,\u0026quot;Trait2\u0026quot;,\u0026quot;Age\u0026quot;), # colnames of phenotype\rtarget_trait_name=list(c(\u0026quot;Trait1\u0026quot;)), #trait name fixed_effect_name=list(c(\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;)), #fixed effect name\rrandom_effect_name=list(c(\u0026quot;Id\u0026quot;,\u0026quot;Litter\u0026quot;)), #random effect name\rcovariate_effect_name=NULL, #covariate effect name\rgenetic_effect_name=\u0026quot;Id\u0026quot;,\t#genetic effect name\rphe_path=data_path, #path of phenotype file\rphe_name=\u0026quot;phenotype.txt\u0026quot;, #name of phenotype file\rprovided_prior_file_path=data_path, #path of user-provided prior file\rprovided_prior_file_name=\u0026quot;PAROUT\u0026quot;, #name of user-provided prior file\rinteger_n=5, #number of integer variable analysis_model=\u0026quot;PBLUP_A\u0026quot;, #model of genetic evaluation\rdmu_module=\u0026quot;dmuai\u0026quot;, #modeule of estimating variance components relationship_path=data_path, #path of relationship file relationship_name=\u0026quot;pedigree.txt\u0026quot;, #name of relationship file output_result_path=getwd() # output path )\r Single trait - pedigree BLUP model( with maternal effect) library(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupSUP\u0026quot;) # path of provided files run_DMU(\rphe_col_names=c(\u0026quot;Herd\u0026quot;,\u0026quot;B_month\u0026quot;,\u0026quot;D_age\u0026quot;,\u0026quot;Litter\u0026quot;,\u0026quot;Sex\u0026quot;,\u0026quot;HY\u0026quot;,\u0026quot;ID\u0026quot;,\u0026quot;DAM\u0026quot;,\u0026quot;L_Dam\u0026quot;,\r\u0026quot;W_birth\u0026quot;,\u0026quot;W_2mth\u0026quot;,\u0026quot;W_4mth\u0026quot;,\u0026quot;G_0_2\u0026quot;,\u0026quot;G_0_4\u0026quot;,\u0026quot;G_2_4\u0026quot;), # colnames of phenotype\rtarget_trait_name=list(c(\u0026quot;W_birth\u0026quot;)), #trait name fixed_effect_name=list(c(\u0026quot;B_month\u0026quot;,\u0026quot;D_age\u0026quot;,\u0026quot;Litter\u0026quot;,\u0026quot;Sex\u0026quot;,\u0026quot;HY\u0026quot;)), #fixed effect name\rrandom_effect_name=list(c(\u0026quot;ID\u0026quot;,\u0026quot;L_Dam\u0026quot;)), #random effect name\rmaternal_effect_name=list(c(\u0026quot;DAM\u0026quot;)),\rgenetic_effect_name=\u0026quot;ID\u0026quot;, #genetic effect name covariate_effect_name=NULL, #covariate effect name\rphe_path=data_path, #path of phenotype file\rphe_name=\u0026quot;maternal_data\u0026quot;, #name of phenotype file\rinteger_n=9, #number of integer variable analysis_model=\u0026quot;PBLUP_A\u0026quot;, #model of genetic evaluation\rdmu_module=\u0026quot;dmuai\u0026quot;, #modeule of estimating variance components relationship_path=data_path, #path of relationship file relationship_name=\u0026quot;maternal_pedigree\u0026quot;, #name of relationship file output_result_path=getwd() # output path )\r Single trait - pedigree BLUP model( with permanent effect) library(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupSUP\u0026quot;) # path of provided files run_DMU(\rphe_col_names=c(\u0026quot;id\u0026quot;,\u0026quot;year_grp\u0026quot;,\u0026quot;breed\u0026quot;,\u0026quot;time\u0026quot;,\u0026quot;t_dato\u0026quot;,\r\u0026quot;age\u0026quot;,\u0026quot;L1\u0026quot;,\u0026quot;L2\u0026quot;,\u0026quot;L3\u0026quot;,\u0026quot;gh\u0026quot;), # colnames of phenotype\rtarget_trait_name=list(c(\u0026quot;gh\u0026quot;)), #trait name fixed_effect_name=list(c(\u0026quot;year_grp\u0026quot;,\u0026quot;breed\u0026quot;,\u0026quot;time\u0026quot;)), #fixed effect name\rrandom_effect_name=list(c(\u0026quot;id\u0026quot;,\u0026quot;t_dato\u0026quot;)), #random effect name\rcovariate_effect_name=list(c(\u0026quot;age\u0026quot;)), #covariate effect name\tgenetic_effect_name=\u0026quot;id\u0026quot;, #genetic effect name\rincluded_permanent_effect=list(c(TRUE)), #whether include permant effect\rphe_path=data_path, #path of phenotype file\rphe_name=\u0026quot;rr_data\u0026quot;, #name of phenotype file\rinteger_n=5, #number of integer variable analysis_model=\u0026quot;PBLUP_A\u0026quot;, #model of genetic evaluation\rdmu_module=\u0026quot;dmuai\u0026quot;, #modeule of estimating variance components relationship_path=data_path, #path of relationship file relationship_name=\u0026quot;rr_pedigree\u0026quot;, #name of relationship file output_result_path=getwd() # output path )\r Single trait - pedigree BLUP model( with random regression effect) library(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupSUP\u0026quot;) # path of provided files run_DMU(\rphe_col_names=c(\u0026quot;id\u0026quot;,\u0026quot;year_grp\u0026quot;,\u0026quot;breed\u0026quot;,\u0026quot;time\u0026quot;,\u0026quot;t_dato\u0026quot;,\r\u0026quot;age\u0026quot;,\u0026quot;L1\u0026quot;,\u0026quot;L2\u0026quot;,\u0026quot;L3\u0026quot;,\u0026quot;gh\u0026quot;), # colnames of phenotype\rtarget_trait_name=list(c(\u0026quot;gh\u0026quot;)), #trait name fixed_effect_name=list(c(\u0026quot;year_grp\u0026quot;,\u0026quot;breed\u0026quot;,\u0026quot;time\u0026quot;)), #fixed effect name\rrandom_effect_name=list(c(\u0026quot;id\u0026quot;,\u0026quot;t_dato\u0026quot;)), #random effect name\rcovariate_effect_name=list(c(\u0026quot;age\u0026quot;)), #covariate effect name\tgenetic_effect_name=\u0026quot;id\u0026quot;, #genetic effect name included_permanent_effect=list(c(TRUE)), #whether include permant effect\rrandom_regression_effect_name=list(c(\u0026quot;L1\u0026amp;id\u0026amp;pe_effect\u0026quot;,\u0026quot;L2\u0026amp;id\u0026amp;pe_effect\u0026quot;)), #random regression effect name\rphe_path=data_path, #path of phenotype file\rphe_name=\u0026quot;rr_data\u0026quot;, #name of phenotype file\rinteger_n=5, #number of integer variable analysis_model=\u0026quot;PBLUP_A\u0026quot;, #model of genetic evaluation\rdmu_module=\u0026quot;dmuai\u0026quot;, #modeule of estimating variance components relationship_path=data_path, #path of relationship file relationship_name=\u0026quot;rr_pedigree\u0026quot;, #name of relationship file output_result_path=getwd() # output path )\r Single trait - pedigree BLUP model( with social genetic effect) User-provided phenotype doesn\u0026rsquo;t need to have max group size columns library(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupSUP\u0026quot;) # path of provided files run_DMU(\rphe_col_names=c(\u0026quot;Id\u0026quot;,\u0026quot;Group\u0026quot;,\u0026quot;Sex\u0026quot;,\u0026quot;Phe\u0026quot;), # colnames of phenotype\rtarget_trait_name=list(c(\u0026quot;Phe\u0026quot;)), #trait name fixed_effect_name=list(c(\u0026quot;Sex\u0026quot;)), #fixed effect name\rrandom_effect_name=list(c(\u0026quot;Id\u0026quot;,\u0026quot;Group\u0026quot;)), #random effect name\rcovariate_effect_name=NULL, #covariate effect name\tgenetic_effect_name=\u0026quot;Id\u0026quot;, #genetic effect name\rinclude_social_effect=list(c(TRUE)), group_effect_name=\u0026quot;Group\u0026quot;,\rphe_path=data_path, #path of phenotype file\rphe_name=\u0026quot;raw_social_data\u0026quot;, #name of phenotype file\rinteger_n=3, #number of integer variable analysis_model=\u0026quot;PBLUP_A\u0026quot;, #model of genetic evaluation\rdmu_module=\u0026quot;dmuai\u0026quot;, #modeule of estimating variance components relationship_path=data_path, #path of relationship file relationship_name=\u0026quot;socail_pedigree\u0026quot;, #name of relationship file output_result_path=getwd() # output path )\r Single trait - pedigree BLUP model( with social genetic effect) User-provided phenotype need to have max group size columns library(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupSUP\u0026quot;) # path of provided files run_DMU(phe_col_names=c(\u0026quot;Id\u0026quot;,\u0026quot;Group\u0026quot;,\u0026quot;Sex\u0026quot;,\u0026quot;Gr_id1\u0026quot;,\u0026quot;Gr_id2\u0026quot;,\u0026quot;Gr_id3\u0026quot;,\u0026quot;Gr_id4\u0026quot;,\u0026quot;Gr_id5\u0026quot;, \u0026quot;Phe\u0026quot;,\u0026quot;Status_Gr_id1\u0026quot;,\u0026quot;Status_Gr_id2\u0026quot;,\u0026quot;Status_Gr_id3\u0026quot;,\u0026quot;Status_Gr_id4\u0026quot;,\u0026quot;Status_Gr_id5\u0026quot;),# colnames of phenotype\rtarget_trait_name=list(c(\u0026quot;Phe\u0026quot;)), #trait name fixed_effect_name=list(c(\u0026quot;Sex\u0026quot;)), #fixed effect name\rrandom_effect_name=list(c(\u0026quot;Id\u0026quot;,\u0026quot;Group\u0026quot;)), #random effect name\rcovariate_effect_name=NULL,\rgenetic_effect_name=\u0026quot;Id\u0026quot;,\t#genetic effect name\rinclude_social_effect=list(c(TRUE)), #whether include social genetic effect integer_group_names=c(\u0026quot;Gr_id1\u0026quot;,\u0026quot;Gr_id2\u0026quot;,\u0026quot;Gr_id3\u0026quot;,\u0026quot;Gr_id4\u0026quot;,\u0026quot;Gr_id5\u0026quot;), #integer variable name of max group size real_group_names= c(\u0026quot;Status_Gr_id1\u0026quot;,\u0026quot;Status_Gr_id2\u0026quot;,\u0026quot;Status_Gr_id3\u0026quot;,\u0026quot;Status_Gr_id4\u0026quot;,\u0026quot;Status_Gr_id5\u0026quot;), #real variable name of max group size\rphe_path=data_path, #path of phenotype file\rphe_name=\u0026quot;social_data\u0026quot;, #name of phenotype file\rinteger_n=8, #number of integer variable analysis_model=\u0026quot;PBLUP_A\u0026quot;, #model of genetic evaluation\rdmu_module=\u0026quot;dmuai\u0026quot;, #modeule of estimating variance components relationship_path=data_path, #path of relationship file relationship_name=\u0026quot;socail_pedigree\u0026quot;, #name of relationship file output_result_path=getwd() # output path )\r ğŸ¤¡Basic  1ï¼šphe_path  File path of phenotype data ï¼Œcharacter classã€‚\n 2ï¼šphe_name  File name of phenotype dataï¼Œcharacter classã€‚\nNote: User-provided phenotype doesn\u0026rsquo;t have colnames (the same as the requirement of DMU)\n 3ï¼šphe_col_names  Colnames of phenotype dataï¼Œcharacter classã€‚\n 4ï¼šinteger_n  Number of integer variable, numeric classã€‚\n 5ï¼šgenetic_effect_name  Genetic effect name (usually is the individual name), character class.\n 6ï¼štarget_trait_name  Target trait name, list class. One list for each trait.\nFor multiple traits model, we should set target_trait_name as character vector, e.g. target_trait_name=list(c(\u0026quot;Trait1\u0026quot;),c(\u0026quot;Trait2\u0026quot;))\n 7ï¼šfixed_effect_name  Fixed effects name, list class.\nFor multiple traits model, the order of fixed effects name should correspond to the target trait name.\neg. target_trait_name=list(c(\u0026quot;Trait1\u0026quot;),c(\u0026quot;Trait2\u0026quot;))\nfixed_effect_name=list(c(\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;),c(\u0026quot;Herd_Year_Season\u0026quot;))\nwhich means the fixed effects name of trait1 is : c(\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;), the fixed effect name of trait2 is : c(\u0026quot;Herd_Year_Season\u0026quot;) \n 8ï¼šrandom_effect_name  Random effects name, list class.\nFor multiple traits model, the order of random effects name should correspond to the target trait name.\neg. target_trait_name=list(c(\u0026quot;Trait1\u0026quot;),c(\u0026quot;Trait2\u0026quot;))\nrandom_effect_name=list(c(\u0026quot;Id\u0026quot;,\u0026quot;Litter\u0026quot;),c(\u0026quot;Id\u0026quot;))\nwhich means the random effects name of trait1 is : c(\u0026quot;Id\u0026quot;,\u0026quot;Litter\u0026quot;), the random effects name of trait2 is : c(\u0026quot;Id\u0026quot;)\n 9ï¼šcovariate_effect_name  Covariate effects name, list class.\nFor multiple traits model, the order of covariate effects name should correspond to the target trait name.\neg. target_trait_name=list(c(\u0026quot;Trait1\u0026quot;),c(\u0026quot;Trait2\u0026quot;))\ncovariate_effect_name=list(c(NULL),c(\u0026quot;Age\u0026quot;))\nwhich means the covariate effects name of trait1 is : NULL (NULL means no this effect), the covariate effects name of trait2 is : Age\n 10ï¼šmaternal_effect_name  Maternal effects name(usually is the Dam), list class.\nFor multiple traits model, the order of maternal effects name should correspond to the target trait name.\neg. target_trait_name=list(c(\u0026quot;Trait1\u0026quot;),c(\u0026quot;Trait2\u0026quot;))\nmaternal_effect_name=list(c(NULL),c(\u0026quot;Dam\u0026quot;))\n 11ï¼šrandom_regression_effect_name  Random regression effects name, list class.\nFor multiple traits model, the order of random regression effects name should correspond to the target trait name.\neg. target_trait_name=list(c(\u0026quot;Trait1\u0026quot;),c(\u0026quot;Trait2\u0026quot;))\nrandom_regression_effect_name=list(c(\u0026quot;L1\u0026amp;id\u0026amp;pe_effect\u0026quot;,\u0026quot;L2\u0026amp;id\u0026amp;pe_effect\u0026quot;),c(\u0026quot;L1\u0026amp;id\u0026amp;pe_effect\u0026quot;,\u0026quot;L2\u0026amp;id\u0026amp;pe_effect\u0026quot;))\nWithin each list, the left side of \u0026amp; stands for polynomial coefficient name, the right side of \u0026amp; stands for random effect name or fixed effect name. If user want to include permanent effect in random regression model, the random effect name in the right side of \u0026amp; should be \u0026ldquo;pe_effect\u0026rdquo;, and user must set included_permanent_effect as TRUE\n 12ï¼šincluded_permanent_effect  Whether perform permanent-environment analysis, list class.\nFor multiple traits model, the order of permanent effect should correspond to the target trait name.\neg. target_trait_name=list(c(\u0026quot;Trait1\u0026quot;),c(\u0026quot;Trait2\u0026quot;))\nincluded_permanent_effect=list(c(TRUE),c(TRUE))\n 13ï¼šinclude_social_effect  Whether perform social genetic effect analysis, list class.\nFor multiple traits model, the order of permanent effect should correspond to the target trait name.\neg. target_trait_name=list(c(\u0026quot;Trait1\u0026quot;),c(\u0026quot;Trait2\u0026quot;))\ninclude_social_effect=list(c(TRUE),c(TRUE))\n 14ï¼šgroup_effect_name  The group effect name in the social genetic analysis, character class.\nWhen user-provided phenotype doesn\u0026rsquo;t have max group size columns, user need to specify the group_effect_name parameter. When user provides group_effect_name, software will generate a new phenotype with max group size columns automatically. And then, software will perform the social genetic analysis without additional parameter.\n 15ï¼šinteger_group_names  Integer variable name of max group size columns, character class.\nWhen user-provided phenotype has max group size columns, user need to specify the integer variable name of max group size columns.\n 16ï¼šreal_group_names  Real variable name of max group size columns, character class.\nWhen user-provided phenotype has max group size columns, user need to specify the real variable name of max group size columns.\n  17ï¼šanalysis_model\nModel of genetic evaluation, character class.\n \u0026quot;PBLUP_A\u0026quot; : Pedigree BLUP- additive model \u0026quot;GBLUP_A\u0026quot; :GBLUP- additive model \u0026quot;GBLUP_AD\u0026quot; :GBLUP- additive and dominance model \u0026quot;SSBLUP_A\u0026quot; :SSBLUP- additive model \u0026quot;User_define\u0026quot;: User define model    18ï¼šdmu_module\nModule of estimating variance components, character class.\n  \u0026quot;dmuai\u0026quot;\n  \u0026quot;dmu4\u0026quot;\n  \u0026quot;dmu5\u0026quot;\n    19ï¼šDMU_software_path\n  Path of DMU software, character class.\n 20ï¼šrelationship_path  File path of relationship data, character class.\n 21ï¼šrelationship_name  File name of relationship data, character class.\nFor different genetic evaluation model , we should provide different relationship file.\nE.g. for \u0026ldquo;PBLUP_A\u0026rdquo; model, we need to provide pedigree file, then we should set relationship_name=\u0026quot;pedigree.txt\u0026quot; ;\nfor \u0026ldquo;GBLUP_A\u0026rdquo; model, we need to provide inverse of additive relationship matrix file(3 columns format), then we should set relationship_name=\u0026quot;G_Ainv_col_three.txt\u0026quot; ;\nfor \u0026ldquo;SSBLUP_A\u0026rdquo; model, we need to provide pedigree and additive relationship matrix file(3 columns format), then we should set relationship_name=c(\u0026quot;pedigree.txt\u0026quot;,\u0026quot;G_A_col_three.txt\u0026quot;) ;\n 22ï¼šoutput_result_path  Path of output DMU result, character class.\n 23ï¼šoutput_ebv_path  File path of output EBV, character class. Default is equal to output_result_path\n 24ï¼šoutput_ebv_name  File name of output EBV, character class.\nğŸ‘ºAdvanced  25ï¼šprovided_effect_file_path  File path of trait\u0026rsquo;s model effect data, character class.\nFile of trait\u0026rsquo;s model effect include fixed effects name, random effects name, and covariate effects name. Once user provides this file, user don\u0026rsquo;t need to set these three parameters: fixed_effect_name  random_effect_name  covariate_effect_name .\nThe format of this effect file is as following:\n   V1 V2 V3 V4 V5 V6 V7 V8 V9     Trait1 * Sex Herd_Year_Season * Id Litter * *   Trait2 * Sex * Id * Age *     The first column is the name of target trait. Each column stands for one effect name. In order to recognize three types of effect, we set * to distinguish each type.\nEffects name between the first * and the second * stand for fixed effects name;\neffects name between the second * and the third * stand for random effects name;\neffects name between the third * and the fourth * stand for covariate effects name.\n 26ï¼šprovided_effect_file_name  File name of trait\u0026rsquo;s model effect data, character class.\n 27ï¼šprovided_DIR_file_path  File path of user-provided DIR data, character class.\n 28ï¼šprovided_DIR_file_name  File name of user-provided DIR data, character class.\n 29ï¼šincluded_permanent_effect  Whether perform permanent-environment analysis, logical class. Default is FALSE.\n 30ï¼šdmu_algorithm_code  Number of dmu-module algorithm, numeric class.\n 31ï¼šprovided_prior_file_path  File path of user-provided prior file, character class.\n 32ï¼šprovided_prior_file_name  File name of user-provided prior file, character class.\n 33ï¼šmissing_value  Missing value in phenotype file, numeric class. Default is -9999.\n 34ï¼šiteration_criteria  Value of iteration convergence, numeric class. Default is 1.0e-7.\n 35ï¼šgenetic_effect_number  Number of genetic effect in SOL file, numeric class. Default is 4.\n 36ï¼šresidual_cov_trait  Traits combination of assuming residual-covariance equals to 0. e.g residual_cov_trait=list(c(\u0026quot;Trait1\u0026quot;,\u0026quot;Trait2\u0026quot;))\n 37ï¼šselected_id  Individuals set of output EBV, character class.\n 38ï¼šcal_debv  Whether calculate de-regressed EBV(DEBV), logical class. Default is FALSE.\n 39ï¼šdebv_pedigree_path  File path of pedigree data for calculating DEBV, character class.\n 40ï¼šdebv_pedigree_name  File name of pedigree data for calculating DEBV, character class.\n","date":1618876800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1618914678,"objectID":"5814be3e29f082ce7eea6171a9d56fcb","permalink":"/post/feature-7-run_dmu/run_dmu/","publishdate":"2021-04-20T00:00:00Z","relpermalink":"/post/feature-7-run_dmu/run_dmu/","section":"post","summary":"Genetic evaluation with software DMU","tags":[],"title":"R package:blupADC-Feature 7","type":"post"},{"authors":[],"categories":["Relationship matrix"],"content":"Table of Contents  Overview Example  ğŸ˜¾ Pedigree-based kinship matrix ğŸ¤¡ Genomic-based kinship matrix ğŸ’¨Single-step based kinship matrix ğŸ’¨Single-step based kinship matrix(via bigmemory method)   Parameter  ğŸ’ªBasic ğŸ¦¶Advanced      Overview ğŸ™‰ In the application of animal and plant breeding, the key step is the construction of kinship matrix. Package: blupADC provides cal_kinship function which can construct various type of relationship matrix directly, including additive relationship matrix(pedigree, genomic and single-step), and dominance relationship matrix(pedigree, genomic and single-step), and the inverse matrix of these kinship matrix.\nIn the construction of single-step relationship matrix, users can select Metafounder algorithm or APY algorithm. In terms of the construction of dominance relationship matrix, users can select different coding manners for genomic dominance relationship matrix, gene dropping algorithm for pedigree dominance relationship matrix. In addition, cal_kinship  can calculate several types of inbreeding coefficients (pedigree, genomic, and single-step) .\nNote: In the construction of genomic and single-step relationship matrix, people need to provide genotype data. These parameters are the same as in geno_format function((see more details).\nExample ğŸ˜¾ Pedigree-based kinship matrix library(blupADC)\rkinship_result=cal_kinship(\rinput_pedigree=example_ped3, #provided hapmap data object\rkinship_type=c(\u0026quot;P_A\u0026quot;), #type of kinship matrix\rinbred_type=c(\u0026quot;Pedigree\u0026quot;), #type of inbreeding coefficients\rreturn_result=TRUE) #return result  ğŸ¤¡ Genomic-based kinship matrix library(blupADC)\rkinship_result=cal_kinship(\rinput_data_hmp=example_data_hmp, #provided hapmap data object\rkinship_type=c(\u0026quot;G_A\u0026quot;,\u0026quot;G_D\u0026quot;), #type of kinship matrix\rdominance_type=c(\u0026quot;genotypic\u0026quot;), #type of dominance effect\rinbred_type=c(\u0026quot;Homozygous\u0026quot;), #type of inbreeding coefficients\rreturn_result=TRUE) #return result  ğŸ’¨Single-step based kinship matrix library(blupADC)\rkinship_result=cal_kinship(\rinput_data_hmp=example_data_hmp, #provided hapmap data object\rinput_pedigree=example_ped3,\rkinship_type=c(\u0026quot;H_A\u0026quot;), #type of kinship matrix\rinbred_type=c(\u0026quot;H_diag\u0026quot;), #type of inbreeding coefficients\rreturn_result=TRUE) #return result  ğŸ’¨Single-step based kinship matrix(via bigmemory method) library(blupADC)\rphased_kinship_result=cal_kinship(\rinput_data_hmp=example_data_hmp, #provided hapmap data object\rinput_pedigree=example_ped3,\rbigmemory_cal=TRUE,\rbigmemory_data_path=getwd(),\rbigmemory_data_name=\u0026quot;blupADC\u0026quot;,\rkinship_type=c(\u0026quot;H_A\u0026quot;), #type of kinship matrix\rinbred_type=c(\u0026quot;H_diag\u0026quot;), #type of inbreeding coefficients\rreturn_result=TRUE) #return result  Parameter ğŸ’ªBasic   1ï¼škinship_type\nType of kinship matrix, character class. User can select multiple types simultaneously, including:\n \u0026ldquo;G_A\u0026rdquo; : genomic additive kinship matrix \u0026ldquo;G_Ainv\u0026rdquo; :inverse of genomic additive kinship matrix \u0026ldquo;G_D\u0026rdquo; :genomic dominance kinship matrix \u0026ldquo;G_Dinv\u0026rdquo; :inverse of genomic dominance kinship matrix \u0026ldquo;P_A\u0026rdquo; :pedigree additive kinship matrix \u0026ldquo;P_Ainv\u0026rdquo; :inverse of pedigree additive kinship matrix \u0026ldquo;P_D\u0026rdquo; : pedigree dominance kinship matrix \u0026ldquo;P_Dinv\u0026rdquo; :inverse of pedigree dominance kinship matrix \u0026ldquo;H_A\u0026rdquo; :single-step additive kinship matrix \u0026ldquo;H_Ainv\u0026rdquo; :inverse of single-step additive kinship matrix    Note: In the construction of pedigree and single-step relationship matrix, user need to provide pedigree data. In the construction of genomic and single-step relationship matrix, user need to provide genotype data.\n  2ï¼šdominance_type\nType of dominance effect in the construction of dominance relationship matrix , character class.\n \u0026ldquo;genotypic\u0026rdquo; : coded by $0-2pq$, $1-2pq$, and $0-2pq$ for $AA$, $Aa$, and $aa$, respectively. \u0026ldquo;classical\u0026rdquo; : coded by $-2q^2$, $2pq$ , and $-2p^2$ for $AA$, $Aa$, and $aa$, respectively.     More details about these two types dominance effects could be seen in this reference ï¼šOn the Additive and Dominant Variance and Covariance of Individuals Within the Genomic Selection Scope\n   3ï¼šinbred_type\nType of inbreeding coefficients, character class.\n  \u0026ldquo;Homozygous\u0026rdquo; : proportion of homozygous sites\n  \u0026ldquo;G_Diag\u0026rdquo; : diagonal of genomic additive relationship matrix minus 1\n  \u0026ldquo;H_diag\u0026rdquo; :diagonal of single-step additive relationship matrix minus 1\n  \u0026ldquo;Pedigree\u0026rdquo; :diagonal of pedigree additive relationship matrix minus 1\n    4ï¼šinput_pedigree\n  User-provided pedigree data ï¼Œdata.frame or matrix class. (see more details about the format of pedigree data)\n 5ï¼šIND_rename  Whether genotype individuals need to be renamed according to the provided pedigree, logical class. Default is FALSE.\n 6:bigmemory_cal  Whether using bigmemory method to calculate. logical class. Default is FALSE.\n 7:bigmemory_data_path  The file path bigmemory data . character class.\n 8:bigmemory_data_name  The file name bigmemory data . character class.\n  9ï¼šoutput_matrix_type\nType of output kinship matrix type, character class. Default is \u0026ldquo;col_all\u0026rdquo;.\n \u0026ldquo;col_all\u0026rdquo; : n*n format \u0026ldquo;col_three\u0026rdquo; : 3 columns format. The first and the second column are the name of individuals, the third column is the relationship coefficients ã€‚       1001 1001 0.989     1001 1002 0.421   1001 1003 0.567     10ï¼šoutput_matrix_path  File path of output relationship matrix, character class.\n 11ï¼šoutput_matrix_name  File name of output relationship matrix, character class.\nğŸ¦¶Advanced  12ï¼šcpu_cores  Number of cpu in calculating, numeric class. Default is 1.\n 13ï¼škinship_base  Whether take $p=q=0.5$ in the construction of relationship matrix, logical class. Default is FALSE.\n 14ï¼škinship_trace  Whether take the trace of kinship matrix to scale relationship matrix, logical class. Default is FALSE.\n 15ï¼šMetafounder_algorithm  Whether take the metafounder algorithm to construct single-step relationship matrix, logical class. Default is FALSE.\n 16ï¼šAPY_algorithm  Whether take the APY algorithm to construct inverse relationship matrix, logical class. Default is FALSE.\n 17ï¼šAPY_eigen_threshold  Threshold of variation explained by eigenvalues , numeric class. Default is 0.95.\n 18ï¼šAPY_n_core  Number of core animals , numeric class. Default is NULL.\n 19ï¼šSSBLUP_omega  The value of omega in the construction of single-step additive relationship matrix, numeric class. Default is 0.05.\n 20ï¼šgene_dropping  Whether take the gene dropping algorithm to construct pedigree dominance relationship matrix, logical class. Default is FALSE.\n 21ï¼šgene_dropping_iteration  The number of iteration for gene dropping algorithm , numeric class. Default is 1000.\n","date":1618790400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1618734999,"objectID":"468e5be35eedbea18bb02ed0ab82f3b5","permalink":"/post/feature-6-kinship_matrix/relationship_matrix/","publishdate":"2021-04-19T00:00:00Z","relpermalink":"/post/feature-6-kinship_matrix/relationship_matrix/","section":"post","summary":"Construct kinship matrix(A,G and H)","tags":[],"title":"R package:blupADC-Feature 6","type":"post"},{"authors":[],"categories":["Pedigree"],"content":"Table of Contents  Overview Example  Plot whole pedigree Plot subset of whole pedigree Plot subset of whole pedigree (with sibs) Change the style of picture   Output Parameter  ğŸ’¥Basic ğŸ’¨Advanced      Overview ğŸ¦„ An intuitive and clear structure of pedigree could help breeders to make better decision in breeding plan. By applying ggped function, user can plot the structure of pedigree in an easy way.\nExample Plot whole pedigree library(blupADC)\rpedigree_result=ggped(\rinput_pedigree=example_ped2\r)  Plot subset of whole pedigree library(blupADC)\rpedigree_result=ggped(\rinput_pedigree=example_ped2,\rtrace_id=c(\u0026quot;121\u0026quot;) #provided subset-id\r)  Plot subset of whole pedigree (with sibs) library(blupADC)\rpedigree_result=ggped(\rinput_pedigree=example_ped2,\rtrace_id=c(\u0026quot;121\u0026quot;),\rtrace_sibs=TRUE #whether plot the sibs of subset-id )  Change the style of picture User can change the style of pedigree by modifying the shape_type parameter. Default shape_type is 4.\nOutput The output of ggped is the object of ggplot, user can plot the pedigree structure or save it directly.\nParameter ğŸ’¥Basic  1ï¼šinput_pedigree  User-provided pedigree data, data.frame  or matrix class.\nğŸ’ŒThe format of provided pedigree data should be 3 columns format:\n   Offspring Sire Dam     DD19575312 DD18768902 DD16376015   DD19513112 DD18768902 DD17111017   DD20348012 DD19132207 DD19234510   DD20361110 DD19331001 DD19293112   DD20471212 DD19331001 DD19320808   DD20564818 DD19331001 DD19311009     2: trace_id  Individuals set in tracing pedigree, character class. Default is NULL (plot whole individuals in pedigree)\n 3: trace_sibs  Whether tracing the sibs of individuals set , logical class. Default is FALSE .\n 4: ind_sex  Sex record of individuals , data.frame class.\nThe format of this data is showing as follow:\n   Individual Sex     101 Male   102 Female   103 Male   104 Female    For individual who doesn\u0026rsquo;t have the record of sex, the sex of this individual would be set as Male.\n 5ï¼šplot_family  Whether showing family structure when plotting the pedigree, logical class. Default is FALSE .\n 6ï¼šshape_type  The shape type when plotting pedigree ï¼Œnumeric class. Default is 4.\nğŸ’¨Advanced  7: shape_size  The shape size of picture, numeric class. Default is 8 .\n 8ï¼šind_text_size  The size of individual name, numeric class. Default is 4 .\n 9ï¼šind_text_vjust  The vjust of individual name, numeric class. Default is 3 .\n","date":1618704000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1618533163,"objectID":"bc1e440dd4f54a06c26e1cc5c33f8a9a","permalink":"/post/feature-5-visualize_pedigree/pedigree/","publishdate":"2021-04-18T00:00:00Z","relpermalink":"/post/feature-5-visualize_pedigree/pedigree/","section":"post","summary":"Pedigree visualization ","tags":[],"title":"R package:blupADC-Feature 5","type":"post"},{"authors":["Yuanxin Miao","Quanshun Mei","Chuanke Fu","Mingxing Liao","Yan Liu","Xuewen Xu","Xinyun Li","Shuhong Zhao","Tao Xiang"],"categories":null,"content":"\r\n\r\n\r\n","date":1618617600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1618617600,"objectID":"0a3779a43d13cc1cbd8592b6ee7b9360","permalink":"/publication/2021.bmc_genomics_co_author/","publishdate":"2021-04-17T00:00:00Z","relpermalink":"/publication/2021.bmc_genomics_co_author/","section":"publication","summary":"The feed conversion ratio (FCR) is an important productive trait that greatly affects profits in the pig industry. Elucidating the genetic mechanisms underpinning FCR may promote more efficient improvement of FCR through artificial selection. In this study, we integrated a genome-wide association study (GWAS) with transcriptome analyses of different tissues in Yorkshire pigs (YY) with the aim of identifying key genes and signalling pathways associated with FCR.","tags":["Source Themes"],"title":"Genome-wide association and transcriptome studies identify candidate genes and pathways for feed conversion ratio in pigs","type":"publication"},{"authors":[],"categories":["Pedigree"],"content":"Table of Contents  Overview Example  ğŸ’–Trace pedigree   Output Parameter  ğŸ’¥Basic ğŸ’¨Advanced      Overview ğŸ¦„ Pedigree is the important information in animal breeding. By applying trace_pedigree function in package: blupADC, user can trace, rename, correct pedigree errors in an easy way. In addition, user can visualize the pedigree structure by ggped function.\nExample ğŸ’–Trace pedigree library(blupADC)\rpedigree_result=trace_pedigree(\rinput_pedigree=example_ped1, #provided pedigree data object\routput_pedigree_tree=TRUE # output pedigree tree\r)  Output By typing str(pedigree_result), we can get the output result of this function:\nstr(pedigree_result)\r## List of 5\r## $ ped : chr [1:15945, 1:3] \u0026quot;DD19348310\u0026quot; \u0026quot;DD19386807\u0026quot; \u0026quot;DD19119705\u0026quot; \u0026quot;DD16007415\u0026quot; ...\r## ..- attr(*, \u0026quot;dimnames\u0026quot;)=List of 2\r## .. ..$ : NULL\r## .. ..$ : chr [1:3] \u0026quot;Offspring\u0026quot; \u0026quot;Sire\u0026quot; \u0026quot;Dam\u0026quot;\r## $ rename_ped :'data.frame':\t15945 obs. of 6 variables:\r## ..$ Offspring : chr [1:15945] \u0026quot;DD19348310\u0026quot; \u0026quot;DD19386807\u0026quot; \u0026quot;DD19119705\u0026quot; \u0026quot;DD16007415\u0026quot; ...\r## ..$ Generation : num [1:15945] 0 0 0 0 0 0 0 0 0 0 ...\r## ..$ Offspring_Id: int [1:15945] 1 2 3 4 5 6 7 8 9 10 ...\r## ..$ Sire_Id : num [1:15945] 0 0 0 0 0 0 0 0 0 0 ...\r## ..$ Dam_Id : num [1:15945] 0 0 0 0 0 0 0 0 0 0 ...\r## ..$ Order : int [1:15945] 1 2 3 4 5 6 7 8 9 10 ...\r## $ pedigree_tree: chr [1:15945, 1:15] \u0026quot;DD19348310\u0026quot; \u0026quot;DD19386807\u0026quot; \u0026quot;DD19119705\u0026quot; \u0026quot;DD16007415\u0026quot; ...\r## ..- attr(*, \u0026quot;dimnames\u0026quot;)=List of 2\r## .. ..$ : NULL\r## .. ..$ : chr [1:15] \u0026quot;Offspring\u0026quot; \u0026quot;Sire\u0026quot; \u0026quot;Dam\u0026quot; \u0026quot;SireSire\u0026quot; ...\r## $ error_id_set :List of 4\r## ..$ error_duplicated_id: chr [1:24] \u0026quot;DD19119705\u0026quot; \u0026quot;DD20488904\u0026quot; \u0026quot;DD20153801\u0026quot; \u0026quot;DD20376912\u0026quot; ...\r## ..$ error_sex_id: chr \u0026quot;DD13006182\u0026quot;\r## ..$ error_breed_id: NULL\r## ..$ error_birth_date_id: NULL\r Output result includes several parts:\n ped: pedigree without rename rename_ped: renamed pedigree. The first column is original id, the second column is generation, columns 3-5 stand for the renamed pedigree. pedigree_tree: pedigree tree. Pedigree tree contains ancestry records information for each individual. For saving time, software doesn\u0026rsquo;t output pedigree tree in default. error_id_set: dataset of pedigree errors .According to the type of pedigree errors, these datasets can be divided four parts:  error_duplicated_id: same individual but has different records of sire and dam error_sex_id: same individual appears in the column of sire and dam simultaneously error_breed_id: breed of parents and offspring is different (only for specify format of original id) error_birth_date_id: offspring born before its parents (need to provide birth data information in the fourth column of pedigree)    Parameter ğŸ’¥Basic  1ï¼šinput_pedigree  User-provided pedigree data, data.frame  or matrix class.\nğŸ’ŒThe format of provided pedigree data should be one of the following format:\n 3 columns format:     Offspring Sire Dam     DD19575312 DD18768902 DD16376015   DD19513112 DD18768902 DD17111017   DD20348012 DD19132207 DD19234510   DD20361110 DD19331001 DD19293112   DD20471212 DD19331001 DD19320808   DD20564818 DD19331001 DD19311009     4 columns format:     Offspring Sire Dam Birth_Date     DD19575312 DD18768902 DD16376015 20200101   DD19513112 DD18768902 DD17111017 20200102   DD20348012 DD19132207 DD19234510 20200103   DD20361110 DD19331001 DD19293112 20200104   DD20471212 DD19331001 DD19320808 20200105   DD20564818 DD19331001 DD19311009 20200106     Multiple columns format:     Offspring Sire Dam SireSire DamSire SireSireSire     DD20231905 DD19581002 DD18750810 DD16785512 DD15507717 DD14008512   DD20458701 DD19564302 DD18925809 DD15349017 DD15245411 DD16771212   DD20324707 DD19232903 DD18571012 DD16794714 DD16744412 DD16714516   DD19288609 DD18713408 DD18552609 DD15180015 DD15479214 DD15243711   DD16222012 DD15145005 DD15378812 DD14110014 DD15501518 DD15206217   DD17684713 DD16672107 DD15122311 DD15505715 DD15347415 DD16383111    Note: When the format of provided pedigree data is multiple columns ï¼Œuser must set multi_col=TRUE, and the colnames of pedigree data should be the specify format , e.g. SireSire stands for the father of offspring\u0026rsquo;s father, SirSireSire stands for the father of SireSire\nMissing record in pedigree could be set as NA or 0 .\n 2ï¼šinput_pedigree_path  File path of pedigree data, character class.\n 3ï¼šinput_pedigree_name  File name of pedigree data, character class.\n 4ï¼šmulti_col  Whether convert multiple columns pedigree into standard 3 columns pedigree, logical class. When the format of provided pedigree data is multiple columns, user need to set multi_col=TRUE .\n 5ï¼štrace_id  Individuals set in tracing pedigree, character class. Default is NULL , which means tracing all individuals in pedigree.\n 6ï¼štrace_generation  The max generation in tracing pedigree, numeric class. Default is NULL , which means tracing all generation in pedigree.\n 7ï¼štrace_birth_date  Threshold of birth date in tracing pedigree, numeric class. Individuals set with birth date earlier than user provided birth date would be excluded in tracing pedigree.\n 8ï¼šoutput_pedigree_path  File path of output pedigree data, character class.\n 9ï¼šoutput_pedigree_name  File path of output pedigree name, character class.\nğŸ’¨Advanced  10ï¼šdup_error_check  Whether check the pedigree error of error_duplicatedï¼Œlogical class. Default is TRUE.\n 11ï¼šsex_error_check  Whether check the pedigree error of error_sexï¼Œlogical class. Default is TRUE.\n 12ï¼šbirth_date_error_check  Whether check the birth date error recordï¼Œlogical class. Default is TRUE.\n 13ï¼šoutput_pedigree_tree  Whether output the pedigree tree, logical class. Default is FALSE.\n 14ï¼špedigree_tree_depth  Depth of pedigree tree, numeric class. Default is 3.\n","date":1618617600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1618540363,"objectID":"fe2f55752ee6c514480937e584241f12","permalink":"/post/feature-4-trace_pedigree/pedigree/","publishdate":"2021-04-17T00:00:00Z","relpermalink":"/post/feature-4-trace_pedigree/pedigree/","section":"post","summary":"Pedigree analysis","tags":[],"title":"R package:blupADC-Feature 4","type":"post"},{"authors":[],"categories":["Check genotype"],"content":"Table of Contents  Overview Example  Breed composition analysis Check duplication   Output Parameter    Overview ğŸ‘¦ Breed composition analysis is usually a problem in data analysis. In package:blupADC, user can solve this problem by applying geno_check function. In addition, user can detect the duplication of genomic data easily by applying geno_check function.\nExample Breed composition analysis library(blupADC)\rcheck_result=geno_check(\rinput_data_hmp=example_PCA_data_hmp, #provided hapmap data object\rduplication_check=FALSE, #whether check the duplication of genotype\rbreed_check=TRUE, # whether check the record of breed\rbreed_record=example_PCA_Breed, # provided breed record\rreturn_result=TRUE #return result )\r Check duplication library(blupADC)\rcheck_result=geno_check(\rinput_data_hmp=example_data_hmp, #provided hapmap data object\rduplication_threshold=0.95, #threshold of duplication\rduplication_check=TRUE, #whether check the duplication of genotype\rbreed_check=FALSE, # whether check the record of breed\rreturn_result=TRUE #return result )\r Output The result of output mainly contains two parts, including:\n duplicated_genotype     IND1 IND1 1     IND2 IND2 1   IND3 IND3 1   IND4 IND4 1    The first and the second column is the name of individual, the third column is the percentage of overlap.\n pca_outlier     Id Breed Expeced_Breed     IND100 LL YY   IND233 DD YY   IND91 LL YY   IND92 LL YY   IND93 LL YY   IND94 LL YY    Figure A is the PCA result before correcting breed record , Figure B is the PCA result after correcting breed correcting record\nParameter Many parameters in genotype_data_overlap are the same as in genotype_data_format_conversion function (see more details).\nThus, we will introduce specific parameters in genotype_data_overlap function.\n 1ï¼šselected_snps  Number of SNPs in detecting overlap, numeric class. Default is 1000.\n 2ï¼šoverlap_threshold  Threshold of duplicate genotype, numeric class. Default is 0.95.\n 3ï¼šduplication_check  Whether check duplication of genotype, logical class. Default is TRUE.\n 4ï¼šbreed_check  Whether check breed record of genotype, logical class. Default is FALSE.\n 5ï¼šind_breed  Breed record of individuals, data.frame class.\nThe format of ind_breed is showing as follow:\n   Id Breed     IND1 YY   IND2 YY   IND3 YY   IND4 YY   IND5 YY   IND6 YY    When the proportion of genotype data between two individuals is larger than this threshold, these two individuals will be regarded as the same individual.\n","date":1618531200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1618470690,"objectID":"75aff2c2a58c226e359f94fc6b3b87d3","permalink":"/post/feature-3-overlap_pca/blupadc/","publishdate":"2021-04-16T00:00:00Z","relpermalink":"/post/feature-3-overlap_pca/blupadc/","section":"post","summary":"Breed composition analysis ","tags":[],"title":"R package:blupADC-Feature 3","type":"post"},{"authors":[],"categories":["Imputaion","QC"],"content":"Table of Contents  Overview Example Parameter  ğŸ’™Basic ğŸ’œAdvanced      Overview ğŸ¤– Generally, most genotype data need to perform quality control and imputation before applying in animal and plant breeding. For convenience, package blupADC provides genotype_data_QC_Imputation function to perform quality control and imputation by interfacing with software Plink and software Beagle in an easy way (we only need to provide the software path and software name).\nğŸ‘‰ Note: For convenience, blupADC has encapsulated software Plink(for quality control) version-1.9 and software Beagle(for imputation) version-5.2. If you want change this version, you should set the related parameters in the part of Advanced parameter.\nExample library(blupADC)\rgeno_qc_impute(\rinput_data_hmp=example_data_hmp, #provided hapmap data object\rdata_analysis_method=\u0026quot;QC_Imputation\u0026quot;, #analysis method type,QC + imputatoin\routput_data_path=getwd(), #output data path\routput_data_name=\u0026quot;YY_data\u0026quot;, #output data name\routput_data_type=\u0026quot;VCF\u0026quot; #output data format )  In the process of quality control and imputationï¼Œwe should provide genotype dataï¼Œthese parameters are the as in geno_format function(see more details).\nParameter ğŸ’™Basic   1ï¼šdata_analysis_method\nMethod of analyzing data, character class.\n \u0026quot;QC\u0026quot; : only perform quality control \u0026quot;Imputation\u0026quot; : only perform imputation    \u0026quot;QC_Imputation\u0026quot; : first perform quality control, and then perform imputation\n  2ï¼šqc_snp_rate\n  Threshold of SNPs call rate in quality control, numeric class. Default is 0.1\n 3ï¼šqc_ind_rate  Threshold of individuals call rate in quality control, numeric class. Default is 0.1\n 4ï¼šqc_maf  Threshold of minor allele frequency(MAF) in quality control, numeric class. Default is 0.05\n 5ï¼šqc_hwe  Threshold of hardy weinberg equilibrium(HWE) in quality control, numeric class. Default is 1e-7\nğŸ’œAdvanced  6ï¼šplink_software_path  Path of software Plink , character class.\n 7ï¼šplink_software_name  Name of software Plink , character class.\n 8ï¼šbeagle_software_path  Path of software Beagle , character class.\n 9ï¼šbeagle_software_name  Name of software Beagle , character class.\n 10ï¼šbeagle_ref_data_path  File path of reference data in imputation, character class.\n 11ï¼šbeagle_ref_data_name  File name of reference data in imputation, character class.\n 12ï¼šbeagle_ped_path  File path of pedigree data in imputation, character class.\n 13ï¼šbeagle_ped_name  File name of pedigree data in imputation, character class.\n","date":1618444800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1618664845,"objectID":"aa720309f26ed3c010d1cc0dd0b4148f","permalink":"/post/feature-2-qc_imputation/qc_imputation/","publishdate":"2021-04-15T00:00:00Z","relpermalink":"/post/feature-2-qc_imputation/qc_imputation/","section":"post","summary":"Genomic data quality control and genotype imputation","tags":[],"title":"R package:blupADC-Feature 2","type":"post"},{"authors":[],"categories":["Data format"],"content":"\r\r\rOverview\rExample\rOutput\rParameter\r\rğŸ¤¡Basic\rğŸ’¨Advanced\r\r\r\rOverview\rgeno_format is the basic function of package:blupADC. By applying geno_format , we can convert multiple genotype data formats in an easy way, including Hapmap, Plink, BLUPF90, Numeric, Haplotype and VCF.\n\rExample\rFormat conversion based on provided R variable\rlibrary(blupADC)\rformat_result=geno_format(\rinput_data_hmp=example_data_hmp, #provided hapmap data object output_data_type=c(\u0026quot;Plink\u0026quot;,\u0026quot;BLUPF90\u0026quot;,\u0026quot;Numeric\u0026quot;,\u0026quot;VCF\u0026quot;),# output data format\rreturn_result = TRUE, # return result cpu_cores=1 # number of cpu )\r\rFormat conversion based on provided data path and data name\r#convert phased VCF data to haplotype format and haplotype-based numeric format\rlibrary(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupADC\u0026quot;) # path of example files phased_result=geno_format(\rinput_data_path=data_path, # input data path input_data_name=\u0026quot;example.vcf\u0026quot;, # input data name,for vcf data input_data_type=\u0026quot;VCF\u0026quot;, # input data type\rphased_genotype=TRUE, # whether the vcf data has been phased\rhaplotype_window_nSNP=5, # according to nSNP define block,\routput_data_type=c(\u0026quot;Haplotype\u0026quot;,\u0026quot;Numeric\u0026quot;),# output data format\rreturn_result=TRUE, #save result as a R environment variable\rcpu_cores=1 # number of cpu )\r\rFormat conversion via bigmemory method\rlibrary(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupADC\u0026quot;) # path of example files phased=geno_format(\rinput_data_path=data_path, # input data path input_data_name=\u0026quot;example.vcf\u0026quot;, # input data name,for vcf data\rinput_data_type=\u0026quot;VCF\u0026quot;, # input data type\rphased_genotype=TRUE, # whether the vcf data has been phased\rhaplotype_window_nSNP=5, # according to nSNP define haplotype-block,\rbigmemory_cal=TRUE, # format conversion via bigmemory object\rbigmemory_data_path=getwd(), # path of bigmemory data bigmemory_data_name=\u0026quot;test_blupADC\u0026quot;, #name of bigmemory data output_data_type=c(\u0026quot;Haplotype\u0026quot;,\u0026quot;Numeric\u0026quot;),# output data format\rreturn_result=TRUE, #save result in R environment\rcpu_cores=1 # number of cpu )\r\r\rOutput\rAccording to the result of output, we find that the output contains 5 parts, including:\n\rhmp  : Hapmap format genotype data\r\rThe first column stands for the name of SNP, the thrid column stands for chromosome, the fourth column stands for the physical postion, and the twelth column and the after columns stand for the genotype data\n\r\r\rrs#\ralleles\rchrom\rpos\rstrand\rassembly\rcenter\rprotLSID\rassayLSID\rpanelLSID\rQCcode\r3098\r3498\r3297\r2452\r\r\r\rSNP1\rNA\r1\r224488\rNA\rNA\rNA\rNA\rNA\rNA\rNA\rCC\rAC\rAC\rCC\r\rSNP2\rNA\r1\r293696\rNA\rNA\rNA\rNA\rNA\rNA\rNA\rGG\rTG\rTG\rGG\r\rSNP3\rNA\r1\r333333\rNA\rNA\rNA\rNA\rNA\rNA\rNA\rGG\rTT\rTT\rGG\r\rSNP4\rNA\r1\r464830\rNA\rNA\rNA\rNA\rNA\rNA\rNA\rCC\rCC\rCC\rCC\r\rSNP5\rNA\r1\r722623\rNA\rNA\rNA\rNA\rNA\rNA\rNA\rAA\rGG\rGG\rAA\r\rSNP6\rNA\r1\r838596\rNA\rNA\rNA\rNA\rNA\rNA\rNA\rCC\rTC\rTT\rCC\r\r\r\r\rped : Plink format ped data\r\rThe first column stands for family name,the second column stands for the individual name,the seventh column and the after columns stand for the genotype data\n\r\r3098\r3098\r0\r0\r0\r0\rC\rC\rG\rG\r\r\r\r3498\r3498\r0\r0\r0\r0\rA\rC\rT\rG\r\r3297\r3297\r0\r0\r0\r0\rA\rC\rT\rG\r\r2452\r2452\r0\r0\r0\r0\rC\rC\rG\rG\r\r4255\r4255\r0\r0\r0\r0\rA\rC\rG\rG\r\r2946\r2946\r0\r0\r0\r0\rC\rC\rT\rG\r\r\r\r\rmap : Plinkformat map data\r\rThe first column stands for chromosome, the second column stands for the name of SNP, the thrid column stands for the genetic positon(CM), and the fourth column stands for the physical position\n\r\r1\rSNP1\r0.224488\r224488\r\r\r\r1\rSNP2\r0.293696\r293696\r\r1\rSNP3\r0.333333\r333333\r\r1\rSNP4\r0.464830\r464830\r\r1\rSNP5\r0.722623\r722623\r\r1\rSNP6\r0.838596\r838596\r\r\r\r\rblupf90 : BLUPF90 format genotype data\r\rThe first column stands for individual name, the second column stands for the genotype data(numeric)\n\r\r3098\r200000\r\r\r\r3498\r112021\r\r3297\r112022\r\r2452\r200000\r\r4255\r102011\r\r2946\r212000\r\r\r\r\rnumeric : Numeric format genotype data\r\rrownames of numeric data stands for the individual name, colnames of numeric data stands for the name of SNP, 0,1,2 stand for the numeric genotype\n\r\r2\r0\r0\r0\r0\r0\r\r\r\r1\r1\r2\r0\r2\r1\r\r1\r1\r2\r0\r2\r2\r\r2\r0\r0\r0\r0\r0\r\r1\r0\r2\r0\r1\r1\r\r2\r1\r2\r0\r0\r0\r\r\r\r\rhaplotype_hap: Haplotype format genotype data.\nRow stands for marker, column stands for individual, each individual has two columns;\n\r\r0\r0\r0\r1\r1\r0\r0\r0\r\r\r\r0\r0\r1\r0\r0\r1\r0\r0\r\r1\r1\r0\r0\r0\r0\r1\r1\r\r0\r0\r1\r1\r1\r1\r0\r0\r\r0\r0\r0\r1\r1\r1\r0\r0\r\r\r\rhaplotype_sample: Haplotype format genotype data\n\r\r3098\r\r\r\r3498\r\r3297\r\r2452\r\r4255\r\r2946\r\r\r\rhaplotype_map: Haplotype format genotype data\n\r\r1\rSNP1\r224488\rC\rA\r\r\r\r1\rSNP2\r293696\rG\rT\r\r1\rSNP3\r333333\rT\rG\r\r1\rSNP4\r464830\rA\rG\r\r1\rSNP5\r722623\rC\rT\r\r1\rSNP6\r838596\rC\rA\r\r\r\rvcf : VCF format genotype data\n\r\r\r\r##fileformat=VCFv4.2\r\r\r\r\r\r\r\r\r\r\r\r\r\r##source=â€œbeagle.29May21.d6d.jarâ€\r\r\r\r\r\r\r\r\r\r\r\r##INFO\u0026lt;ID=AF,Number=A,Type=Float\u0026gt;\r\r\r\r\r\r\r\r\r\r\r\r##INFO\u0026lt;ID=IMP,Number=0,Type=Flag\"\u0026gt;\r\r\r\r\r\r\r\r\r\r\r\r##FORMAT\u0026lt;ID=GT,Number=1,Type=String\u0026gt;\r\r\r\r\r\r\r\r\r\r\r\r#CHROM\rPOS\rID\rREF\rALT\rQUAL\rFILTER\rINFO\rFORMAT\r3498\r3297\r\r1\r6260\rM2\rT\rA\r.\rPASS\r.\rGT\r1|0\r0|1\r\r1\r15289\rM17\rA\rT\r.\rPASS\r.\rGT\r0|0\r0|0\r\r\r\r\rParameter\rğŸ¤¡Basic\r\r1: input_data_plink_ped\r\rUser-provided Plink-ped format genotype data ï¼Œdata.frame or matrix class.\n\r2:input_data_plink_map\r\rUser-provided Plink-map format genotype data ï¼Œdata.frame or matrix class.\n\r3:input_data_hmp\r\rUser-provided Hapmap format genotype data ï¼Œdata.frame or matrix class.\n\r4:input_data_BLUPF90\r\rUser-provided BLUPF90 format genotype data ï¼Œdata.frame or matrix class.\n\r5:input_data_numeric\r\rUser-provided Numeric format genotype data ï¼Œdata.frame or matrix class.\n\r6:input_data_haplotype_hap\r\rUser-provided Haplotype format genotype data ï¼Œdata.frame or matrix class.\n\r7:input_data_haplotype_sample\r\rUser-provided Haplotype format genotype data ï¼Œdata.frame or matrix class.\n\r8:input_data_haplotype_map\r\rUser-provided Haplotype format genotype data ï¼Œdata.frame or matrix class.\n\r9:input_data_vcf\r\rUser-provided VCF format genotype data ï¼Œdata.frame or matrix class.\nNote: input_data_numeric should contain both rownames and colnames.\nIn addition, for convenience, users can provide the file name, file path, and file type of genotype data directly without reading them in R environment.\n\r10:input_data_type\nFile type of provided genotype data ï¼Œcharacter class.\n\rHapmap\rPlink\rBLUPF90\rNumeric\rHaplotype\rVCF\r\r11:input_data_path\n\r\rFile path of provided genotype data ï¼Œcharacter class.\n\r12:input_data_name\r\rFile name of provided genotype data ï¼Œcharacter class.\nNote: if input_data_type is Plink or VCF, user donâ€™t need to include suffix in the file name of genotype data.\neg. for Plink type data, files name are test1.map and test1.pedï¼Œwe should setinput_data_name=\"test1\".\n\r13:output_data_name\r\rFile name of output genotype data, character class.\n\r14:output_data_type\nFile type of output genotype data, character class.\n\rHapmap\rPlink\rBLUPF90\rNumeric\rHaplotype\rVCF\r\r\rNote: users can output multiple formats of genotype data simultaneously. e.g.output_data_type=c(\"Hapmap\",\"Plink\",\"BLUPF90\",\"Numeric\"), outout 4 types of genotype data simultaneously .\n\r15:return_result\r\rWhether return result, logical class. Default is FALSE.\nAdditionally, for convenience, users can save output genotype data into local computer .\n\r16:bigmemory_cal\r\rWhether using bigmemory method to calculate. logical class. Default is FALSE.\n\r17:bigmemory_data_path\r\rThe file path bigmemory data . character class.\n\r18:bigmemory_data_name\r\rThe file name bigmemory data . character class.\n\r19:phased_genotype\r\rWhether genotype data has been phased. logical class. Default is FALSE.\n\r20:haplotype_window_nSNP\r\rAccording to the number of consecutive SNPs define haplotype block. numeric class. Default is NULL.\n\r21:haplotype_window_kb\r\rAccording to the physical location define haplotype block. numeric class. Default is NULL.\n\r22:haplotype_window_block\r\rAccording to user-provided block to define haplotype block . numeric class. Default is NULL.\nThe first column is the position of window start, the second column is the position of window end.\n\r\r1\r5\r\r\r\r6\r10\r\r11\r15\r\r16\r20\r\r21\r25\r\r26\r30\r\r\r\r\rğŸ’¨Advanced\r\r23:cpu_cores\r\rNumber of cpu in calculating, numeric class. Default is 1.\n\r24:miss_base\r\rMissing genotype character, character class. Default is â€œNNâ€.\n\r25:miss_base_num\r\rMissing genotype number after numeric conversion, numeric class. Default is 5.\n\r26:miss_base_num\r\rMissing genotype number after numeric conversion, numeric class. Default is 5.\n\r\r","date":1618358400,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1618383581,"objectID":"b107928fdee05958ff3b5aa1f0ccc19d","permalink":"/post/blupadc/","publishdate":"2021-04-14T00:00:00Z","relpermalink":"/post/blupadc/","section":"post","summary":"Genomic data format conversion","tags":[],"title":"R package:blupADC-Feature 1","type":"post"},{"authors":[],"categories":["blupADC"],"content":"Table of Contents    R package for animal and plant breeding   Contents  OVERVIEW ğŸ‘¨â€ğŸ’» Citation   New features  1.0.3 1.0.4 1.0.5   GETTING STARTED  ğŸ™ŠInstallation ğŸ™ŠFeatures   Usage        R package for animal and plant breeding Contents   OVERVIEW\n  GETTING STARTED\n Installation Features    USAGE\n   Documents support two-language(English and Chinese). OVERVIEW blupADC is an useful and powerful tool for handling genomic data and pedigree data in animal and plant breeding(traditional blup and genomic selection). In the design of this package, most of data analysis problems in breeding have been considered, and the speed of calculation is also the key point. In terms of the speed, the core functions of this package are coded by c++ (Rcpp and RcppArmadillo ) , and it also supports parallel calculation (by applying openMP programming) and big data calculation(by importing bigmemory  package).\nblupADC provides many useful functions for the whole steps for animal and plant breeding, including pedigree analysis(trace pedigree, rename pedigree, and correct pedigree errors), genotype data format conversion(supports Hapmap, Plink, Blupf90, Numeric, VCF and Haplotype format), genotype data quality control and imputation, construction of kinship matrix(pedigree, genomic and single-step),and genetic evaluation( by interfacing with two famous breeding softwares, DMU and BLUPF90 in an easy way).\nFinally, we kindly provides an easier way of applying blupADC, which is a free website(shinyapp). Several functions are still under development. But the pitfall of this website is that it can\u0026rsquo;t handle big data.\nğŸ˜Š Good Luck Charlie ! If you have suggestion or question, please contact: hzau_qsmei@163.com !\nğŸ‘¨â€ğŸ’» Citation Quanshun Mei, Chuanke Fu, Jieling Li, Shuhong Zhao, and Tao Xiang. \u0026ldquo;blupADC: An R package and shiny toolkit for comprehensive genetic data analysis in animal and plant breeding.\u0026rdquo; bioRxiv (2021), doi: https://doi.org/10.1101/2021.09.09.459557\nNew features 1.0.3  Incorporate maternal effect, permanent effect, random regression effect, and social genetic effect models in the genetic evaluation by DMU (2021.8.24)  1.0.4  Incorporate haplotype format conversion ,haplotype-based numeric matrix construction and haplotype-based additive relationship matrix construction (2021.10.8) Import bigmemory object in matrix save and calculation for handling big data(2021.10.8)  1.0.5  Incorporate format conversion from blupf90 and numeric(0,1,2) format to hapmap format (2021.11.5) Support LR method to evaluate prediction accuracy and Hotelling_test to test significance between predictive abilities(by cross-validation method) Fix dEBV(2021.12.22)  GETTING STARTED ğŸ™ŠInstallation blupADC links to R packages Rcpp, RcppArmadillo , data.table and bigmemory . These dependencies should be installed before installing blupADC.\ninstall.packages(c(\u0026quot;Rcpp\u0026quot;, \u0026quot;RcppArmadillo\u0026quot;,\u0026quot;RcppProgress\u0026quot;,\u0026quot;data.table\u0026quot;,\u0026quot;bigmemory\u0026quot;))\r ğŸ‘‰ Note: In the analysis of DMU and BLUPF90 , we need to download software DMU (DMU download website) and BLUPF90 previously (BLUPF90 download website). For convenience, we have encapsulated the basic module of DMU and BLUPF90 in package blupADC.\nFor commercial use of DMU and BLUPF90, user must contact the author of DMU and BLUPF90 !!!\nInstall blupADC via devtools (way1) devtools::install_github(\u0026quot;TXiang-lab/blupADC\u0026quot;)\r Install blupADC (way2) packageurl \u0026lt;- \u0026quot;https://github.com/TXiang-lab/blupADC/releases/download/V1.0.6/blupADC_1.0.6.tar.gz\u0026quot;\rinstall.packages(packageurl,repos=NULL,method=\u0026quot;libcurl\u0026quot;)\r ğŸ‘‰ Note:If the connection with github is not good(such as in China), user can download as below:\nInstall blupADC (way3) packageurl \u0026lt;- \u0026quot;https://gitee.com/qsmei/blupADC/attach_files/1062637/download/blupADC_1.0.6.tar.gz\u0026quot;\rinstall.packages(packageurl,repos=NULL,method=\u0026quot;libcurl\u0026quot;)\r After installed successfully, the blupADC package can be loaded by typing\nlibrary(blupADC)\r Note: In terms of the relationship matrix construction, we highly recommend Microsoft R Open(faster than traditional R many times)\nğŸ™ŠFeatures  Feature 1. Genomic data format conversion Feature 2. Genomic data quality control and genotype imputation Feature 3. Breed composition analysis and duplication detection of genomic data Feature 4. Pedigree tracing, and analysis Feature 5. Pedigree visualization Feature 6. Relationship matrix construction(A,G, and H) Feature 7. Genetic evaluation with DMU Feature 8. Genetic evaluation with BLUPF90  Usage blupADC provides several datasets objects, including data_hmp, origin_pedigree.\nIn addition, blupADC provides several files which are saved in ~/blupADC/extdata. We can get the path of these files by typing\nsystem.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupADC\u0026quot;) # path of provided files\r Feature 1. Genomic data format conversion (see more details) library(blupADC)\rformat_result=geno_format(\rinput_data_hmp=example_data_hmp, # provided data variable\routput_data_type=c(\u0026quot;Plink\u0026quot;,\u0026quot;BLUPF90\u0026quot;,\u0026quot;Numeric\u0026quot;),# output data format\routput_data_path=getwd(), #output data path output_data_name=\u0026quot;blupADC\u0026quot;, #output data name return_result = TRUE, #save result in R environment\rcpu_cores=1 # number of cpu )\r#convert phased VCF data to haplotype format and haplotype-based numeric format\rlibrary(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupADC\u0026quot;) # path of example files phased=geno_format(\rinput_data_path=data_path, # input data path input_data_name=\u0026quot;example.vcf\u0026quot;, # input data name,for vcf data\rinput_data_type=\u0026quot;VCF\u0026quot;, # input data type\rphased_genotype=TRUE, # whether the vcf data has been phased\rhaplotype_window_nSNP=5, # according to nSNP define haplotype-block,\rbigmemory_cal=TRUE, # format conversion via bigmemory object\rbigmemory_data_path=getwd(), # path of bigmemory data bigmemory_data_name=\u0026quot;test_blupADC\u0026quot;, #name of bigmemory data output_data_type=c(\u0026quot;Haplotype\u0026quot;,\u0026quot;Numeric\u0026quot;),# output data format\rreturn_result=TRUE, #save result in R environment\rcpu_cores=1 # number of cpu )\r Feature 2. Genomic data quality control and genotype imputation (see more details) library(blupADC)\rgeno_qc_impute(\rinput_data_hmp=example_data_hmp, #provided data variable\rdata_analysis_method=\u0026quot;QC_Imputation\u0026quot;, #analysis method type,QC + imputatoin\routput_data_path=getwd(), #output data path\routput_data_name=\u0026quot;YY_data\u0026quot;, #output data name\routput_data_type=\u0026quot;VCF\u0026quot; #output data format )  Feature 3. Breed composition analysis and duplication detection of genomic data (see more details) library(blupADC)\rcheck_result=geno_check(\rinput_data_hmp=example_PCA_data_hmp, #provided hapmap data object\rduplication_check=FALSE, #whether check the duplication of genotype\rbreed_check=TRUE, # whether check the record of breed\rbreed_record=example_PCA_Breed, # provided breed record\routput_data_path=getwd(), #output path\rreturn_result=TRUE #save result as a R environment variable\r)\r Feature 4. Pedigree tracing, analysis (see more details) library(blupADC)\rpedigree_result=trace_pedigree(\rinput_pedigree=example_ped1, #provided pedigree data variable\rtrace_generation=3, # trace generation\routput_pedigree_tree=T # output pedigree tree\r)  Feature 5. Pedigree visualization (see more details) library(blupADC)\rplot=ggped(\rinput_pedigree=example_ped2,\rtrace_id=c(\u0026quot;121\u0026quot;),\rtrace_sibs=TRUE #whether plot the sibs of subset-id )  Feature 6. Relationship matrix construction(A,G, and H) (see more details) library(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupADC\u0026quot;) # path of example files kinship_result=cal_kinship(\rinput_data_path=data_path, # input data path input_data_name=\u0026quot;example.vcf\u0026quot;, # input data name,for vcf data\rinput_data_type=\u0026quot;VCF\u0026quot;, # input data type\rkinship_type=c(\u0026quot;G_A\u0026quot;,\u0026quot;G_D\u0026quot;), #type of kinship matrix\rdominance_type=c(\u0026quot;genotypic\u0026quot;), #type of dominance effect\rinbred_type=c(\u0026quot;Homozygous\u0026quot;), #type of inbreeding coefficients\rreturn_result=TRUE) #save result as a R environment variable  Feature 7. Genetic evaluation with DMU (see more details) library(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupADC\u0026quot;) # path of example files run_DMU(\rphe_col_names=c(\u0026quot;Id\u0026quot;,\u0026quot;Mean\u0026quot;,\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;,\u0026quot;Litter\u0026quot;,\u0026quot;Trait1\u0026quot;,\u0026quot;Trait2\u0026quot;,\u0026quot;Age\u0026quot;), # colnames of phenotype target_trait_name=list(c(\u0026quot;Trait1\u0026quot;)), #trait name fixed_effect_name=list(c(\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;)), #fixed effect name\rrandom_effect_name=list(c(\u0026quot;Id\u0026quot;,\u0026quot;Litter\u0026quot;)), #random effect name\rcovariate_effect_name=NULL, #covariate effect name\rphe_path=data_path, #path of phenotype file\rphe_name=\u0026quot;phenotype.txt\u0026quot;, #name of phenotype file\rinteger_n=5, #number of integer variable analysis_model=\u0026quot;PBLUP_A\u0026quot;, #model of genetic evaluation\rdmu_module=\u0026quot;dmuai\u0026quot;, #modeule of estimating variance components relationship_path=data_path, #path of relationship file relationship_name=\u0026quot;pedigree.txt\u0026quot;, #name of relationship file output_result_path=getwd() # output path )\r Feature 8. Genetic evaluation with BLUPF90 (see more details) library(blupADC)\rdata_path=system.file(\u0026quot;extdata\u0026quot;, package = \u0026quot;blupADC\u0026quot;) # path of example files run_BLUPF90(\rphe_col_names=c(\u0026quot;Id\u0026quot;,\u0026quot;Mean\u0026quot;,\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;,\u0026quot;Litter\u0026quot;,\u0026quot;Trait1\u0026quot;,\u0026quot;Trait2\u0026quot;,\u0026quot;Age\u0026quot;), # colnames of phenotype target_trait_name=list(c(\u0026quot;Trait1\u0026quot;)), #trait name fixed_effect_name=list(c(\u0026quot;Sex\u0026quot;,\u0026quot;Herd_Year_Season\u0026quot;)), #fixed effect name\rrandom_effect_name=list(c(\u0026quot;Id\u0026quot;,\u0026quot;Litter\u0026quot;)), #random effect name\rcovariate_effect_name=NULL, #covariate effect name\rphe_path=data_path, #path of phenotype file\rphe_name=\u0026quot;phenotype.txt\u0026quot;, #name of phenotype file\ranalysis_model=\u0026quot;PBLUP_A\u0026quot;, #model of genetic evaluation\rrelationship_path=data_path, #path of relationship file relationship_name=\u0026quot;pedigree.txt\u0026quot;, #name of relationship file output_result_path=getwd() # output path )  ","date":1618272000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1618324356,"objectID":"797828734720c63d3bac747eef5c9b10","permalink":"/post/feature-0-overview/overview/","publishdate":"2021-04-13T00:00:00Z","relpermalink":"/post/feature-0-overview/overview/","section":"post","summary":"Overview of package:blupADC ","tags":[],"title":"R package:blupADC- Overview","type":"post"},{"authors":["Xiao Peng","LiLin Yin","Quanshun Mei","HaiYan Wang","XiaoLei Liu","MengJin Zhu","XinYun Li","LiangLiang Fu","ShuHong Zhao"],"categories":null,"content":"\r\n\r\n\r\n","date":1552780800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1552780800,"objectID":"41aceea88626254cf07c5d6c731a0f69","permalink":"/publication/2019.cn_co_author/","publishdate":"2019-03-17T00:00:00Z","relpermalink":"/publication/2019.cn_co_author/","section":"publication","summary":"This study aimed to systematically compare the accuracy of genomic selection for important economic traits in pigs by using 8 models including GBLUP, SSGBLUP, BayesA, BayesB, BayesC, BayesLASSO, BSLMM and BayesR. The data of age at 100 kg, backfat thickness at 100 kg and teat numbers were collected from 2 585 Yorkshire sows and all the individuals were genotyped by using PorcineSNP50K Beadchip. The accuracy of genomic selection for the 8 models were compared by a 5-fold cross-validation procedure based on additive model. The results demonstrated that the accuracy of genomic selection were positively correlated with the calculated heritabilities of different traits. The cross-validation analysis indicated that the prediction accuracy of age at 100 kg was the highest among the 3 different traits, but different models performed dissimilarly in different traits. The prediction accuracy of SSGBLUP was the highest for both age at 100 kg and backfat thickness at 100 kg, and the prediction accuracy of BayesA was the highest for teat numbers. In conclusion, SSGBLUP model can be used for the traits with moderate and high heritabilities when conducting genomic prediction for small sample size and BayesA is suitable to the traits with low heritability. How to optimize and select a model that is applicable to all traits may be a research direction in the future.","tags":["Source Themes"],"title":"A study of genome selection based on the porcine major economic traits","type":"publication"},{"authors":[],"categories":[],"content":"Create slides in Markdown with Wowchemy Wowchemy | Documentation\n Features  Efficiently write slides in Markdown 3-in-1: Create, Present, and Publish your slides Supports speaker notes Mobile friendly slides   Controls  Next: Right Arrow or Space Previous: Left Arrow Start: Home Finish: End Overview: Esc Speaker notes: S Fullscreen: F Zoom: Alt + Click PDF Export: E   Code Highlighting Inline code: variable\nCode block:\nporridge = \u0026quot;blueberry\u0026quot; if porridge == \u0026quot;blueberry\u0026quot;: print(\u0026quot;Eating...\u0026quot;)   Math In-line math: $x + y = z$\nBlock math:\n$$ f\\left( x \\right) = ;\\frac{{2\\left( {x + 4} \\right)\\left( {x - 4} \\right)}}{{\\left( {x + 4} \\right)\\left( {x + 1} \\right)}} $$\n Fragments Make content appear incrementally\n{{% fragment %}} One {{% /fragment %}} {{% fragment %}} **Two** {{% /fragment %}} {{% fragment %}} Three {{% /fragment %}}  Press Space to play!\nOne  Two  Three \n A fragment can accept two optional parameters:\n class: use a custom style (requires definition in custom CSS) weight: sets the order in which a fragment appears   Speaker Notes Add speaker notes to your presentation\n{{% speaker_note %}} - Only the speaker can read these notes - Press `S` key to view {{% /speaker_note %}}  Press the S key to view the speaker notes!\n Only the speaker can read these notes Press S key to view    Themes  black: Black background, white text, blue links (default) white: White background, black text, blue links league: Gray background, white text, blue links beige: Beige background, dark text, brown links sky: Blue background, thin dark text, blue links    night: Black background, thick white text, orange links serif: Cappuccino background, gray text, brown links simple: White background, black text, blue links solarized: Cream-colored background, dark green text, blue links   Custom Slide Customize the slide style and background\n{{\u0026lt; slide background-image=\u0026quot;/media/boards.jpg\u0026quot; \u0026gt;}} {{\u0026lt; slide background-color=\u0026quot;#0000FF\u0026quot; \u0026gt;}} {{\u0026lt; slide class=\u0026quot;my-style\u0026quot; \u0026gt;}}   Custom CSS Example Let\u0026rsquo;s make headers navy colored.\nCreate assets/css/reveal_custom.css with:\n.reveal section h1, .reveal section h2, .reveal section h3 { color: navy; }   Questions? Ask\nDocumentation\n","date":1549324800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1549324800,"objectID":"0e6de1a61aa83269ff13324f3167c1a9","permalink":"/slides/example/","publishdate":"2019-02-05T00:00:00Z","relpermalink":"/slides/example/","section":"slides","summary":"An introduction to using Wowchemy's Slides feature.","tags":[],"title":"Slides","type":"slides"},{"authors":null,"categories":null,"content":"blupADC is an useful and powerful tool for handling genomic data and pedigree data in animal and plant breeding(traditional blup and genomic selection). In the design of this package, most of data analysis problems in breeding have been considered, and the speed of calculation is also the key point. In terms of the speed, the core functions of this package are coded by c++ (Rcpp and RcppArmadillo ) , and it also supports parallel calculation (by applying openMP programming) and big data calculation(by importing bigmemory  package).\nblupADC provides many useful functions for the whole steps for animal and plant breeding, including pedigree analysis(trace pedigree, rename pedigree, and correct pedigree errors), genotype data format conversion(supports Hapmap, Plink, Blupf90, Numeric, VCF and Haplotype format), genotype data quality control and imputation, construction of kinship matrix(pedigree, genomic and single-step),and genetic evaluation( by interfacing with two famous breeding softwares, DMU and BLUPF90 in an easy way).\nFinally, we kindly provides an easier way of applying blupADC, which is a free website(shinyapp). Several functions are still under development. But the pitfall of this website is that it can\u0026rsquo;t handle big data.\n","date":1461715200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1461715200,"objectID":"ca427fd7e27c338c4b0ad838b390c92f","permalink":"/project/blupadc/","publishdate":"2016-04-27T00:00:00Z","relpermalink":"/project/blupadc/","section":"project","summary":"R package for animal and plant breeding, including genotype data analysis, pedigree data analysis, relationship matrix construction and mixed model solving!","tags":["Deep Learning"],"title":"blupADC","type":"project"},{"authors":null,"categories":null,"content":"cBar2 is an useful and powerful tool for handling two-way cross breeding in animal and plant breeding. In addition, it provides a powerful function to do allele tracing for this case.\nBy applying this package, user can complete the genetic evaluation with three different types of partial relationship matrix(pedigree, genomic, and single-step partial relationship matrix).\n","date":1461715200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1461715200,"objectID":"ac5dd5912ccec346c431e2a2bfa925cf","permalink":"/project/cbar2/","publishdate":"2016-04-27T00:00:00Z","relpermalink":"/project/cbar2/","section":"project","summary":"R package for two-way cross breed analysis!","tags":["Deep Learning"],"title":"cBar2","type":"project"},{"authors":null,"categories":null,"content":"","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"f26b5133c34eec1aa0a09390a36c2ade","permalink":"/admin/config.yml","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/admin/config.yml","section":"","summary":"","tags":null,"title":"","type":"wowchemycms"}]