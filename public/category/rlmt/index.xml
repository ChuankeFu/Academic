<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Rlmt | QSmei-Academic</title>
    <link>/category/rlmt/</link>
      <atom:link href="/category/rlmt/index.xml" rel="self" type="application/rss+xml" />
    <description>Rlmt</description>
    <generator>Wowchemy (https://wowchemy.com)</generator><language>en-us</language><lastBuildDate>Tue, 23 Aug 2022 00:00:00 +0000</lastBuildDate>
    <image>
      <url>/media/icon_hua2ec155b4296a9c9791d015323e16eb5_11927_512x512_fill_lanczos_center_2.png</url>
      <title>Rlmt</title>
      <link>/category/rlmt/</link>
    </image>
    
    <item>
      <title>R package:Rlmt- Overview</title>
      <link>/post/rlmt-overview/overview/</link>
      <pubDate>Tue, 23 Aug 2022 00:00:00 +0000</pubDate>
      <guid>/post/rlmt-overview/overview/</guid>
      <description>&lt;details class=&#34;toc-inpage d-print-none  &#34; open&gt;
  &lt;summary class=&#34;font-weight-bold&#34;&gt;Table of Contents&lt;/summary&gt;
  &lt;nav id=&#34;TableOfContents&#34;&gt;
  &lt;ul&gt;
    &lt;li&gt;
      &lt;ul&gt;
        &lt;li&gt;&lt;a href=&#34;#rlmt-r-warrper-of-the-linear-mixed-models-toolbox-lmt&#34;&gt;Rlmt: R warrper of the Linear Mixed Models Toolbox (LMT)&lt;/a&gt;&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
    &lt;li&gt;&lt;a href=&#34;#contents&#34;&gt;Contents&lt;/a&gt;
      &lt;ul&gt;
        &lt;li&gt;&lt;a href=&#34;#overview&#34;&gt;OVERVIEW&lt;/a&gt;&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
    &lt;li&gt;&lt;a href=&#34;#getting-started&#34;&gt;GETTING STARTED&lt;/a&gt;
      &lt;ul&gt;
        &lt;li&gt;&lt;a href=&#34;#installation&#34;&gt;ðŸ™ŠInstallation&lt;/a&gt;&lt;/li&gt;
        &lt;li&gt;&lt;a href=&#34;#examples&#34;&gt;ðŸ™ŠExamples&lt;/a&gt;&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
    &lt;li&gt;&lt;a href=&#34;#usage&#34;&gt;Usage&lt;/a&gt;
      &lt;ul&gt;
        &lt;li&gt;&lt;/li&gt;
      &lt;/ul&gt;
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/nav&gt;
&lt;/details&gt;

&lt;h3 id=&#34;rlmt-r-warrper-of-the-linear-mixed-models-toolbox-lmt&#34;&gt;Rlmt: R warrper of the Linear Mixed Models Toolbox (LMT)&lt;/h3&gt;
&lt;h2 id=&#34;contents&#34;&gt;Contents&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;#overview&#34;&gt;OVERVIEW&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;#getting-started&#34;&gt;GETTING STARTED&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;#usage&#34;&gt;USAGE&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;h3 id=&#34;overview&#34;&gt;OVERVIEW&lt;/h3&gt;
&lt;p&gt;â€‹	The &lt;strong&gt;L&lt;/strong&gt;inear mixed &lt;strong&gt;M&lt;/strong&gt;odels &lt;strong&gt;T&lt;/strong&gt;oolbox (&lt;strong&gt;lmt&lt;/strong&gt;) is a stand-alone single executable software for for large scale linear mixed model analysis. &lt;strong&gt;lmt&lt;/strong&gt; has been used successfully for genetic evaluation data sets with &amp;raquo;200k genotyped animals, &amp;raquo;15m animals, &amp;raquo;500m equations. More details about lmt can be found in website: &lt;a href=&#34;https://dmu.ghpc.au.dk/lmt/wiki/index.php?title=The_Linear_Mixed_Models_Toolbox&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;lmt website&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;â€‹	In order to further assistance the use of lmt, i developed an R package: Rlmt for interfacing with lmt. This R package is developed via R6 package which can provides an implementation of encapsulated object-oriented programming for R.  And this makes the grammar of Rlmt looks like easy and elegant (i hope ðŸ˜„).&lt;/p&gt;
&lt;p&gt;â€‹	About the usage of lmt in academic and commercial,  user should follow the rules  as mentioned in lmt website.&lt;/p&gt;
&lt;h2 id=&#34;getting-started&#34;&gt;GETTING STARTED&lt;/h2&gt;
&lt;h3 id=&#34;installation&#34;&gt;ðŸ™ŠInstallation&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;Rlmt&lt;/code&gt; links to R packages &lt;code&gt;R6&lt;/code&gt;. This package should be installed before installing &lt;code&gt;Rlmt&lt;/code&gt;.   &lt;code&gt;Rlmt&lt;/code&gt; is available by sending a request to the &lt;em&gt;author&lt;/em&gt; (&lt;a href=&#34;mailto:hzau_qsmei@163.com&#34;&gt;hzau_qsmei@163.com&lt;/a&gt;),&lt;/p&gt;
&lt;h3 id=&#34;examples&#34;&gt;ðŸ™ŠExamples&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Ex 1. PBLUP&lt;/li&gt;
&lt;li&gt;Ex 2. SSGBLUP&lt;/li&gt;
&lt;li&gt;Ex 3. Multiple traits analysis&lt;/li&gt;
&lt;li&gt;Ex 4. Several special models&lt;/li&gt;
&lt;li&gt;Ex 5. Switch to different BLUP analysis&lt;/li&gt;
&lt;li&gt;Ex 6. Modify jobs&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;usage&#34;&gt;Usage&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Rlmt&lt;/code&gt; provides several files which are saved in &lt;code&gt;~/Rlmt/extdata&lt;/code&gt;. We can get the path of these files by typing&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-{.r}&#34;&gt;system.file(&amp;quot;extdata&amp;quot;, package = &amp;quot;Rlmt&amp;quot;) # path of provided files
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;ex-1-pblup&#34;&gt;Ex 1. PBLUP&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-R&#34;&gt;library(Rlmt)
# path of example data  
example_path=system.file(&amp;quot;extdata&amp;quot;, package = &amp;quot;Rlmt&amp;quot;) 
#construct lmt_data object
mydata=lmt_data$new(phe_file=paste0(example_path,&amp;quot;/data.csv&amp;quot;),					
                    ped_file=paste0(example_path,&amp;quot;/pedigree_unsorted.csv&amp;quot;)) 

#construct  lmt_models object
mymodels=lmt_models$new(fixed=tr1~f11+f12+f13,covariate=~c1c1,random=~id)

#construct Rlmt object
mylmt=Rlmt$new(models=mymodels,data=mydata,software_path=&amp;quot;....../lmt&amp;quot;)

#do analysis
mylmt$do_analysis(&amp;quot;....../test_Result&amp;quot;) #output path

&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;ex-2-ssgblup&#34;&gt;Ex 2. SSGBLUP&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-R&#34;&gt;library(Rlmt)
# path of example data  
example_path=system.file(&amp;quot;extdata&amp;quot;, package = &amp;quot;Rlmt&amp;quot;) 
#construct lmt_data object
mydata=lmt_data$new(phe_file=paste0(example_path,&amp;quot;/data.csv&amp;quot;),				    
                    ped_file=paste0(example_path,&amp;quot;/pedigree_unsorted.csv&amp;quot;),					
                    geno_file=paste0(example_path,&amp;quot;/genotypes.txt&amp;quot;),					
                    geno_id_file=paste0(example_path,&amp;quot;/genoids.csv&amp;quot;))

#construct  lmt_models object
mymodels=lmt_models$new(fixed=tr1~f11+f12+f13,covariate=~c1c1,random=~id)
mymodels$pars$blup_type=&amp;quot;SS_GBLUP&amp;quot;
#construct Rlmt object
mylmt=Rlmt$new(models=mymodels,data=mydata,software_path=&amp;quot;....../lmt&amp;quot;)

#do analysis
mylmt$do_analysis(&amp;quot;....../Rlmt/test_Result&amp;quot;) #output path                
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;ex-3-multiple-traits-analysis&#34;&gt;Ex 3. Multiple traits analysis&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-R&#34;&gt;m2=lmt_formulas$new(fixed=tr2~f11+f12+f13,covariate=~c1c1,random=~id) #creat lmt_formulas object
mylmt$models$add_formulas(m2)
mylmt$do_analysis(&amp;quot;....../test_Result&amp;quot;) #multple traits analysis

m2=lmt_formulas$new(fixed=tr2~f11+f13,covariate=~c1c1+c1c2+c2c1,random=~id) #modify effect of tr2
mylmt$models$add_formulas(m2)
mylmt$do_analysis(&amp;quot;....../Rlmt/test_Result&amp;quot;) #output path    
mylmt$models$rm_formulas(&amp;quot;tr2&amp;quot;) #removes trait: tr2 in analysis
mylmt$do_analysis(&amp;quot;....../Rlmt/test_Result&amp;quot;) #output path  

&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;ex-4--several-special-models&#34;&gt;Ex 4.  Several special models&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-R&#34;&gt;# maternal effect
m1=lmt_formulas$new(fixed=tr1~f11+f12+f13,covariate=~c1c1,random=~id+dam) 

# permanent effect
m1=lmt_formulas$new(fixed=tr1~f11+f12+f13,covariate=~c1c1,random=~id+dam+pe) 

#nested  effect
m1=lmt_formulas$new(fixed=tr1~f11+f12,covariate=~f13(c1c1),random=~id+dam+pe)

#user defined polynomial expression 
m1=lmt_formulas$new(fixed=tr1~f11+f12,covariate=~c1c1,random=~id+dam+pe,,polyno=c1c1~{x^2}+{exp(x)}) 

#3-order Legendre polynomials
m1=lmt_formulas$new(fixed=tr1~f11+f12,covariate=~c1c1,random=~id+dam+pe,,polyno=c1c1~{l1}+{l2}+{l3}) 

#random regression with 3-order Legendre polynomials
m1=lmt_formulas$new(fixed=tr1~f11+f12+f13,random=~c1c1(id)+c1c1(dam)+c1c1(pe),polyno=c1c1~{l1}+{l2}+{l3}) 

 # genetic group as extra random effect
mylmt$models$pars$gg_type=&amp;quot;extra&amp;quot;

mylmt$models$add_formulas(m1)

mylmt$models$add_formulas(m1) #update effect
mylmt$do_analysis(&amp;quot;....../test_Result&amp;quot;) #do analysis
&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;ex-5-switch-to-different-blup-analysis&#34;&gt;Ex 5. Switch to different BLUP analysis&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-R&#34;&gt;library(Rlmt)
# path of example data  
example_path=system.file(&amp;quot;extdata&amp;quot;, package = &amp;quot;Rlmt&amp;quot;) 
#construct lmt_data object
mydata=lmt_data$new(phe_file=paste0(example_path,&amp;quot;/data.csv&amp;quot;),				    
                    ped_file=paste0(example_path,&amp;quot;/pedigree_unsorted.csv&amp;quot;),					
                    geno_file=paste0(example_path,&amp;quot;/genotypes.txt&amp;quot;),					
                    geno_id_file=paste0(example_path,&amp;quot;/genoids.csv&amp;quot;))

#construct  lmt_models object
mymodels=lmt_models$new(fixed=tr1~f11+f12+f13,covariate=~c1c1,random=~id)

mylmt$models$pars$meta_gamma=0.5 #Metafounder

mymodels$pars$blup_type=&amp;quot;SS_TBLUP&amp;quot; #SS_TBLUP

mymodels$pars$blup_type=&amp;quot;SS_SNPBLUP&amp;quot; #SS_SNPBLUP

mymodels$pars$blup_type=&amp;quot;Defined_BLUP&amp;quot;   #Defined_BLUP
mylmt$data$grm$file=&amp;quot;test_external.bin&amp;quot;   #Defined_BLUP

#ssGBLUP with two genomic factors
mydata=lmt_data$new(phe_file=paste0(example_path,&amp;quot;/data.csv&amp;quot;),                  
                    ped_file=paste0(example_path,&amp;quot;/pedigree_unsorted.csv&amp;quot;),					
                    geno_file=paste0(example_path,c(&amp;quot;/genotypes1.txt&amp;quot;,&amp;quot;/genotypes2.txt&amp;quot;)),			
                    geno_id_file=paste0(example_path,c(&amp;quot;/genoids1.txt&amp;quot;,&amp;quot;/genoids2.txt&amp;quot;)))
mymodels=lmt_models$new(fixed=tr1~f11+f12+f13,covariate=~c1c1,random=~id1+id2)                    
     

mylmt$do_analysis(&amp;quot;/usr/home/qgg/qumei/Rlmt/test_Result&amp;quot;) #do analysis

&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&#34;ex--6--modify-jobs&#34;&gt;Ex  6.  Modify jobs&lt;/h4&gt;
&lt;pre&gt;&lt;code class=&#34;language-R&#34;&gt;#sampler 
m_jobs=lmt_jobs$new(type=&amp;quot;sample&amp;quot;)
mymodels$pars$jobs=m_jobs
m_jobs$samplers$type=c(&amp;quot;singlepass&amp;quot;,&amp;quot;blocked&amp;quot;)
mylmt$do_analysis(&amp;quot;....../test_Result&amp;quot;) #output path

		
#solver 
m_jobs=mymodels$pars$jobs
m_jobs$type=&amp;quot;mcemreml&amp;quot;
m_jobs$conv=-9.21034
m_jobs$rounds=300
mylmt$do_analysis(&amp;quot;....../test_Result&amp;quot;) #output path

#pevsolve
m_jobs=lmt_jobs$new(type=&amp;quot;pevsolve&amp;quot;)
mymodels$pars$jobs=m_jobs
mylmt$do_analysis(&amp;quot;....../test_Result&amp;quot;) #output path
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
  </channel>
</rss>
