---
title: 'R package:blupADC-ä½¿ç”¨è¯´æ˜7'
author: qsmei
date: '2021-04-21'
slug: blupf90
categories:
  - BLUPf90
tags: []
subtitle: ''
summary: 'Ré‡Œè¿è¡ŒBLUPF90è½¯ä»¶å¹¶å®Œæˆç›¸åº”çš„åˆ†æ'
authors: ["qsmei"]
lastmod: '2021-04-21T15:47:39+08:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
type: book
toc: ture 
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>

<div id="TOC">

</div>

<p>ğŸ‘»åœ¨å‰é¢çš„ç« èŠ‚ï¼Œæˆ‘ä»¬å·²ç»è®²è¿°äº†å¦‚ä½•åœ¨<strong>R</strong>ä¸­è°ƒç”¨<strong>DMU</strong>è½¯ä»¶å¹¶å®Œæˆç›¸åº”çš„åˆ†æã€‚æœ¬ç« ï¼Œæˆ‘ä»¬å°†è®²è¿°å¦‚ä½•é€šè¿‡<code>BLUP_ADC</code>ä¸­çš„<code>run_BLUPF90</code>å‡½æ•°ï¼Œåœ¨<strong>R</strong>ä¸­è°ƒç”¨<strong>BLUPF90</strong>è½¯ä»¶å¹¶å®Œæˆæ•°æ®åˆ†æã€‚ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·çš„ä½¿ç”¨ï¼Œæˆ‘ä»¬å·²ç»å°½å¯èƒ½åœ°å°† <code>run_BLUPF90</code>å‡½æ•°ä¸­çš„å‚æ•° å’Œ <code>run_DMU</code>å‡½æ•°ä¸­çš„å‚æ•°è¿›è¡Œäº†ç»Ÿä¸€ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­çœ‹çœ‹è¯¥å‡½æ•°çš„ç”¨æ³•:</p>
<pre class="R"><code>library(blupADC)
run_BLUPF90(        
            phe_col_names=c(&quot;Id&quot;,&quot;Sex&quot;,&quot;Herd_Year_Season&quot;,&quot;Litter&quot;,&quot;Trait1&quot;,&quot;Trait2&quot;,&quot;Age&quot;),  #è¡¨å‹æ•°æ®çš„åˆ—å
            target_trait_name=c(&quot;Trait1&quot;),                               #ç›®æ ‡æ€§çŠ¶åç§°
            fixed_effect_name=list(c(&quot;Sex&quot;,&quot;Herd_Year_Season&quot;)),         #å›ºå®šæ•ˆåº”åç§°
            random_effect_name=list(c(&quot;Id&quot;,&quot;Litter&quot;)),                   #éšæœºæ•ˆåº”åç§°
            covariate_effect_name=list(c(&quot;Age&quot;)),                        #åå˜é‡åç§°
            phe_path=&quot;D:/test_code/BLUP_ADC_code/DMU_example&quot;,           #è¡¨å‹æ•°æ®è·¯å¾„
            phe_name=&quot;dmu_phe.txt&quot;,                                      #è¡¨å‹æ•°æ®åç§°
            analysis_model=&quot;PBLUP_A&quot;,                                    #åˆ†ææ–¹æ³•
            relationship_path=&quot;D:/test_code/BLUP_ADC_code/DMU_example&quot;,  #äº²ç¼˜å…³ç³»æ–‡ä»¶è·¯å¾„
            relationship_name=&quot;Blupf90_ped.txt&quot;,                         #äº²ç¼˜å…³ç³»æ–‡ä»¶åç§°
            output_result_path=&quot;C:/Users/26564/Desktop/BLUPF90&quot;,         #BLUPF90ç»“æœä¿å­˜è·¯å¾„
            output_ebv_path=&quot;C:/Users/26564/Desktop/BLUPF90&quot;,            #EBVç»“æœä¿å­˜çš„è·¯å¾„
            output_ebv_name=&quot;test&quot;,                                      #EBVç»“æœä¿å­˜çš„æ–‡ä»¶å
            BLUPf90_software_path=&quot;D:/test_code/BLUPf90_software&quot;        #BLUPF90è½¯ä»¶çš„è·¯å¾„
            )</code></pre>
<p>é€šè¿‡ä¸Šé¢çš„è¿™ä¸ªå°è„šæœ¬ï¼Œæˆ‘ä»¬å³èƒ½å®Œæˆ<strong>BLUPF90</strong>çš„å•æ€§çŠ¶æ¨¡å‹çš„è®¡ç®—ã€‚ä¸ä¸Šä¸€èŠ‚çš„ä»‹ç»çš„<code>run_DMU</code>å‡½æ•°ç±»ä¼¼ï¼Œå¦‚æœæˆ‘ä»¬æƒ³å®ŒæˆåŒæ€§çŠ¶æ¨¡å‹çš„è®¡ç®—ï¼Œåªéœ€è¦åœ¨ä¸Šé¢çš„è„šæœ¬çš„åŸºç¡€ä¸Šç¨ä½œä¿®æ”¹å°±èƒ½å®ç°ç›®çš„ã€‚å…·ä½“ä»£ç å¦‚ä¸‹ï¼š</p>
<pre class="R"><code>library(blupADC)
run_BLUPF90(        
            phe_col_names=c(&quot;Id&quot;,&quot;Sex&quot;,&quot;Herd_Year_Season&quot;,&quot;Litter&quot;,&quot;Trait1&quot;,&quot;Trait2&quot;,&quot;Age&quot;),  #è¡¨å‹æ•°æ®çš„åˆ—å
            target_trait_name=c(&quot;Trait1&quot;,&quot;Trait2&quot;),                              #ç›®æ ‡æ€§çŠ¶åç§°
            fixed_effect_name=list(c(&quot;Sex&quot;,&quot;Herd_Year_Season&quot;),c(&quot;Sex&quot;)),        #å›ºå®šæ•ˆåº”åç§°
            random_effect_name=list(c(&quot;Id&quot;,&quot;Litter&quot;),c(&quot;Id&quot;)),                   #éšæœºæ•ˆåº”åç§°
            covariate_effect_name=list(c(&quot;Age&quot;),NULL),                       #åå˜é‡åç§°
            phe_path=&quot;D:/test_code/BLUP_ADC_code/DMU_example&quot;,           #è¡¨å‹æ•°æ®è·¯å¾„
            phe_name=&quot;dmu_phe.txt&quot;,                                      #è¡¨å‹æ•°æ®åç§°
            analysis_model=&quot;PBLUP_A&quot;,                                    #åˆ†ææ–¹æ³•
            relationship_path=&quot;D:/test_code/BLUP_ADC_code/DMU_example&quot;,  #äº²ç¼˜å…³ç³»æ–‡ä»¶è·¯å¾„
            relationship_name=&quot;Blupf90_ped.txt&quot;,                         #äº²ç¼˜å…³ç³»æ–‡ä»¶åç§°
            output_result_path=&quot;C:/Users/26564/Desktop/BLUPF90&quot;,         #BLUPF90ç»“æœä¿å­˜è·¯å¾„
            output_ebv_path=&quot;C:/Users/26564/Desktop/BLUPF90&quot;,            #EBVç»“æœä¿å­˜çš„è·¯å¾„
            output_ebv_name=&quot;test&quot;,                                      #EBVç»“æœä¿å­˜çš„æ–‡ä»¶å
            BLUPf90_software_path=&quot;D:/test_code/BLUPf90_software&quot;        #BLUPF90è½¯ä»¶çš„è·¯å¾„
            )</code></pre>
<div id="gblup" class="section level3">
<h3>GBLUP</h3>
<pre class="R"><code>library(blupADC)
data_path=system.file(&quot;extdata&quot;, package = &quot;blupADC&quot;)  #  path of provided files 
  
run_BLUPF90(
        phe_col_names=c(&quot;Id&quot;,&quot;Mean&quot;,&quot;Sex&quot;,&quot;Herd_Year_Season&quot;,&quot;Litter&quot;,&quot;Trait1&quot;,&quot;Trait2&quot;), # colnames of phenotype 
        target_trait_name=c(&quot;Trait1&quot;),                           #trait name 
        fixed_effect_name=list(c(&quot;Sex&quot;,&quot;Herd_Year_Season&quot;)),     #fixed effect name
        random_effect_name=list(c(&quot;Id&quot;,&quot;Litter&quot;)),               #random effect name
        covariate_effect_name=NULL,                              #covariate effect name
        phe_path=data_path,                          #path of phenotype file
        phe_name=&quot;phenotype.txt&quot;,                    #name of phenotype file
        analysis_model=&quot;GBLUP_A&quot;,                    #model of genetic evaluation
        relationship_path=data_path,                 #path of relationship file 
        relationship_name=c(&quot;blupf90_genumeric&quot;),            #name of relationship file 
        output_result_path=&quot;/root&quot;,                  # output path 
        BLUPF90_software_path=&quot;/root/software/BLUPF90&quot;  # path of BLUPF90 software 
        )   
</code></pre>
<p>æ¥</p>
<p>SSBLUP</p>
<pre class="R"><code>library(blupADC)
data_path=system.file(&quot;extdata&quot;, package = &quot;blupADC&quot;)  #  path of provided files 
  
run_BLUPF90(
        phe_col_names=c(&quot;Id&quot;,&quot;Mean&quot;,&quot;Sex&quot;,&quot;Herd_Year_Season&quot;,&quot;Litter&quot;,&quot;Trait1&quot;,&quot;Trait2&quot;), # colnames of phenotype 
        target_trait_name=c(&quot;Trait1&quot;),                           #trait name 
        fixed_effect_name=list(c(&quot;Sex&quot;,&quot;Herd_Year_Season&quot;)),     #fixed effect name
        random_effect_name=list(c(&quot;Id&quot;,&quot;Litter&quot;)),               #random effect name
        covariate_effect_name=NULL,                              #covariate effect name
        phe_path=data_path,                          #path of phenotype file
        phe_name=&quot;phenotype.txt&quot;,                    #name of phenotype file
        analysis_model=&quot;SSBLUP_A&quot;,                    #model of genetic evaluation
        relationship_path=data_path,                 #path of relationship file 
        relationship_name=c(&quot;pedigree.txt&quot;,&quot;blupf90_genumeric&quot;),            #name of relationship file 
        output_result_path=&quot;/root&quot;,                  # output path 
        BLUPF90_software_path=&quot;/root/software/BLUPF90&quot;  # path of BLUPF90 software 
        )   
</code></pre>
<p>æ¥</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å¯¹<code>run_BLUPF90</code> ä¸­ç‰¹æœ‰çš„å‚æ•°è¿›è¡Œè®²è§£ï¼Œå‰©ä½™çš„å‚æ•°å¤§å®¶å¯ç§»æ­¥ <a href="https://qsmei.netlify.app/post/2021-04-20-r-package-blup-adc-run-dmu/run_dmu/">R package:blupADC-ä½¿ç”¨è¯´æ˜6</a> è¿›è¡ŒæŸ¥çœ‹ï¼Œç›¸åŒå‚æ•°çš„ç”¨æ³•å’Œå«ä¹‰å‡æ˜¯ä¸€æ¨¡ä¸€æ ·çš„ã€‚</p>
</div>
<div id="ç‰¹æœ‰å‚æ•°" class="section level3">
<h3>ğŸ’«ç‰¹æœ‰å‚æ•°</h3>
<ul>
<li>å‚æ•°1ï¼š<code>blupf90_algorithm</code></li>
</ul>
<p>BLPUF90è¿›è¡Œæ–¹å·®ç»„åˆ†ä¼°è®¡æ—¶é€‰ç”¨çš„ç®—æ³•ï¼Œ<code>character</code>ç±»å‹ã€‚å¯é€‰ç®—æ³•åŒ…æ‹¬ï¼š</p>
<ol style="list-style-type: decimal">
<li><p>â€œAI_REMLâ€</p></li>
<li><p>â€œEM_REMLâ€</p></li>
</ol>
<p>é»˜è®¤ç®—æ³•ä¸ºï¼šâ€œAI_REMLâ€</p>
<ul>
<li>å‚æ•°2ï¼š<code>provided_blupf90_prior_file_path</code></li>
</ul>
<p>ç”¨æˆ·æä¾›çš„BLUPF90æ ¼å¼çš„æ–¹å·®ç»„åˆ†-PRIORæ–‡ä»¶çš„è·¯å¾„ï¼Œ<code>character</code>ç±»å‹ã€‚</p>
<p><strong>Note</strong>:éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œ<strong>BLUPF90</strong>æ ¼å¼çš„PRIORæ–‡ä»¶å’Œ<strong>DMU</strong>æ ¼å¼çš„PRIORæ–‡ä»¶æ˜¯ä¸ç›¸åŒçš„ã€‚å…³äºäºŒè€…çš„å·®å¼‚ï¼Œä»¥åæœ‰æ—¶é—´ä¼šå†å‡ºä¸€ç¯‡æ–‡ç« è¿›è¡Œè®²è§£ï¼Œè¿™é‡Œå°±ä¸å†èµ˜è¿°äº†ã€‚</p>
<ul>
<li>å‚æ•°3ï¼š<code>provided_blupf90_prior_file_name</code></li>
</ul>
<p>ç”¨æˆ·æä¾›çš„BLUPF90æ ¼å¼çš„æ–¹å·®ç»„åˆ†-PRIORæ–‡ä»¶çš„åç§°ï¼Œ<code>character</code>ç±»å‹ã€‚</p>
<ul>
<li>å‚æ•°4ï¼š<code>provided_blupf90_prior_effect_name</code></li>
</ul>
<p>ç”¨æˆ·æä¾›çš„PRIORæ–‡ä»¶ä¸­ï¼Œä¸æ–¹å·®ç»„åˆ†å¯¹åº”çš„å„ä¸ªéšæœºæ•ˆåº”åç§°ï¼Œ<code>character</code>ç±»å‹ã€‚</p>
<ul>
<li>å‚æ•°5ï¼š<code>BLUPf90_software_path</code></li>
</ul>
<p>BLUPF90è½¯ä»¶åœ¨æœ¬åœ°çš„è·¯å¾„ï¼Œ<code>character</code>ç±»å‹ã€‚</p>
</div>
