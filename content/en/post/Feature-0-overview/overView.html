---
title: 'R package:blupADC- Overview'
author: qsmei
date: '2021-04-13'
slug: overView
categories:
  - blupADC
tags: []
subtitle: ''
summary: 'ÂØπR package:blupADC ÁöÑÂäüËÉΩËøõË°åÁÆÄÂçïÁöÑ‰ªãÁªç'
authors: []
lastmod: '2021-04-13T22:32:36+08:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
toc: true
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>

<div id="TOC">

</div>

<p>{{<toc>}}</p>
<div id="overview" class="section level2">
<h2>OVERVIEW</h2>
<p><code>blupADC</code> is an useful tool for handling genomic data and pedigree data in animal and plant breeding, including data format conversion, pedigree rename, kinship matrix construction and so on. In addition, <code>blupADC</code> provided several functions to interface with famous breeding softwares, <strong>DMU</strong> and <strong>BLUPF90</strong>. With the help of <code>blupADC</code> ,all of these parameter files can be automatically generated, and users can easily use these softwares.</p>
</div>
<div id="getting-started" class="section level2">
<h2>GETTING STARTED</h2>
<div id="installation" class="section level3">
<h3>üôäInstallation</h3>
<p><code>blupADC</code> links to R packages <code>Rcpp</code>, <code>RcppArmadillo</code> and <code>data.table</code>. These dependencies should be installed before installing <code>blupADC</code>.</p>
<pre class="r"><code>install.packages(c(&quot;Rcpp&quot;, &quot;RcppArmadillo&quot;,&quot;data.table&quot;))</code></pre>
<div id="install-blupadc-on-linux-or-macos" class="section level4">
<h4>Install blupADC on Linux or macOS</h4>
<pre class="shell"><code># in command line
wget  https://github.com/TXiang-lab/blupADC/raw/main/blupADC_1.0.1_linux.tar.gz
R CMD INSTALL blupADC_1.0.1_linux.tar.gz</code></pre>
<p>or</p>
<pre class="r"><code># in R environment
packageurl &lt;- &quot;https://github.com/TXiang-lab/blupADC/raw/main/blupADC_1.0.1_linux.tar.gz&quot;
install.packages(packageurl,repos=NULL,method=&quot;libcurl&quot;)</code></pre>
<p>For Chinese users, we recommend to use the following code(<strong>network would be fine</strong>):</p>
<pre class="r"><code># in R environment
packageurl &lt;- &quot;https://gitee.com/qsmei/blup-adc/attach_files/744149/download/blupADC_1.0.1_linux.tar.gz&quot;
install.packages(packageurl,repos=NULL,method=&quot;libcurl&quot;)</code></pre>
</div>
<div id="install-blupadc-on-windows" class="section level4">
<h4>Install blupADC on Windows</h4>
<pre class="r"><code># in R environment
packageurl &lt;- &quot;https://github.com/TXiang-lab/blupADC/raw/main/blupADC_1.0.1.zip&quot;
install.packages(packageurl,repos=NULL)</code></pre>
<p>For Chinese users, we recommend to use the following code(<strong>network would be fine</strong>):</p>
<pre class="r"><code># in R environment
packageurl &lt;- &quot;https://gitee.com/qsmei/blup-adc/attach_files/743906/download/blupADC_1.0.1.zip&quot;
install.packages(packageurl,repos=NULL)</code></pre>
<p>After installed successfully, the <code>blupADC</code> package can be loaded by typing</p>
<pre class="r"><code>library(blupADC)</code></pre>
</div>
</div>
<div id="features" class="section level3">
<h3>üôäFeatures</h3>
<ul>
<li>Feature 1. Convert genotype data format</li>
<li>Feature 2. Detect duplicated genotype data</li>
<li>Feature 3. Trace, rename and correct pedigree</li>
<li>Feature 4. Quality control and imputation</li>
<li>Feature 5. Construct kinship matrix</li>
<li>Feature 6. Interaface with DMU</li>
<li>Feature 7. Interaface with BLUPF90</li>
</ul>
</div>
</div>
<div id="usage" class="section level2">
<h2>Usage</h2>
<p><code>blupADC</code> provides several datasets object, including <code>data_hmp</code>, <code>origin_pedigree</code>.</p>
<p>In addition, <code>blupADC</code> provides several files which are saved in <code>~/blupADC/extdata</code>. We can get the path of these files by typing</p>
<pre class="r"><code>system.file(&quot;extdata&quot;, package = &quot;blupADC&quot;) # path of provided files</code></pre>
<div id="feature-1.-convert-genotype-data-format-see-more-details" class="section level4">
<h4>Feature 1. Convert genotype data format (<a href="https://qsmei.netlify.app/post/blupadc/">see more details</a>)</h4>
<pre class="r"><code>library(blupADC)
sum_data=genotype_data_format_conversion(
         input_data_hmp=data_hmp,  #provided hapmap data object 
         output_data_type=c(&quot;Plink&quot;,&quot;Blupf90&quot;,&quot;Numeric&quot;),# output data format
         return_result = TRUE,      # return result 
         cpu_cores=1                # number of cpu 
                  )</code></pre>
</div>
<div id="feature-2.-detect-duplicated-genotype-data-see-more-details" class="section level4">
<h4>Feature 2. Detect duplicated genotype data (<a href="https://qsmei.netlify.app/post/2021-04-17-r-package-blup-adc-overlap-genotype/overlap_genotype/">see more details</a>)</h4>
<pre class="r"><code>library(blupADC)
overlap_result=genotype_data_overlap(
                  input_data_hmp=data_hmp,   #provided hapmap data object
                  overlap_threshold=0.95,    # threshold of duplicate 
                  return_result=TRUE         #return result 
                  )</code></pre>
</div>
<div id="feature-3.-trace-rename-and-correct-pedigree-see-more-details" class="section level4">
<h4>Feature 3. Trace, rename and correct pedigree (<a href="https://qsmei.netlify.app/post/2021-04-17-r-package-blup-adc-pedigree/pedigree/">see more details</a>)</h4>
<pre class="r"><code>library(blupADC)
pedigree_result=trace_pedigree(
                input_pedigree=origin_pedigree,   #provided pedigree data object
                trace_generation=3,       # trace generation
                output_pedigree_tree=TRUE  # output pedigree tree
                )                 </code></pre>
</div>
<div id="feature-4.-quality-control-and-imputation-see-more-details" class="section level4">
<h4>Feature 4. Quality control and imputation (<a href="https://qsmei.netlify.app/post/2021-04-17-r-package-blup-adc-qc-imputaion/qc_imputation/">see more details</a>)</h4>
<pre class="r"><code>library(blupADC)
genotype_data_QC_Imputation(
            input_data_hmp=data_hmp,    #provided hapmap data object
            data_analysis_method=&quot;QC_Imputation&quot;,   #analysis method type,QC + imputatoin
            plink_software_path=&quot;/root/software/plink&quot;,   # software path of plink 
            plink_software_name=&quot;plink&quot;,            # software name of plink 
            beagle_software_path=&quot;/root/software/beagle&quot;,   # software path of beagle 
            beagle_software_name=&quot;beagle.5.1.jar&quot;,  # software name of beagle 
            output_data_path=&quot;/root/result&quot;,        #output data path
            output_data_name=&quot;YY_data&quot;,             #output data name
            output_data_type=&quot;Plink&quot;                #output data format 
            )                       </code></pre>
</div>
<div id="feature-5.-construct-kinship-matrix-see-more-details" class="section level4">
<h4>Feature 5. Construct kinship matrix (<a href="https://qsmei.netlify.app/post/2021-04-17-r-package-blup-adc-calculate-relationship-matrix/relationship_matrix/">see more details</a>)</h4>
<pre class="r"><code>library(blupADC)
kinship_result=cal_kinship(
                input_data_hmp=data_hmp,          #provided hapmap data object
                kinship_type=c(&quot;G_A&quot;,&quot;G_D&quot;),      #type of  kinship matrix
                dominance_type=c(&quot;genotypic&quot;),    #type of dominance effect
                inbred_type=c(&quot;Homozygous&quot;),      #type of inbreeding coefficients
                return_result=TRUE)               #return result              </code></pre>
</div>
<div id="feature-6.-interface-with-dmu-see-more-details" class="section level4">
<h4>Feature 6. Interface with DMU (<a href="https://qsmei.netlify.app/post/2021-04-20-r-package-blup-adc-run-dmu/run_dmu/">see more details</a>)</h4>
<pre class="r"><code>library(blupADC)
data_path=system.file(&quot;extdata&quot;, package = &quot;blupADC&quot;)  #  path of provided files 
  
run_DMU(
        phe_col_names=c(&quot;Id&quot;,&quot;Mean&quot;,&quot;Sex&quot;,&quot;Herd_Year_Season&quot;,&quot;Litter&quot;,&quot;Trait1&quot;,&quot;Trait2&quot;), # colnames of phenotype 
        target_trait_name=c(&quot;Trait1&quot;),                           #trait name 
        fixed_effect_name=list(c(&quot;Sex&quot;,&quot;Herd_Year_Season&quot;)),     #fixed effect name
        random_effect_name=list(c(&quot;Id&quot;,&quot;Litter&quot;)),               #random effect name
        covariate_effect_name=NULL,                              #covariate effect name
        phe_path=data_path,                          #path of phenotype file
        phe_name=&quot;phenotype.txt&quot;,                    #name of phenotype file
        integer_n=5,                                 #number of integer variable 
        analysis_model=&quot;PBLUP_A&quot;,                    #model of genetic evaluation
        dmu_module=&quot;dmuai&quot;,                          #modeule of estimating variance components 
        relationship_path=data_path,                 #path of relationship file 
        relationship_name=&quot;pedigree.txt&quot;,            #name of relationship file 
        output_result_path=&quot;/root&quot;,                  # output path 
        DMU_software_path=&quot;/root/software/DMU/bin&quot;  # path of DMU software 
        )</code></pre>
</div>
<div id="feature-7.-interface-with-blupf90-see-more-details" class="section level4">
<h4>Feature 7. Interface with BLUPF90 (<a href="https://qsmei.netlify.app/post/2021-04-20-r-package-blup-adc-run-blupf90/blupf90/">see more details</a>)</h4>
<pre class="r"><code>library(blupADC)
data_path=system.file(&quot;extdata&quot;, package = &quot;blupADC&quot;)  #  path of provided files 
  
run_BLUPF90(
        phe_col_names=c(&quot;Id&quot;,&quot;Mean&quot;,&quot;Sex&quot;,&quot;Herd_Year_Season&quot;,&quot;Litter&quot;,&quot;Trait1&quot;,&quot;Trait2&quot;), # colnames of phenotype 
        target_trait_name=c(&quot;Trait1&quot;),                           #trait name 
        fixed_effect_name=list(c(&quot;Sex&quot;,&quot;Herd_Year_Season&quot;)),     #fixed effect name
        random_effect_name=list(c(&quot;Id&quot;,&quot;Litter&quot;)),               #random effect name
        covariate_effect_name=NULL,                              #covariate effect name
        phe_path=data_path,                          #path of phenotype file
        phe_name=&quot;phenotype.txt&quot;,                    #name of phenotype file
        analysis_model=&quot;PBLUP_A&quot;,                    #model of genetic evaluation
        relationship_path=data_path,                 #path of relationship file 
        relationship_name=&quot;pedigree.txt&quot;,            #name of relationship file 
        output_result_path=&quot;/root&quot;,                  # output path 
        BLUPF90_software_path=&quot;/root/software/BLUPF90&quot;  # path of BLUPF90 software 
        )   </code></pre>
<p>1</p>
</div>
</div>
