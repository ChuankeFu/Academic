---
title: 'R package:blupADC- åŠŸèƒ½1'
author: qsmei
date: '2021-04-14'
slug: blupADC
categories: ["æ ¼å¼è½¬æ¢"]
tags: []
subtitle: ''
summary: 'åŸºå› å‹æ•°æ®æ ¼å¼è½¬æ¢'
authors: []
lastmod: '2021-04-14T14:59:41+08:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
output:
  blogdown::html_page:
    toc: true
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>

<div id="TOC">
<ul>
<li><a href="#ç®€ä»‹">ç®€ä»‹</a></li>
<li><a href="#ç¤ºä¾‹">ç¤ºä¾‹</a>
<ul>
<li><a href="#åŸºç¡€å‚æ•°">ğŸ¤¡åŸºç¡€å‚æ•°</a></li>
<li><a href="#è¿›é˜¶å‚æ•°">ğŸ’¨è¿›é˜¶å‚æ•°</a></li>
</ul></li>
</ul>
</div>

<div id="ç®€ä»‹" class="section level2">
<h2>ç®€ä»‹</h2>
<p>ğŸ™€å¤§å®¶å¥½,é€šè¿‡å‰ä¸€ç« èŠ‚çš„å­¦ä¹ ï¼Œç›¸ä¿¡å¤§å®¶å·²ç»å¯¹<code>blupADC</code> æœ‰äº†ä¸€ä¸ªåˆæ­¥çš„äº†è§£äº†ã€‚ä»æœ¬èŠ‚å¼€å§‹ï¼Œæˆ‘ä»¬å°†å¯¹<code>blupADC</code>ä¸­çš„å‡ ä¸ªé‡è¦çš„å‡½æ•°ä¸€ä¸€è¿›è¡Œè®²è§£ã€‚è¿™ä¸€èŠ‚ä¸»è¦ç»™å¤§å®¶è®²è¿°çš„æ˜¯å¦‚ä½•ä½¿ç”¨<code>blupADC</code>ä¸­<code>genotype_data_format_conversion</code>å‡½æ•°æ¥è¿›è¡Œå¤šç§åŸºå› å‹æ ¼å¼æ•°æ®çš„è½¬æ¢ã€‚</p>
</div>
<div id="ç¤ºä¾‹" class="section level2">
<h2>ç¤ºä¾‹</h2>
<p>é¦–å…ˆ,æˆ‘ä»¬ä»¥ä¸€ä¸ªç®€å•çš„å°ä¾‹å­æ¥çœ‹çœ‹å‡½æ•°çš„ç”¨æ³•</p>
<pre class="r"><code>library(blupADC)
sum_data=genotype_data_format_conversion(
         input_data_hmp=data_hmp,  #provided hapmap data object 
         output_data_type=c(&quot;Plink&quot;,&quot;Blupf90&quot;,&quot;Numeric&quot;),# output data format
         return_result = TRUE,      # return result 
         cpu_cores=1                # number of cpu 
         )</code></pre>
<pre><code>## Start numeric(0,1,2) format conversion...... 
## Complete Blupf90  format conversion 
## Complete Plink Data Format Conversion</code></pre>
<p>ä¸‹é¢ï¼Œæˆ‘ä»¬å°†å¯¹<code>genotype_data_format_conversion</code> ä¸­çš„å‚æ•°ä¸€ä¸€è¿›è¡Œè®²è§£</p>
<div id="åŸºç¡€å‚æ•°" class="section level3">
<h3>ğŸ¤¡åŸºç¡€å‚æ•°</h3>
<ul>
<li><strong>å‚æ•°1:input_data_plink_ped</strong></li>
</ul>
<p>ç”¨æˆ·æä¾›çš„ Plink-pedæ ¼å¼çš„æ•°æ®ï¼Œ<code>data.frame</code>ç±»å‹ã€‚å…·ä½“æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<table>
<tbody>
<tr class="odd">
<td align="left">3098</td>
<td align="left">3098</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">C</td>
<td align="left">C</td>
<td align="left">G</td>
<td align="left">G</td>
</tr>
<tr class="even">
<td align="left">3498</td>
<td align="left">3498</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">A</td>
<td align="left">C</td>
<td align="left">T</td>
<td align="left">G</td>
</tr>
<tr class="odd">
<td align="left">3297</td>
<td align="left">3297</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">A</td>
<td align="left">C</td>
<td align="left">T</td>
<td align="left">G</td>
</tr>
<tr class="even">
<td align="left">2452</td>
<td align="left">2452</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">C</td>
<td align="left">C</td>
<td align="left">G</td>
<td align="left">G</td>
</tr>
<tr class="odd">
<td align="left">4255</td>
<td align="left">4255</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">A</td>
<td align="left">C</td>
<td align="left">G</td>
<td align="left">G</td>
</tr>
<tr class="even">
<td align="left">2946</td>
<td align="left">2946</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">C</td>
<td align="left">C</td>
<td align="left">T</td>
<td align="left">G</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>å‚æ•°2:input_data_plink_map</strong></li>
</ul>
<p>ç”¨æˆ·æä¾›çš„ Plink-mapæ ¼å¼çš„æ•°æ®ï¼Œ<code>data.frame</code>ç±»å‹ã€‚å…·ä½“æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<table>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">SNP1</td>
<td align="right">0.224488</td>
<td align="right">224488</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">SNP2</td>
<td align="right">0.293696</td>
<td align="right">293696</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">SNP3</td>
<td align="right">0.333333</td>
<td align="right">333333</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">SNP4</td>
<td align="right">0.464830</td>
<td align="right">464830</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">SNP5</td>
<td align="right">0.722623</td>
<td align="right">722623</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">SNP6</td>
<td align="right">0.838596</td>
<td align="right">838596</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>å‚æ•°3:input_data_hmp</strong></li>
</ul>
<p>ç”¨æˆ·æä¾›çš„ Hapmapæ ¼å¼çš„æ•°æ®ï¼Œ<code>data.frame</code>ç±»å‹ã€‚å…·ä½“æ ¼å¼å¦‚ä¸‹æ‰€ç¤º</p>
<table style="width:100%;">
<colgroup>
<col width="4%" />
<col width="7%" />
<col width="5%" />
<col width="6%" />
<col width="6%" />
<col width="8%" />
<col width="6%" />
<col width="8%" />
<col width="9%" />
<col width="9%" />
<col width="6%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">rs#</th>
<th align="left">alleles</th>
<th align="right">chrom</th>
<th align="right">pos</th>
<th align="left">strand</th>
<th align="left">assembly</th>
<th align="left">center</th>
<th align="left">protLSID</th>
<th align="left">assayLSID</th>
<th align="left">panelLSID</th>
<th align="left">QCcode</th>
<th align="left">3098</th>
<th align="left">3498</th>
<th align="left">3297</th>
<th align="left">2452</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SNP1</td>
<td align="left">NA</td>
<td align="right">1</td>
<td align="right">224488</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">CC</td>
<td align="left">AC</td>
<td align="left">AC</td>
<td align="left">CC</td>
</tr>
<tr class="even">
<td align="left">SNP2</td>
<td align="left">NA</td>
<td align="right">1</td>
<td align="right">293696</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">GG</td>
<td align="left">TG</td>
<td align="left">TG</td>
<td align="left">GG</td>
</tr>
<tr class="odd">
<td align="left">SNP3</td>
<td align="left">NA</td>
<td align="right">1</td>
<td align="right">333333</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">GG</td>
<td align="left">TT</td>
<td align="left">TT</td>
<td align="left">GG</td>
</tr>
<tr class="even">
<td align="left">SNP4</td>
<td align="left">NA</td>
<td align="right">1</td>
<td align="right">464830</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">CC</td>
<td align="left">CC</td>
<td align="left">CC</td>
<td align="left">CC</td>
</tr>
<tr class="odd">
<td align="left">SNP5</td>
<td align="left">NA</td>
<td align="right">1</td>
<td align="right">722623</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">AA</td>
<td align="left">GG</td>
<td align="left">GG</td>
<td align="left">AA</td>
</tr>
<tr class="even">
<td align="left">SNP6</td>
<td align="left">NA</td>
<td align="right">1</td>
<td align="right">838596</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">CC</td>
<td align="left">TC</td>
<td align="left">TT</td>
<td align="left">CC</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>å‚æ•°4:input_data_blupf90</strong></li>
</ul>
<p>ç”¨æˆ·æä¾›çš„ BLUPF90æ ¼å¼æ•°æ®ï¼Œ<code>data.frame</code>ç±»å‹ã€‚å…·ä½“æ ¼å¼å¦‚ä¸‹æ‰€ç¤º</p>
<table>
<tbody>
<tr class="odd">
<td align="left">3098</td>
<td align="left">200000</td>
</tr>
<tr class="even">
<td align="left">3498</td>
<td align="left">112021</td>
</tr>
<tr class="odd">
<td align="left">3297</td>
<td align="left">112022</td>
</tr>
<tr class="even">
<td align="left">2452</td>
<td align="left">200000</td>
</tr>
<tr class="odd">
<td align="left">4255</td>
<td align="left">102011</td>
</tr>
<tr class="even">
<td align="left">2946</td>
<td align="left">212000</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>å‚æ•°5:input_data_genumeric</strong></li>
</ul>
<p>ç”¨æˆ·æä¾›çš„ Numericæ ¼å¼çš„æ•°æ®ï¼Œ<code>matrix(çº¯æ•°å­—)</code>ç±»å‹ã€‚å…·ä½“æ ¼å¼å¦‚ä¸‹æ‰€ç¤º</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">SNP1</th>
<th align="right">SNP2</th>
<th align="right">SNP3</th>
<th align="right">SNP4</th>
<th align="right">SNP5</th>
<th align="right">SNP6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">3098</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">3498</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">3297</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">2452</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">4255</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">2946</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> è¡Œä¸ºä¸ªä½“ï¼Œåˆ—ä¸ºSNPï¼Œå¿…é¡»åŒ…æ‹¬åˆ—åå’Œè¡Œåã€‚</p>
<p>æ­¤å¤–ï¼Œä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨ï¼Œç”¨æˆ·è¿˜å¯ä»¥ç›´æ¥é€šè¿‡æä¾›æœ¬åœ°æ•°æ®çš„è·¯å¾„ã€åç§°ä¸æ•°æ®ç±»å‹å³å¯å®Œæˆæ•°æ®æä¾›è¿™ä¸€æ­¥éª¤,è€Œæ— éœ€å°†æ•°æ®è¯»å…¥åˆ°<strong>R</strong>é‡Œé¢ã€‚</p>
<ul>
<li><strong>å‚æ•°6:input_data_path</strong></li>
</ul>
<p>ç”¨æˆ·æä¾›çš„æœ¬åœ°æ•°æ®çš„æ–‡ä»¶è·¯å¾„ï¼Œ<code>character</code>ç±»å‹ã€‚</p>
<ul>
<li><strong>å‚æ•°7:input_data_name</strong></li>
</ul>
<p>ç”¨æˆ·æä¾›çš„æœ¬åœ°æ•°æ®çš„æ–‡ä»¶åç§°ï¼Œ<code>character</code>ç±»å‹ã€‚</p>
<p><strong>Note:</strong> å¦‚æœæä¾›çš„æ•°æ®ç±»å‹ä¸ºPlink ,é‚£ä¹ˆæœ¬åœ°æ–‡ä»¶åç§°ä¸éœ€è¦å¸¦åç¼€ï¼Œeg. æœ¬åœ°æ–‡ä»¶åä¸ºtest1.map test1.pedï¼Œæˆ‘ä»¬æä¾›æ–‡ä»¶åç§°ä¸ºï¼š <code>input_data_name="test1"</code>ã€‚é™¤äº†Plinkæ ¼å¼çš„æ•°æ®å¤–ï¼Œå…¶ä»–æ•°æ®æ ¼å¼å¿…é¡»æä¾›å®Œæ•´çš„åç§°(å¸¦åç¼€)ã€‚</p>
<ul>
<li><p><strong>å‚æ•°8:input_data_type</strong></p>
<p>ç”¨æˆ·æä¾›çš„æœ¬åœ°æ•°æ®çš„æ ¼å¼ï¼Œ<code>character</code>ç±»å‹ã€‚æ•°æ®æ ¼å¼åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>Hapmap</code></li>
<li><code>Plink</code></li>
<li><code>Blupf90</code></li>
<li><code>Numeric</code></li>
<li><code>VCF</code></li>
</ul></li>
<li><p><strong>å‚æ•°9:return_result</strong></p></li>
</ul>
<p>æ˜¯å¦åœ¨Rä¸­è¿”å›è¾“å‡ºçš„ç»“æœï¼Œ<code>logical</code>ç±»å‹ã€‚é»˜è®¤ä¸ºFLASEã€‚</p>
<p>æ­¤å¤–ï¼Œä¸ºäº†ä¾¿äºè¾“å‡ºæ•°æ®çš„ä¿å­˜ï¼Œç”¨æˆ·å¯ä»¥å°†æ•°æ®ä¿å­˜åˆ°æœ¬åœ°</p>
<ul>
<li><strong>å‚æ•°10:output_data_path</strong></li>
</ul>
<p>è¾“å‡ºçš„åŸºå› å‹æ•°æ®ä¿å­˜åˆ°æœ¬åœ°çš„è·¯å¾„ï¼Œ<code>character</code>ç±»å‹ã€‚</p>
<ul>
<li><strong>å‚æ•°11:output_data_name</strong></li>
</ul>
<p>è¾“å‡ºçš„åŸºå› å‹æ•°æ®ä¿å­˜åˆ°æœ¬åœ°çš„æ–‡ä»¶åç§°ï¼Œ<code>character</code>ç±»å‹ã€‚</p>
<ul>
<li><p><strong>å‚æ•°12:output_data_type</strong></p>
<p>ç”¨æˆ·æä¾›çš„æœ¬åœ°æ•°æ®çš„æ ¼å¼ï¼Œ<code>character</code>ç±»å‹ã€‚æ•°æ®æ ¼å¼åŒ…æ‹¬ï¼š</p>
<ul>
<li><code>Hapmap</code></li>
<li><code>Plink</code></li>
<li><code>Blupf90</code></li>
<li><code>Numeric</code></li>
<li><code>VCF</code></li>
</ul></li>
</ul>
<p>å¯é€‰æ‹©åŒæ—¶è¾“å‡ºå¤šç§æ•°æ®æ ¼å¼ã€‚e.g.<code>output_data_type=c("Hapmap","Plink","Blupf90","Numeric")</code> å¯åŒæ—¶è¾“å‡ºä»¥ä¸Š4ç§æ•°æ®ç±»å‹ã€‚</p>
</div>
<div id="è¿›é˜¶å‚æ•°" class="section level3">
<h3>ğŸ’¨è¿›é˜¶å‚æ•°</h3>
<ul>
<li><strong>å‚æ•°13:cpu_cores</strong></li>
</ul>
<p>å‡½æ•°è°ƒç”¨çš„cpuä¸ªæ•°ï¼Œ<code>numeric</code>ç±»å‹ã€‚é»˜è®¤è°ƒç”¨1ä¸ª</p>
<ul>
<li><strong>å‚æ•°14:miss_base</strong></li>
</ul>
<p>ç¼ºå¤±å€¼åœ¨åŸåŸºå› å‹æ•°æ®ä¸­æ‰€è¡¨ç¤ºçš„çš„å­—ç¬¦ï¼Œ<code>character</code>ç±»å‹ã€‚é»˜è®¤ä¸ºâ€œNNâ€ã€‚</p>
<ul>
<li><strong>å‚æ•°15:miss_base_num</strong></li>
</ul>
<p>æ•°å­—åŒ–æ ¼å¼è½¬æ¢ä¸­ç¼ºå¤±å€¼è½¬æ¢æˆçš„æ•°å­—ï¼Œ<code>numeric</code>ç±»å‹ã€‚é»˜è®¤ä¸º 5ã€‚</p>
<ul>
<li><strong>å‚æ•°16:plink_software_path</strong></li>
</ul>
<p><strong>Plink</strong>è½¯ä»¶çš„è·¯å¾„ï¼Œ<code>character</code>ç±»å‹ã€‚æ¶‰åŠåˆ°VCFæ ¼å¼è½¬æ¢æ—¶ï¼Œéœ€è¦ä½¿ç”¨ <strong>Plink</strong>è½¯ä»¶ã€‚å½“<strong>Plink</strong>è½¯ä»¶çš„è·¯å¾„å·²åŠ å…¥åˆ°ç¯å¢ƒå˜é‡åï¼Œæ­¤é¡¹å‚æ•°ä¸éœ€è¦å†è®¾ç½®ã€‚</p>
<ul>
<li><strong>å‚æ•°17:plink_software_name</strong></li>
</ul>
<p><strong>Plink</strong>è½¯ä»¶çš„åç§°ï¼Œ<code>character</code>ç±»å‹ã€‚æ¶‰åŠåˆ°VCFæ ¼å¼è½¬æ¢æ—¶ï¼Œéœ€è¦ä½¿ç”¨ <strong>Plink</strong>è½¯ä»¶ã€‚è½¯ä»¶é»˜è®¤åç§°ä¸ºï¼šplinkã€‚</p>
<ul>
<li><strong>å‚æ•°18:vcftools_software_path</strong></li>
</ul>
<p><strong>vcftools</strong>è½¯ä»¶çš„è·¯å¾„ï¼Œ<code>character</code>ç±»å‹ã€‚æ¶‰åŠåˆ°VCFæ ¼å¼è½¬æ¢æ—¶ï¼Œéœ€è¦ä½¿ç”¨<strong>vcftools</strong>è½¯ä»¶ã€‚å½“<strong>vcftools</strong>è½¯ä»¶çš„è·¯å¾„å·²åŠ å…¥åˆ°ç¯å¢ƒå˜é‡åï¼Œæ­¤é¡¹å‚æ•°ä¸éœ€è¦å†è®¾ç½®ã€‚</p>
<ul>
<li><strong>å‚æ•°19:vcftools_software_name</strong></li>
</ul>
<p><strong>vcftools</strong>è½¯ä»¶çš„åç§°ï¼Œ<code>character</code>ç±»å‹ã€‚æ¶‰åŠåˆ°VCFæ ¼å¼è½¬æ¢æ—¶ï¼Œéœ€è¦ä½¿ç”¨ <strong>vcftools</strong>è½¯ä»¶ã€‚è½¯ä»¶é»˜è®¤åç§°ä¸ºï¼švcftoolsã€‚</p>
</div>
</div>
