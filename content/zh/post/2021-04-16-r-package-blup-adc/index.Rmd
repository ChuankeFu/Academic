---
title: 'R package:blupADC- åŠŸèƒ½1'
author: qsmei
date: '2021-04-14'
slug: blupADC
categories: ["æ ¼å¼è½¬æ¢"]
tags: []
subtitle: ''
summary: 'åŸºå› å‹æ•°æ®æ ¼å¼è½¬æ¢'
authors: []
lastmod: '2021-04-14T14:59:41+08:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
output:
  blogdown::html_page:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE)
```

## ç®€ä»‹

ğŸ™€å¤§å®¶å¥½,é€šè¿‡å‰ä¸€ç« èŠ‚çš„å­¦ä¹ ï¼Œç›¸ä¿¡å¤§å®¶å·²ç»å¯¹`blupADC` æœ‰äº†ä¸€ä¸ªåˆæ­¥çš„äº†è§£äº†ã€‚ä»æœ¬èŠ‚å¼€å§‹ï¼Œæˆ‘ä»¬å°†å¯¹`blupADC`ä¸­çš„å‡ ä¸ªé‡è¦çš„å‡½æ•°ä¸€ä¸€è¿›è¡Œè®²è§£ã€‚è¿™ä¸€èŠ‚ä¸»è¦ç»™å¤§å®¶è®²è¿°çš„æ˜¯å¦‚ä½•ä½¿ç”¨`blupADC`ä¸­`genotype_data_format_conversion`å‡½æ•°æ¥è¿›è¡Œå¤šç§åŸºå› å‹æ ¼å¼æ•°æ®çš„è½¬æ¢ã€‚

## ç¤ºä¾‹

é¦–å…ˆ,æˆ‘ä»¬ä»¥ä¸€ä¸ªç®€å•çš„å°ä¾‹å­æ¥çœ‹çœ‹å‡½æ•°çš„ç”¨æ³•

```R
library(blupADC)
sum_data=genotype_data_format_conversion(
         input_data_hmp=data_hmp,  #provided hapmap data object 
         output_data_type=c("Plink","Blupf90","Numeric"),# output data format
         return_result = TRUE,      # return result 
         cpu_cores=1                # number of cpu 
         )
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(blupADC)
colnames(data_hmp)[1]="rs#"
data_hmp[1:6,1]=paste0("SNP",1:6)
sum_data=genotype_data_format_conversion(
         input_data_hmp=data_hmp[1:6,],  #provided hapmap data object 
         output_data_type=c("Plink","Blupf90","Numeric"),# output data format
         return_result = TRUE,      # return result 
         cpu_cores=1                # number of cpu 
                  )
```

ä¸‹é¢ï¼Œæˆ‘ä»¬å°†å¯¹`genotype_data_format_conversion` ä¸­çš„å‚æ•°ä¸€ä¸€è¿›è¡Œè®²è§£

### ğŸ¤¡åŸºç¡€å‚æ•°

-   **å‚æ•°1:input_data_plink_ped**

ç”¨æˆ·æä¾›çš„ Plink-pedæ ¼å¼çš„æ•°æ®ï¼Œ`data.frame`ç±»å‹ã€‚å…·ä½“æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š

```{r input_data_plink_map2,echo=FALSE}
data_ped=sum_data$ped
data_map=sum_data$map
colnames(data_map)=NULL
data_genumeric=sum_data$genumeric
data_blupf90=sum_data$blupf90
colnames(data_blupf90)=NULL
knitr::kable(head(data_ped[,1:10]))
```

-   **å‚æ•°2:input_data_plink_map**

ç”¨æˆ·æä¾›çš„ Plink-mapæ ¼å¼çš„æ•°æ®ï¼Œ`data.frame`ç±»å‹ã€‚å…·ä½“æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š

```{r input_data_plink_map,echo=FALSE}
knitr::kable(head(data_map))
```

-   **å‚æ•°3:input_data_hmp**

ç”¨æˆ·æä¾›çš„ Hapmapæ ¼å¼çš„æ•°æ®ï¼Œ`data.frame`ç±»å‹ã€‚å…·ä½“æ ¼å¼å¦‚ä¸‹æ‰€ç¤º

```{r input_data_hmp,echo=FALSE}
knitr::kable(head(data_hmp[,1:15]))
```

-   **å‚æ•°4:input_data_blupf90**

ç”¨æˆ·æä¾›çš„ BLUPF90æ ¼å¼æ•°æ®ï¼Œ`data.frame`ç±»å‹ã€‚å…·ä½“æ ¼å¼å¦‚ä¸‹æ‰€ç¤º

```{r input_data_blupf90,echo=FALSE}
knitr::kable(head(data_blupf90))
```

-   **å‚æ•°5:input_data_genumeric**

ç”¨æˆ·æä¾›çš„ Numericæ ¼å¼çš„æ•°æ®ï¼Œ`matrix(çº¯æ•°å­—)`ç±»å‹ã€‚å…·ä½“æ ¼å¼å¦‚ä¸‹æ‰€ç¤º

```{r input_data_genumeric,echo=FALSE}
knitr::kable(head(data_genumeric[,1:6]))
```

**Note:** è¡Œä¸ºä¸ªä½“ï¼Œåˆ—ä¸ºSNPï¼Œå¿…é¡»åŒ…æ‹¬åˆ—åå’Œè¡Œåã€‚

æ­¤å¤–ï¼Œä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨ï¼Œç”¨æˆ·è¿˜å¯ä»¥ç›´æ¥é€šè¿‡æä¾›æœ¬åœ°æ•°æ®çš„è·¯å¾„ã€åç§°ä¸æ•°æ®ç±»å‹å³å¯å®Œæˆæ•°æ®æä¾›è¿™ä¸€æ­¥éª¤,è€Œæ— éœ€å°†æ•°æ®è¯»å…¥åˆ°**R**é‡Œé¢ã€‚

-   **å‚æ•°6:input_data_path**

ç”¨æˆ·æä¾›çš„æœ¬åœ°æ•°æ®çš„æ–‡ä»¶è·¯å¾„ï¼Œ`character`ç±»å‹ã€‚

-   **å‚æ•°7:input_data_name**

ç”¨æˆ·æä¾›çš„æœ¬åœ°æ•°æ®çš„æ–‡ä»¶åç§°ï¼Œ`character`ç±»å‹ã€‚

**Note:** å¦‚æœæä¾›çš„æ•°æ®ç±»å‹ä¸ºPlink ,é‚£ä¹ˆæœ¬åœ°æ–‡ä»¶åç§°ä¸éœ€è¦å¸¦åç¼€ï¼Œeg. æœ¬åœ°æ–‡ä»¶åä¸ºtest1.map test1.pedï¼Œæˆ‘ä»¬æä¾›æ–‡ä»¶åç§°ä¸ºï¼š `input_data_name="test1"`ã€‚é™¤äº†Plinkæ ¼å¼çš„æ•°æ®å¤–ï¼Œå…¶ä»–æ•°æ®æ ¼å¼å¿…é¡»æä¾›å®Œæ•´çš„åç§°(å¸¦åç¼€)ã€‚

-   **å‚æ•°8:input_data_type**

    ç”¨æˆ·æä¾›çš„æœ¬åœ°æ•°æ®çš„æ ¼å¼ï¼Œ`character`ç±»å‹ã€‚æ•°æ®æ ¼å¼åŒ…æ‹¬ï¼š

    -   `Hapmap`
    -   `Plink`
    -   `Blupf90`
    -   `Numeric`
    -   `VCF`

-   **å‚æ•°9:return_result**

æ˜¯å¦åœ¨Rä¸­è¿”å›è¾“å‡ºçš„ç»“æœï¼Œ`logical`ç±»å‹ã€‚é»˜è®¤ä¸ºFLASEã€‚

æ­¤å¤–ï¼Œä¸ºäº†ä¾¿äºè¾“å‡ºæ•°æ®çš„ä¿å­˜ï¼Œç”¨æˆ·å¯ä»¥å°†æ•°æ®ä¿å­˜åˆ°æœ¬åœ°

-   **å‚æ•°10:output_data_path**

è¾“å‡ºçš„åŸºå› å‹æ•°æ®ä¿å­˜åˆ°æœ¬åœ°çš„è·¯å¾„ï¼Œ`character`ç±»å‹ã€‚

-   **å‚æ•°11:output_data_name**

è¾“å‡ºçš„åŸºå› å‹æ•°æ®ä¿å­˜åˆ°æœ¬åœ°çš„æ–‡ä»¶åç§°ï¼Œ`character`ç±»å‹ã€‚

-   **å‚æ•°12:output_data_type**

    ç”¨æˆ·æä¾›çš„æœ¬åœ°æ•°æ®çš„æ ¼å¼ï¼Œ`character`ç±»å‹ã€‚æ•°æ®æ ¼å¼åŒ…æ‹¬ï¼š

    -   `Hapmap`
    -   `Plink`
    -   `Blupf90`
    -   `Numeric`
    -   `VCF`

å¯é€‰æ‹©åŒæ—¶è¾“å‡ºå¤šç§æ•°æ®æ ¼å¼ã€‚e.g.`output_data_type=c("Hapmap","Plink","Blupf90","Numeric")` å¯åŒæ—¶è¾“å‡ºä»¥ä¸Š4ç§æ•°æ®ç±»å‹ã€‚

### ğŸ’¨è¿›é˜¶å‚æ•°

-   **å‚æ•°13:cpu_cores**

å‡½æ•°è°ƒç”¨çš„cpuä¸ªæ•°ï¼Œ`numeric`ç±»å‹ã€‚é»˜è®¤è°ƒç”¨1ä¸ª

-   **å‚æ•°14:miss_base**

ç¼ºå¤±å€¼åœ¨åŸåŸºå› å‹æ•°æ®ä¸­æ‰€è¡¨ç¤ºçš„çš„å­—ç¬¦ï¼Œ`character`ç±»å‹ã€‚é»˜è®¤ä¸º"NN"ã€‚

-   **å‚æ•°15:miss_base_num**

æ•°å­—åŒ–æ ¼å¼è½¬æ¢ä¸­ç¼ºå¤±å€¼è½¬æ¢æˆçš„æ•°å­—ï¼Œ`numeric`ç±»å‹ã€‚é»˜è®¤ä¸º 5ã€‚

-   **å‚æ•°16:plink_software_path**

**Plink**è½¯ä»¶çš„è·¯å¾„ï¼Œ`character`ç±»å‹ã€‚æ¶‰åŠåˆ°VCFæ ¼å¼è½¬æ¢æ—¶ï¼Œéœ€è¦ä½¿ç”¨ **Plink**è½¯ä»¶ã€‚å½“**Plink**è½¯ä»¶çš„è·¯å¾„å·²åŠ å…¥åˆ°ç¯å¢ƒå˜é‡åï¼Œæ­¤é¡¹å‚æ•°ä¸éœ€è¦å†è®¾ç½®ã€‚

-   **å‚æ•°17:plink_software_name**

**Plink**è½¯ä»¶çš„åç§°ï¼Œ`character`ç±»å‹ã€‚æ¶‰åŠåˆ°VCFæ ¼å¼è½¬æ¢æ—¶ï¼Œéœ€è¦ä½¿ç”¨ **Plink**è½¯ä»¶ã€‚è½¯ä»¶é»˜è®¤åç§°ä¸ºï¼šplinkã€‚

-   **å‚æ•°18:vcftools_software_path**

**vcftools**è½¯ä»¶çš„è·¯å¾„ï¼Œ`character`ç±»å‹ã€‚æ¶‰åŠåˆ°VCFæ ¼å¼è½¬æ¢æ—¶ï¼Œéœ€è¦ä½¿ç”¨**vcftools**è½¯ä»¶ã€‚å½“**vcftools**è½¯ä»¶çš„è·¯å¾„å·²åŠ å…¥åˆ°ç¯å¢ƒå˜é‡åï¼Œæ­¤é¡¹å‚æ•°ä¸éœ€è¦å†è®¾ç½®ã€‚

-   **å‚æ•°19:vcftools_software_name**

**vcftools**è½¯ä»¶çš„åç§°ï¼Œ`character`ç±»å‹ã€‚æ¶‰åŠåˆ°VCFæ ¼å¼è½¬æ¢æ—¶ï¼Œéœ€è¦ä½¿ç”¨ **vcftools**è½¯ä»¶ã€‚è½¯ä»¶é»˜è®¤åç§°ä¸ºï¼švcftoolsã€‚
