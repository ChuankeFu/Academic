---
title: 'R package:blupADC- 功能1'
author: qsmei
date: '2021-04-14'
slug: blupADC
categories: ["格式转换"]
tags: []
subtitle: ''
summary: '基因型数据格式转换'
authors: []
lastmod: '2021-04-14T14:59:41+08:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
output:
  blogdown::html_page:
    toc: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE)
```

## 简介

🙀大家好,通过前一章节的学习，相信大家已经对`blupADC` 有了一个初步的了解了。从本节开始，我们将对`blupADC`中的几个重要的函数一一进行讲解。这一节主要给大家讲述的是如何使用`blupADC`中`genotype_data_format_conversion`函数来进行多种基因型格式数据的转换。

## 示例

首先,我们以一个简单的小例子来看看函数的用法

```R
library(blupADC)
sum_data=genotype_data_format_conversion(
         input_data_hmp=data_hmp,  #provided hapmap data object 
         output_data_type=c("Plink","BLUPF90","Numeric"),# output data format
         return_result = TRUE,      # return result 
         cpu_cores=1                # number of cpu 
         )
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(blupADC)
colnames(data_hmp)[1]="rs#"
data_hmp[1:6,1]=paste0("SNP",1:6)
sum_data=genotype_data_format_conversion(
         input_data_hmp=data_hmp[1:6,],  #provided hapmap data object 
         output_data_type=c("Plink","BLUPF90","Numeric"),# output data format
         return_result = TRUE,      # return result 
         cpu_cores=1                # number of cpu 
                  )
```

下面，我们将对`genotype_data_format_conversion` 中的参数一一进行讲解

## 输出

```{r, echo=TRUE, message=FALSE, warning=FALSE}
str(sum_data) 
```

我们可以清楚的看到输出结果分为5个部分(长度为5的列表)，分别为：

-   **hmp ** : `Hapmap` 格式的基因型数据

`第1列为SNP，第3列为染色体，第4列为物理位置，第12列开始为基因型数据`

```{r input_data_hmp1,echo=FALSE}
knitr::kable(head(data_hmp[,1:15]))
```

-   **ped**  : `Plink` 格式的ped数据

`第1列为家系，第2列为个体号，第7列开始为基因型数据。`

```{r input_data_plink_map13,echo=FALSE}
data_ped=sum_data$ped
data_map=sum_data$map
colnames(data_map)=NULL
data_numeric=sum_data$numeric
data_blupf90=sum_data$blupf90
colnames(data_blupf90)=NULL
knitr::kable(head(data_ped[,1:10]))
```

-   **map **:  `Plink`格式的map数据

`第1列为染色体，第2列为SNP，第3列为遗传距离(cM), 第4列为物理位置。`

```{r input_data_plink_map3,echo=FALSE}
knitr::kable(head(data_map))
```

-   **blupf90 **: `BLUPF90`格式的基因型数据

`第1列为个体号，第2列为基因型。`

```{r input_data_blupf903,echo=FALSE}
knitr::kable(head(data_blupf90))
```

-   **numeric **: `Numeric` 格式的基因型数据

`行名为个体，列名为SNP，0,1,2表示的是个体在某个SNP位点的基因型数据`

```{r input_data_genumeric3,echo=FALSE}
knitr::kable(head(data_numeric[,1:6]))
```

## 参数

### 🤡基础参数

-   **参数1:input_data_plink_ped**

用户提供的 Plink-ped格式的数据，`data.frame `类型。具体格式见结果部分

-   **参数2:input_data_plink_map**

用户提供的 Plink-map格式的数据，`data.frame `类型。具体格式见结果部分

-   **参数3:input_data_hmp**

用户提供的 Hapmap格式的数据，`data.frame `类型。具体格式见结果部分

-   **参数4:input_data_blupf90**

用户提供的 BLUPF90格式数据，`data.frame `类型。具体格式见结果部分

-   **参数5:input_data_numeric**

用户提供的 Numeric格式的数据，`matrix(纯数字) `类型。具体格式见结果部分

**此外，为了方便用户使用，用户还可以直接通过提供本地数据的路径、名称与数据类型即可完成数据提供这一步骤,而无需将数据读入到R里面。**

-   **参数6:input_data_path**

用户提供的本地数据的文件路径，`character `类型。

-   **参数7:input_data_name**

用户提供的本地数据的文件名称，`character `类型。

**Note:** 如果提供的数据类型为Plink ,那么本地文件名称不需要带后缀，eg. 本地文件名为test1.map test1.ped，我们提供文件名称为： `input_data_name="test1"`。除了Plink格式的数据外，其他数据格式必须提供完整的名称(带后缀)。

-   **参数8:input_data_type**

    用户提供的本地数据的格式，`character `类型。数据格式包括：

    -   `Hapmap`
    -   `Plink`
    -   `BLUPF90`
    -   `Numeric`
    -   `VCF`

-   **参数9:return_result**

是否在R中返回输出的结果，`logical`类型。默认为FLASE。

此外，为了便于输出数据的保存，用户可以将数据保存到本地

-   **参数10:output_data_path**

输出的基因型数据保存到本地的路径，`character `类型。

-   **参数11:output_data_name**

输出的基因型数据保存到本地的文件名称，`character `类型。

-   **参数12:output_data_type**

    用户提供的本地数据的格式，`character `类型。数据格式包括：

    -   `Hapmap`
    -   `Plink`
    -   `BLUPF90`
    -   `Numeric`
    -   `VCF`

可选择同时输出多种数据格式。e.g.`output_data_type=c("Hapmap","Plink","BLUPF90","Numeric")` 可同时输出以上4种数据类型。

### 💨进阶参数

-   **参数13:cpu_cores**

函数调用的cpu个数，`numeric `类型。默认调用1个

-   **参数14:miss_base**

缺失值在原基因型数据中所表示的的字符，`character `类型。默认为"NN"。

-   **参数15:miss_base_num**

数字化格式转换中缺失值转换成的数字，`numeric `类型。默认为 5。

-   **参数16:plink_software_path**

**Plink**软件的路径，`character `类型。涉及到VCF格式转换时，需要使用 **Plink**软件。当**Plink**软件的路径已加入到环境变量后，此项参数不需要再设置。

-   **参数17:plink_software_name**

**Plink**软件的名称，`character `类型。涉及到VCF格式转换时，需要使用 **Plink**软件。软件默认名称为：plink。

-   **参数18:vcftools_software_path**

**vcftools**软件的路径，`character `类型。涉及到VCF格式转换时，需要使用**vcftools**软件。当**vcftools**软件的路径已加入到环境变量后，此项参数不需要再设置。

-   **参数19:vcftools_software_name**

**vcftools**软件的名称，`character `类型。涉及到VCF格式转换时，需要使用 **vcftools**软件。软件默认名称为：vcftools。