---
title: 'R package:blupADC- ä½¿ç”¨è¯´æ˜1'
author: qsmei
date: '2021-04-14'
slug: blupADC
categories: ["æ ¼å¼è½¬æ¢"]
tags: []
subtitle: ''
summary: 'åŸºå› å‹æ•°æ®æ ¼å¼è½¬æ¢'
authors: []
lastmod: '2021-04-14T14:59:41+08:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE)
```

ğŸ™€å¤§å®¶å¥½,é€šè¿‡å‰ä¸€ç« èŠ‚çš„å­¦ä¹ ï¼Œç›¸ä¿¡å¤§å®¶å·²ç»å¯¹`blupADC` æœ‰äº†ä¸€ä¸ªåˆæ­¥çš„äº†è§£äº†ã€‚ä»æœ¬èŠ‚å¼€å§‹ï¼Œæˆ‘ä»¬å°†å¯¹`blupADC`ä¸­çš„å‡ ä¸ªé‡è¦çš„å‡½æ•°ä¸€ä¸€è¿›è¡Œè®²è§£ã€‚è¿™ä¸€èŠ‚ä¸»è¦ç»™å¤§å®¶è®²è¿°çš„æ˜¯å¦‚ä½•ä½¿ç”¨`blupADC`ä¸­`genotype_data_format_conversion`å‡½æ•°æ¥è¿›è¡Œå¤šç§åŸºå› å‹æ ¼å¼æ•°æ®çš„è½¬æ¢ã€‚

## åŸºå› å‹æ•°æ®æ ¼å¼è½¬åŒ–

é¦–å…ˆ,æˆ‘ä»¬ä»¥ä¸€ä¸ªç®€å•çš„å°ä¾‹å­æ¥çœ‹çœ‹å‡½æ•°çš„ç”¨æ³•

```{r genotype}
library(blupADC)
data_ped=data.table::fread("D:/test_code/BLUP_ADC_code/test_data/data.ped",data.table = F)
data_map=data.table::fread("D:/test_code/BLUP_ADC_code/test_data/data.map",data.table = F)
data_hmp=data.table::fread("D:/test_code/BLUP_ADC_code/test_data/data_hmp.txt",data.table = F)
data_blupf90=data.table::fread("D:/test_code/BLUP_ADC_code/test_data/test_data_blupf90.txt",data.table = F,colClasses="character")
data_genumeric=data.table::fread("D:/test_code/BLUP_ADC_code/test_data/data.genumeric",data.table = F)
row.names(data_genumeric)=paste0("Ind",1:nrow(data_genumeric))

```

``` {.R}
sum_data=genotype_data_format_conversion(
         input_data_plink_ped=data_ped,  #ç”¨æˆ·è¾“å…¥çš„ plink-pedæ ¼å¼æ•°æ®
         input_data_plink_map=data_map,  #ç”¨æˆ·è¾“å…¥çš„ plink-mapæ ¼å¼æ•°æ®
         output_data_type=c("Hapmap","Blupf90"),#è¾“å‡ºçš„åŸºå› å‹æ•°æ®æ ¼å¼
         return_result = TRUE,      #åœ¨Rä¸­è¿”å›ç»“æœ
         cpu_cores=1                #è°ƒç”¨çš„cpuä¸ªæ•°
                  )
```

ä¸‹é¢ï¼Œæˆ‘ä»¬å°†å¯¹`genotype_data_format_conversion` ä¸­çš„å‚æ•°ä¸€ä¸€è¿›è¡Œè®²è§£

### ğŸ¤¡ä¸»è¦å‚æ•°

-   **å‚æ•°1:input_data_plink_ped**

ç”¨æˆ·æä¾›çš„ Plink-pedæ ¼å¼çš„æ•°æ®ã€‚data.frameç±»å‹ã€‚å…·ä½“æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š

```{r input_data_plink_ped,echo=FALSE}
knitr::kable(head(data_ped[,1:10]))
```

-   **å‚æ•°2:input_data_plink_map**

ç”¨æˆ·æä¾›çš„ Plink-mapæ ¼å¼çš„æ•°æ®ã€‚data.frameç±»å‹ã€‚å…·ä½“æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š

```{r input_data_plink_map,echo=FALSE}
knitr::kable(head(data_map[,1:4]))
```

-   **å‚æ•°3:input_data_hmp**

ç”¨æˆ·æä¾›çš„ Hapmapæ ¼å¼çš„æ•°æ®ã€‚data.frameç±»å‹ã€‚å…·ä½“æ ¼å¼å¦‚ä¸‹æ‰€ç¤º

```{r input_data_hmp,echo=FALSE}
knitr::kable(head(data_hmp[,1:15]))
```

-   **å‚æ•°4:input_data_blupf90**

ç”¨æˆ·æä¾›çš„ BLUPF90æ ¼å¼æ•°æ®ã€‚data.frameç±»å‹ã€‚å…·ä½“æ ¼å¼å¦‚ä¸‹æ‰€ç¤º

```{r input_data_blupf90,echo=FALSE}
knitr::kable(head(data_blupf90[,1:2]))
```

-   **å‚æ•°5:input_data_genumeric**

ç”¨æˆ·æä¾›çš„ Numericæ ¼å¼çš„æ•°æ®ã€‚Numeric matrixç±»å‹ã€‚å…·ä½“æ ¼å¼å¦‚ä¸‹æ‰€ç¤º

```{r input_data_genumeric,echo=FALSE}
knitr::kable(head(data_genumeric[,1:6]))

```

**Note:** è¡Œä¸ºä¸ªä½“ï¼Œåˆ—ä¸ºSNPï¼Œå¿…é¡»åŒ…æ‹¬åˆ—åå’Œè¡Œåã€‚

æ­¤å¤–ï¼Œä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨ï¼Œç”¨æˆ·è¿˜å¯ä»¥ç›´æ¥é€šè¿‡æä¾›æœ¬åœ°æ•°æ®çš„è·¯å¾„ã€åç§°ä¸æ•°æ®ç±»å‹å³å¯å®Œæˆæ•°æ®æä¾›è¿™ä¸€æ­¥éª¤,è€Œæ— éœ€å°†æ•°æ®è¯»å…¥åˆ°Ré‡Œé¢ã€‚

-   **å‚æ•°6:input_data_path**

ç”¨æˆ·æä¾›çš„æœ¬åœ°æ•°æ®çš„æ–‡ä»¶è·¯å¾„ã€‚characterç±»å‹ã€‚

-   **å‚æ•°7:input_data_name**

ç”¨æˆ·æä¾›çš„æœ¬åœ°æ•°æ®çš„æ–‡ä»¶åç§°ã€‚characterç±»å‹ã€‚

**Note:** å¦‚æœæä¾›çš„æ•°æ®ç±»å‹ä¸ºPlink ,é‚£ä¹ˆæœ¬åœ°æ–‡ä»¶åç§°ä¸éœ€è¦å¸¦åç¼€ï¼Œeg. æœ¬åœ°æ–‡ä»¶åä¸ºtest1.map test1.pedï¼Œæˆ‘ä»¬æä¾›æ–‡ä»¶åç§°ä¸ºï¼š input_data_name="test1"ã€‚é™¤äº†Plinkæ ¼å¼çš„æ•°æ®å¤–ï¼Œå…¶ä»–æ•°æ®æ ¼å¼å¿…é¡»æä¾›å®Œæ•´çš„åç§°(å¸¦åç¼€)

-   **å‚æ•°8:input_data_type**

ç”¨æˆ·æä¾›çš„æœ¬åœ°æ•°æ®çš„æ ¼å¼ã€‚character vectorç±»å‹ã€‚å¯é€‰æ ¼å¼åŒ…æ‹¬ï¼š

1.  Hapmap
2.  Plink
3.  Blupf90
4.  Numeric
5.  VCF(éœ€è¦æå‰å®‰è£…å¥½vcftoolsè½¯ä»¶,å¹¶è®¾ç½®å¥½ç¯å¢ƒå˜é‡)

-   **å‚æ•°9:return_result**

æ˜¯å¦åœ¨Rä¸­è¿”å›è¾“å‡ºçš„ç»“æœã€‚logicalç±»å‹ã€‚é»˜è®¤ä¸ºFLASEã€‚

æ­¤å¤–ï¼Œä¸ºäº†ä¾¿äºè¾“å‡ºæ•°æ®çš„ä¿å­˜ï¼Œç”¨æˆ·å¯ä»¥å°†æ•°æ®ä¿å­˜åˆ°æœ¬åœ°

-   **å‚æ•°10:output_data_path**

è¾“å‡ºçš„åŸºå› å‹æ•°æ®ä¿å­˜åˆ°æœ¬åœ°çš„è·¯å¾„ã€‚characterç±»å‹ã€‚

-   **å‚æ•°11:output_data_name**

è¾“å‡ºçš„åŸºå› å‹æ•°æ®ä¿å­˜åˆ°æœ¬åœ°çš„æ–‡ä»¶åç§°ã€‚characterç±»å‹ã€‚

-   **å‚æ•°12:output_data_type**

è¾“å‡ºçš„åŸºå› å‹æ•°æ®çš„æ ¼å¼ã€‚character vectorç±»å‹ã€‚å¯é€‰æ ¼å¼åŒ…æ‹¬ï¼š

1.  Hapmap
2.  Plink
3.  Blupf90
4.  Numeric
5.  VCF(éœ€è¦æå‰å®‰è£…å¥½vcftoolsè½¯ä»¶,å¹¶è®¾ç½®å¥½ç¯å¢ƒå˜é‡)

å¯é€‰æ‹©åŒæ—¶è¾“å‡ºå¤šç§æ•°æ®æ ¼å¼ã€‚e.g.`output_data_type=c("Hapmap","Plink","Blupf90","Numeric")` å¯åŒæ—¶è¾“å‡ºä»¥ä¸Š4ç§æ•°æ®ç±»å‹ã€‚

### ğŸ’¨å…¶ä»–å‚æ•°

-   **å‚æ•°13:cpu_cores**

å‡½æ•°è°ƒç”¨çš„cpuä¸ªæ•°,é»˜è®¤è°ƒç”¨1ä¸ª

-   **å‚æ•°14:miss_base**

ç¼ºå¤±å€¼åœ¨åŸåŸºå› å‹æ•°æ®ä¸­æ‰€è¡¨ç¤ºçš„çš„å­—ç¬¦ã€‚characterç±»å‹ã€‚é»˜è®¤ä¸º"NN"

-   **å‚æ•°15:miss_base_num**

æ•°å­—åŒ–æ ¼å¼è½¬æ¢ä¸­ï¼Œç¼ºå¤±å€¼è½¬æ¢æˆçš„æ•°å­—ã€‚numericç±»å‹ã€‚é»˜è®¤ä¸º 5
