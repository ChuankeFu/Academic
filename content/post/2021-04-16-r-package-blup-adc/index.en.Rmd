---
title: 'R package:blupADC- 使用说明1'
author: qsmei
date: '2021-04-14'
slug: blupADC
categories: ["格式转换"]
tags: []
subtitle: ''
summary: '基因型数据格式转换'
authors: []
lastmod: '2021-04-14T14:59:41+08:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE)
```

🙀大家好,通过前一章节的学习，相信大家已经对`blupADC` 有了一个初步的了解了。从本节开始，我们将对`blupADC`中的几个重要的函数一一进行讲解。这一节主要给大家讲述的是如何使用`blupADC`中`genotype_data_format_conversion`函数来进行多种基因型格式数据的转换。

## 基因型数据格式转化

首先,我们以一个简单的小例子来看看函数的用法

```{r genotype}
library(blupADC)
data_ped=data.table::fread("D:/test_code/BLUP_ADC_code/test_data/data.ped",data.table = F)
data_map=data.table::fread("D:/test_code/BLUP_ADC_code/test_data/data.map",data.table = F)
data_hmp=data.table::fread("D:/test_code/BLUP_ADC_code/test_data/data_hmp.txt",data.table = F)
data_blupf90=data.table::fread("D:/test_code/BLUP_ADC_code/test_data/test_data_blupf90.txt",data.table = F,colClasses="character")
data_genumeric=data.table::fread("D:/test_code/BLUP_ADC_code/test_data/data.genumeric",data.table = F)
row.names(data_genumeric)=paste0("Ind",1:nrow(data_genumeric))

```

``` {.R}
sum_data=genotype_data_format_conversion(
         input_data_plink_ped=data_ped,  #用户输入的 plink-ped格式数据
         input_data_plink_map=data_map,  #用户输入的 plink-map格式数据
         output_data_type=c("Hapmap","Blupf90"),#输出的基因型数据格式
         return_result = TRUE,      #在R中返回结果
         cpu_cores=1                #调用的cpu个数
                  )
```

下面，我们将对`genotype_data_format_conversion` 中的参数一一进行讲解

### 🤡主要参数

-   **参数1:input_data_plink_ped**

用户提供的 Plink-ped格式的数据。data.frame类型。具体格式如下所示：

```{r input_data_plink_ped,echo=FALSE}
knitr::kable(head(data_ped[,1:10]))
```

-   **参数2:input_data_plink_map**

用户提供的 Plink-map格式的数据。data.frame类型。具体格式如下所示：

```{r input_data_plink_map,echo=FALSE}
knitr::kable(head(data_map[,1:4]))
```

-   **参数3:input_data_hmp**

用户提供的 Hapmap格式的数据。data.frame类型。具体格式如下所示

```{r input_data_hmp,echo=FALSE}
knitr::kable(head(data_hmp[,1:15]))
```

-   **参数4:input_data_blupf90**

用户提供的 BLUPF90格式数据。data.frame类型。具体格式如下所示

```{r input_data_blupf90,echo=FALSE}
knitr::kable(head(data_blupf90[,1:2]))
```

-   **参数5:input_data_genumeric**

用户提供的 Numeric格式的数据。Numeric matrix类型。具体格式如下所示

```{r input_data_genumeric,echo=FALSE}
knitr::kable(head(data_genumeric[,1:6]))

```

**Note:** 行为个体，列为SNP，必须包括列名和行名。

此外，为了方便用户使用，用户还可以直接通过提供本地数据的路径、名称与数据类型即可完成数据提供这一步骤,而无需将数据读入到R里面。

-   **参数6:input_data_path**

用户提供的本地数据的文件路径。character类型。

-   **参数7:input_data_name**

用户提供的本地数据的文件名称。character类型。

**Note:** 如果提供的数据类型为Plink ,那么本地文件名称不需要带后缀，eg. 本地文件名为test1.map test1.ped，我们提供文件名称为： input_data_name="test1"。除了Plink格式的数据外，其他数据格式必须提供完整的名称(带后缀)

-   **参数8:input_data_type**

用户提供的本地数据的格式。character vector类型。可选格式包括：

1.  Hapmap
2.  Plink
3.  Blupf90
4.  Numeric
5.  VCF(需要提前安装好vcftools软件,并设置好环境变量)

-   **参数9:return_result**

是否在R中返回输出的结果。logical类型。默认为FLASE。

此外，为了便于输出数据的保存，用户可以将数据保存到本地

-   **参数10:output_data_path**

输出的基因型数据保存到本地的路径。character类型。

-   **参数11:output_data_name**

输出的基因型数据保存到本地的文件名称。character类型。

-   **参数12:output_data_type**

输出的基因型数据的格式。character vector类型。可选格式包括：

1.  Hapmap
2.  Plink
3.  Blupf90
4.  Numeric
5.  VCF(需要提前安装好vcftools软件,并设置好环境变量)

可选择同时输出多种数据格式。e.g.`output_data_type=c("Hapmap","Plink","Blupf90","Numeric")` 可同时输出以上4种数据类型。

### 💨其他参数

-   **参数13:cpu_cores**

函数调用的cpu个数,默认调用1个

-   **参数14:miss_base**

缺失值在原基因型数据中所表示的的字符。character类型。默认为"NN"

-   **参数15:miss_base_num**

数字化格式转换中，缺失值转换成的数字。numeric类型。默认为 5
