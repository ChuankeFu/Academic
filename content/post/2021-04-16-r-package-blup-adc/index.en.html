---
title: 'R package:blupADC- ä½¿ç”¨è¯´æ˜1'
author: qsmei
date: '2021-04-14'
slug: blupADC
categories: ["æ ¼å¼è½¬æ¢"]
tags: []
subtitle: ''
summary: 'åŸºå› å‹æ•°æ®æ ¼å¼è½¬æ¢'
authors: []
lastmod: '2021-04-14T14:59:41+08:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---

<script src="{{< blogdown/postref >}}index.en_files/header-attrs/header-attrs.js"></script>


<p>ğŸ™€å¤§å®¶å¥½,é€šè¿‡å‰ä¸€ç« èŠ‚çš„å­¦ä¹ ï¼Œç›¸ä¿¡å¤§å®¶å·²ç»å¯¹<code>blupADC</code> æœ‰äº†ä¸€ä¸ªåˆæ­¥çš„äº†è§£äº†ã€‚ä»æœ¬èŠ‚å¼€å§‹ï¼Œæˆ‘ä»¬å°†å¯¹<code>blupADC</code>ä¸­çš„å‡ ä¸ªé‡è¦çš„å‡½æ•°ä¸€ä¸€è¿›è¡Œè®²è§£ã€‚è¿™ä¸€èŠ‚ä¸»è¦ç»™å¤§å®¶è®²è¿°çš„æ˜¯å¦‚ä½•ä½¿ç”¨<code>blupADC</code>ä¸­<code>genotype_data_format_conversion</code>å‡½æ•°æ¥è¿›è¡Œå¤šç§åŸºå› å‹æ ¼å¼æ•°æ®çš„è½¬æ¢ã€‚</p>
<div id="åŸºå› å‹æ•°æ®æ ¼å¼è½¬åŒ–" class="section level2">
<h2>åŸºå› å‹æ•°æ®æ ¼å¼è½¬åŒ–</h2>
<p>é¦–å…ˆ,æˆ‘ä»¬ä»¥ä¸€ä¸ªç®€å•çš„å°ä¾‹å­æ¥çœ‹çœ‹å‡½æ•°çš„ç”¨æ³•</p>
<pre class="r"><code>library(blupADC)
data_ped=data.table::fread(&quot;D:/test_code/BLUP_ADC_code/test_data/data.ped&quot;,data.table = F)
data_map=data.table::fread(&quot;D:/test_code/BLUP_ADC_code/test_data/data.map&quot;,data.table = F)
data_hmp=data.table::fread(&quot;D:/test_code/BLUP_ADC_code/test_data/data_hmp.txt&quot;,data.table = F)
data_blupf90=data.table::fread(&quot;D:/test_code/BLUP_ADC_code/test_data/test_data_blupf90.txt&quot;,data.table = F,colClasses=&quot;character&quot;)
data_genumeric=data.table::fread(&quot;D:/test_code/BLUP_ADC_code/test_data/data.genumeric&quot;,data.table = F)
row.names(data_genumeric)=paste0(&quot;Ind&quot;,1:nrow(data_genumeric))</code></pre>
<pre class="R"><code>sum_data=genotype_data_format_conversion(
         input_data_plink_ped=data_ped,  #ç”¨æˆ·è¾“å…¥çš„ plink-pedæ ¼å¼æ•°æ®
         input_data_plink_map=data_map,  #ç”¨æˆ·è¾“å…¥çš„ plink-mapæ ¼å¼æ•°æ®
         output_data_type=c(&quot;Hapmap&quot;,&quot;Blupf90&quot;),#è¾“å‡ºçš„åŸºå› å‹æ•°æ®æ ¼å¼
         return_result = TRUE,      #åœ¨Rä¸­è¿”å›ç»“æœ
         cpu_cores=1                #è°ƒç”¨çš„cpuä¸ªæ•°
                  )</code></pre>
<p>ä¸‹é¢ï¼Œæˆ‘ä»¬å°†å¯¹<code>genotype_data_format_conversion</code> ä¸­çš„å‚æ•°ä¸€ä¸€è¿›è¡Œè®²è§£</p>
<div id="ä¸»è¦å‚æ•°" class="section level3">
<h3>ğŸ¤¡ä¸»è¦å‚æ•°</h3>
<ul>
<li><strong>å‚æ•°1:input_data_plink_ped</strong></li>
</ul>
<p>ç”¨æˆ·æä¾›çš„ Plink-pedæ ¼å¼çš„æ•°æ®ã€‚data.frameç±»å‹ã€‚å…·ä½“æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<table>
<thead>
<tr class="header">
<th align="left">V1</th>
<th align="left">V2</th>
<th align="right">V3</th>
<th align="right">V4</th>
<th align="right">V5</th>
<th align="right">V6</th>
<th align="left">V7</th>
<th align="left">V8</th>
<th align="left">V9</th>
<th align="left">V10</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Ind1</td>
<td align="left">Ind1</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">C</td>
<td align="left">C</td>
<td align="left">T</td>
<td align="left">T</td>
</tr>
<tr class="even">
<td align="left">Ind2</td>
<td align="left">Ind2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">C</td>
<td align="left">C</td>
<td align="left">G</td>
<td align="left">G</td>
</tr>
<tr class="odd">
<td align="left">Ind3</td>
<td align="left">Ind3</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">A</td>
<td align="left">C</td>
<td align="left">G</td>
<td align="left">G</td>
</tr>
<tr class="even">
<td align="left">Ind4</td>
<td align="left">Ind4</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">C</td>
<td align="left">C</td>
<td align="left">G</td>
<td align="left">T</td>
</tr>
<tr class="odd">
<td align="left">Ind5</td>
<td align="left">Ind5</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">C</td>
<td align="left">C</td>
<td align="left">G</td>
<td align="left">T</td>
</tr>
<tr class="even">
<td align="left">Ind6</td>
<td align="left">Ind6</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="left">A</td>
<td align="left">A</td>
<td align="left">G</td>
<td align="left">G</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>å‚æ•°2:input_data_plink_map</strong></li>
</ul>
<p>ç”¨æˆ·æä¾›çš„ Plink-mapæ ¼å¼çš„æ•°æ®ã€‚data.frameç±»å‹ã€‚å…·ä½“æ ¼å¼å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<table>
<thead>
<tr class="header">
<th align="right">V1</th>
<th align="left">V2</th>
<th align="right">V3</th>
<th align="right">V4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">SNP1842</td>
<td align="right">0.22</td>
<td align="right">224488</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">SNP2977</td>
<td align="right">0.29</td>
<td align="right">293696</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">SNP3321</td>
<td align="right">0.33</td>
<td align="right">333333</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">SNP3941</td>
<td align="right">0.72</td>
<td align="right">722623</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">SNP4138</td>
<td align="right">0.84</td>
<td align="right">838596</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">SNP4303</td>
<td align="right">0.93</td>
<td align="right">934682</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>å‚æ•°3:input_data_hmp</strong></li>
</ul>
<p>ç”¨æˆ·æä¾›çš„ Hapmapæ ¼å¼çš„æ•°æ®ã€‚data.frameç±»å‹ã€‚å…·ä½“æ ¼å¼å¦‚ä¸‹æ‰€ç¤º</p>
<table style="width:100%;">
<colgroup>
<col width="4%" />
<col width="7%" />
<col width="5%" />
<col width="9%" />
<col width="6%" />
<col width="8%" />
<col width="6%" />
<col width="8%" />
<col width="9%" />
<col width="9%" />
<col width="6%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
<col width="4%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">rs#</th>
<th align="left">alleles</th>
<th align="right">chrom</th>
<th align="right">pos</th>
<th align="left">strand</th>
<th align="left">assembly</th>
<th align="left">center</th>
<th align="left">protLSID</th>
<th align="left">assayLSID</th>
<th align="left">panelLSID</th>
<th align="left">QCcode</th>
<th align="left">Ind1</th>
<th align="left">Ind2</th>
<th align="left">Ind3</th>
<th align="left">Ind4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SNP1</td>
<td align="left">NA</td>
<td align="right">1</td>
<td align="right">100050454</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">TT</td>
<td align="left">CC</td>
<td align="left">CT</td>
<td align="left">CC</td>
</tr>
<tr class="even">
<td align="left">SNP2</td>
<td align="left">NA</td>
<td align="right">1</td>
<td align="right">100142509</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">AA</td>
<td align="left">CC</td>
<td align="left">CC</td>
<td align="left">CC</td>
</tr>
<tr class="odd">
<td align="left">SNP3</td>
<td align="left">NA</td>
<td align="right">1</td>
<td align="right">100223426</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">TT</td>
<td align="left">TT</td>
<td align="left">TT</td>
<td align="left">TT</td>
</tr>
<tr class="even">
<td align="left">SNP4</td>
<td align="left">NA</td>
<td align="right">1</td>
<td align="right">100297114</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">CC</td>
<td align="left">CT</td>
<td align="left">CT</td>
<td align="left">CT</td>
</tr>
<tr class="odd">
<td align="left">SNP5</td>
<td align="left">NA</td>
<td align="right">1</td>
<td align="right">100398783</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">CC</td>
<td align="left">CT</td>
<td align="left">CT</td>
<td align="left">CT</td>
</tr>
<tr class="even">
<td align="left">SNP6</td>
<td align="left">NA</td>
<td align="right">1</td>
<td align="right">100420304</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">NA</td>
<td align="left">TT</td>
<td align="left">GT</td>
<td align="left">GT</td>
<td align="left">GT</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>å‚æ•°4:input_data_blupf90</strong></li>
</ul>
<p>ç”¨æˆ·æä¾›çš„ BLUPF90æ ¼å¼æ•°æ®ã€‚data.frameç±»å‹ã€‚å…·ä½“æ ¼å¼å¦‚ä¸‹æ‰€ç¤º</p>
<table>
<thead>
<tr class="header">
<th align="left">V1</th>
<th align="left">V2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Ind1</td>
<td align="left">2221100000200</td>
</tr>
<tr class="even">
<td align="left">Ind12</td>
<td align="left">2000022222022</td>
</tr>
<tr class="odd">
<td align="left">Ind13</td>
<td align="left">1011111111111</td>
</tr>
<tr class="even">
<td align="left">Ind111</td>
<td align="left">2120022211022</td>
</tr>
<tr class="odd">
<td align="left">Ind125</td>
<td align="left">2111011111111</td>
</tr>
<tr class="even">
<td align="left">Ind1161</td>
<td align="left">0022200000200</td>
</tr>
</tbody>
</table>
<ul>
<li><strong>å‚æ•°5:input_data_genumeric</strong></li>
</ul>
<p>ç”¨æˆ·æä¾›çš„ Numericæ ¼å¼çš„æ•°æ®ã€‚Numeric matrixç±»å‹ã€‚å…·ä½“æ ¼å¼å¦‚ä¸‹æ‰€ç¤º</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">SNP1842</th>
<th align="right">SNP2977</th>
<th align="right">SNP3321</th>
<th align="right">SNP3941</th>
<th align="right">SNP4138</th>
<th align="right">SNP4303</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Ind1</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">Ind2</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Ind3</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Ind4</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">2</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">Ind5</td>
<td align="right">2</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">Ind6</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<p><strong>Note:</strong> è¡Œä¸ºä¸ªä½“ï¼Œåˆ—ä¸ºSNPï¼Œå¿…é¡»åŒ…æ‹¬åˆ—åå’Œè¡Œåã€‚</p>
<p>æ­¤å¤–ï¼Œä¸ºäº†æ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨ï¼Œç”¨æˆ·è¿˜å¯ä»¥ç›´æ¥é€šè¿‡æä¾›æœ¬åœ°æ•°æ®çš„è·¯å¾„ã€åç§°ä¸æ•°æ®ç±»å‹å³å¯å®Œæˆæ•°æ®æä¾›è¿™ä¸€æ­¥éª¤,è€Œæ— éœ€å°†æ•°æ®è¯»å…¥åˆ°Ré‡Œé¢ã€‚</p>
<ul>
<li><strong>å‚æ•°6:input_data_path</strong></li>
</ul>
<p>ç”¨æˆ·æä¾›çš„æœ¬åœ°æ•°æ®çš„æ–‡ä»¶è·¯å¾„ã€‚characterç±»å‹ã€‚</p>
<ul>
<li><strong>å‚æ•°7:input_data_name</strong></li>
</ul>
<p>ç”¨æˆ·æä¾›çš„æœ¬åœ°æ•°æ®çš„æ–‡ä»¶åç§°ã€‚characterç±»å‹ã€‚</p>
<p><strong>Note:</strong> å¦‚æœæä¾›çš„æ•°æ®ç±»å‹ä¸ºPlink ,é‚£ä¹ˆæœ¬åœ°æ–‡ä»¶åç§°ä¸éœ€è¦å¸¦åç¼€ï¼Œeg. æœ¬åœ°æ–‡ä»¶åä¸ºtest1.map test1.pedï¼Œæˆ‘ä»¬æä¾›æ–‡ä»¶åç§°ä¸ºï¼š input_data_name=â€œtest1â€ã€‚é™¤äº†Plinkæ ¼å¼çš„æ•°æ®å¤–ï¼Œå…¶ä»–æ•°æ®æ ¼å¼å¿…é¡»æä¾›å®Œæ•´çš„åç§°(å¸¦åç¼€)</p>
<ul>
<li><strong>å‚æ•°8:input_data_type</strong></li>
</ul>
<p>ç”¨æˆ·æä¾›çš„æœ¬åœ°æ•°æ®çš„æ ¼å¼ã€‚character vectorç±»å‹ã€‚å¯é€‰æ ¼å¼åŒ…æ‹¬ï¼š</p>
<ol style="list-style-type: decimal">
<li>Hapmap</li>
<li>Plink</li>
<li>Blupf90</li>
<li>Numeric</li>
<li>VCF(éœ€è¦æå‰å®‰è£…å¥½vcftoolsè½¯ä»¶,å¹¶è®¾ç½®å¥½ç¯å¢ƒå˜é‡)</li>
</ol>
<ul>
<li><strong>å‚æ•°9:return_result</strong></li>
</ul>
<p>æ˜¯å¦åœ¨Rä¸­è¿”å›è¾“å‡ºçš„ç»“æœã€‚logicalç±»å‹ã€‚é»˜è®¤ä¸ºFLASEã€‚</p>
<p>æ­¤å¤–ï¼Œä¸ºäº†ä¾¿äºè¾“å‡ºæ•°æ®çš„ä¿å­˜ï¼Œç”¨æˆ·å¯ä»¥å°†æ•°æ®ä¿å­˜åˆ°æœ¬åœ°</p>
<ul>
<li><strong>å‚æ•°10:output_data_path</strong></li>
</ul>
<p>è¾“å‡ºçš„åŸºå› å‹æ•°æ®ä¿å­˜åˆ°æœ¬åœ°çš„è·¯å¾„ã€‚characterç±»å‹ã€‚</p>
<ul>
<li><strong>å‚æ•°11:output_data_name</strong></li>
</ul>
<p>è¾“å‡ºçš„åŸºå› å‹æ•°æ®ä¿å­˜åˆ°æœ¬åœ°çš„æ–‡ä»¶åç§°ã€‚characterç±»å‹ã€‚</p>
<ul>
<li><strong>å‚æ•°12:output_data_type</strong></li>
</ul>
<p>è¾“å‡ºçš„åŸºå› å‹æ•°æ®çš„æ ¼å¼ã€‚character vectorç±»å‹ã€‚å¯é€‰æ ¼å¼åŒ…æ‹¬ï¼š</p>
<ol style="list-style-type: decimal">
<li>Hapmap</li>
<li>Plink</li>
<li>Blupf90</li>
<li>Numeric</li>
<li>VCF(éœ€è¦æå‰å®‰è£…å¥½vcftoolsè½¯ä»¶,å¹¶è®¾ç½®å¥½ç¯å¢ƒå˜é‡)</li>
</ol>
<p>å¯é€‰æ‹©åŒæ—¶è¾“å‡ºå¤šç§æ•°æ®æ ¼å¼ã€‚e.g.<code>output_data_type=c("Hapmap","Plink","Blupf90","Numeric")</code> å¯åŒæ—¶è¾“å‡ºä»¥ä¸Š4ç§æ•°æ®ç±»å‹ã€‚</p>
</div>
<div id="å…¶ä»–å‚æ•°" class="section level3">
<h3>ğŸ’¨å…¶ä»–å‚æ•°</h3>
<ul>
<li><strong>å‚æ•°13:cpu_cores</strong></li>
</ul>
<p>å‡½æ•°è°ƒç”¨çš„cpuä¸ªæ•°,é»˜è®¤è°ƒç”¨1ä¸ª</p>
<ul>
<li><strong>å‚æ•°14:miss_base</strong></li>
</ul>
<p>ç¼ºå¤±å€¼åœ¨åŸåŸºå› å‹æ•°æ®ä¸­æ‰€è¡¨ç¤ºçš„çš„å­—ç¬¦ã€‚characterç±»å‹ã€‚é»˜è®¤ä¸ºâ€œNNâ€</p>
<ul>
<li><strong>å‚æ•°15:miss_base_num</strong></li>
</ul>
<p>æ•°å­—åŒ–æ ¼å¼è½¬æ¢ä¸­ï¼Œç¼ºå¤±å€¼è½¬æ¢æˆçš„æ•°å­—ã€‚numericç±»å‹ã€‚é»˜è®¤ä¸º 5</p>
</div>
</div>
