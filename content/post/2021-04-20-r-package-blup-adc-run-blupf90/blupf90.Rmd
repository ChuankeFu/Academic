---
title: 'R package:blupADC-使用说明7'
author: qsmei
date: '2021-04-21'
slug: blupf90
categories:
  - BLUPf90
tags: []
subtitle: ''
summary: 'R里运行BLUPF90软件并完成相应的分析'
authors: ["qsmei"]
lastmod: '2021-04-21T15:47:39+08:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE)
```

👻在前面的章节，我们已经讲述了如何在**R**中调用**DMU**软件并完成相应的分析。本章，我们将讲述如何通过`BLUP_ADC`中的`run_BLUPF90`函数，在**R**中调用**BLUPF90**软件并完成数据分析。为了方便用户的使用，我们已经尽可能地将 `run_BLUPF90`函数中的参数 和 `run_DMU`函数中的参数进行了统一。

接下来，我们还是用一个简单的例子看看该函数的用法:

``` {.R}
library(blupADC)
run_BLUPF90(        
            phe_col_names=c("Id","Sex","Herd_Year_Season","Litter","Trait1","Trait2","Age"),  #表型数据的列名
            target_trait_name=c("Trait1"),                               #目标性状名称
            fixed_effect_name=list(c("Sex","Herd_Year_Season")),         #固定效应名称
            random_effect_name=list(c("Id","Litter")),                   #随机效应名称
            covariate_effect_name=list(c("Age")),                        #协变量名称
            phe_path="D:/test_code/BLUP_ADC_code/DMU_example",           #表型数据路径
            phe_name="dmu_phe.txt",                                      #表型数据名称
            analysis_model="PBLUP_A",                                    #分析方法
            relationship_path="D:/test_code/BLUP_ADC_code/DMU_example",  #亲缘关系文件路径
            relationship_name="Blupf90_ped.txt",                         #亲缘关系文件名称
            output_result_path="C:/Users/26564/Desktop/BLUPF90",         #BLUPF90结果保存路径
            output_ebv_path="C:/Users/26564/Desktop/BLUPF90",            #EBV结果保存的路径
            output_ebv_name="test",                                      #EBV结果保存的文件名
            BLUPf90_software_path="D:/test_code/BLUPf90_software"        #BLUPF90软件的路径
            )
```

通过上面的这个小脚本，我们即能完成**BLUPF90**的单性状模型的计算。与上一节的介绍的`run_DMU`函数类似，如果我们想完成双性状模型的计算，只需要在上面的脚本的基础上稍作修改就能实现目的。具体代码如下：

``` {.R}
library(blupADC)
run_BLUPF90(        
            phe_col_names=c("Id","Sex","Herd_Year_Season","Litter","Trait1","Trait2","Age"),  #表型数据的列名
            target_trait_name=c("Trait1","Trait2"),                              #目标性状名称
            fixed_effect_name=list(c("Sex","Herd_Year_Season"),c("Sex")),        #固定效应名称
            random_effect_name=list(c("Id","Litter"),c("Id")),                   #随机效应名称
            covariate_effect_name=list(c("Age"),NULL),                       #协变量名称
            phe_path="D:/test_code/BLUP_ADC_code/DMU_example",           #表型数据路径
            phe_name="dmu_phe.txt",                                      #表型数据名称
            analysis_model="PBLUP_A",                                    #分析方法
            relationship_path="D:/test_code/BLUP_ADC_code/DMU_example",  #亲缘关系文件路径
            relationship_name="Blupf90_ped.txt",                         #亲缘关系文件名称
            output_result_path="C:/Users/26564/Desktop/BLUPF90",         #BLUPF90结果保存路径
            output_ebv_path="C:/Users/26564/Desktop/BLUPF90",            #EBV结果保存的路径
            output_ebv_name="test",                                      #EBV结果保存的文件名
            BLUPf90_software_path="D:/test_code/BLUPf90_software"        #BLUPF90软件的路径
            )
```

接下来，我们将对`run_BLUPF90` 中特有的参数进行讲解，剩余的参数大家可移步 [R package:blupADC-使用说明6](https://qsmei.netlify.app/post/2021-04-20-r-package-blup-adc-run-dmu/run_dmu/) 进行查看，相同参数的用法和含义均是一模一样的。

### 💫特有参数

-   参数1：`blupf90_algorithm`

BLPUF90进行方差组分估计时选用的算法，`character`类型。可选算法包括：

1.  "AI_REML"

2.  "EM_REML"

默认算法为："AI_REML"

-   参数2：`provided_blupf90_prior_file_path`

用户提供的BLUPF90格式的方差组分-PRIOR文件的路径，`character`类型。

**Note**:需要注意的一点是，**BLUPF90**格式的PRIOR文件和**DMU**格式的PRIOR文件是不相同的。关于二者的差异，以后有时间会再出一篇文章进行讲解，这里就不再赘述了。

-   参数3：`provided_blupf90_prior_file_name`

用户提供的BLUPF90格式的方差组分-PRIOR文件的名称，`character`类型。

-   参数4：`provided_blupf90_prior_effect_name`

用户提供的PRIOR文件中，与方差组分对应的各个随机效应名称，`character`类型。

-   参数5：`BLUPf90_software_path`

BLUPF90软件在本地的路径，`character`类型。
