---
title: 'R package:blupADC-ä½¿ç”¨è¯´æ˜4'
author: qsmei
date: '2021-04-17'
slug: qc_imputation
categories:
  - Imputaion
  - QC
tags: []
subtitle: ''
summary: 'åŸºå› å‹æ•°æ®çš„è´¨æ§ä¸å¡«å……'
authors: []
lastmod: '2021-04-17T21:07:25+08:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE)
```

ğŸ¤–é€šå¸¸æ¥è®²ï¼Œæˆ‘ä»¬å…¬å¸æ‹¿åˆ°çš„åŸå§‹èŠ¯ç‰‡æ•°æ®å¤§éƒ½æ˜¯åŒ…å«ç¼ºå¤±å€¼ä¸”æœªç»è¿‡è´¨æ§çš„ã€‚è€Œåœ¨å®é™…çš„æ•°æ®åˆ†æä¸­ï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½è¦æ±‚æ•°æ®æ˜¯ç»è¿‡è´¨æ§å’Œå¡«å……ã€‚ä¸ºæ­¤ï¼Œ`blupADC`ä¸­æä¾›äº†`genotype_data_QC_Imputation`å‡½æ•°ï¼Œå¯ä»¥æ–¹ä¾¿æˆ‘ä»¬åœ¨Rä¸­è°ƒç”¨**Plink**(ç”¨äºè´¨æ§)å’Œ**Beagle**(ç”¨äºå¡«å……)è½¯ä»¶è¿›è¡ŒåŸºå› å‹æ•°æ®çš„è´¨æ§å’Œå¡«å……ã€‚

ğŸ‘‰**Note:**æˆ‘ä»¬éœ€è¦æå‰ä¸‹è½½å¥½Plink(ç”¨äºè´¨æ§)å’ŒBeagle(ç”¨äºå¡«å……)è½¯ä»¶ã€‚ç”±äºPlinkå’ŒBeagleåœ¨è´¨æ§å¡«å……æ–¹é¢å·²ç»åšå¾—è¶³å¤Ÿå¥½äº†ï¼Œå› æ­¤æˆ‘ä»¬å¹¶ä¸æ‰“ç®—ç”¨Ré‡æ–°å®ç°ç›¸å…³åŠŸèƒ½ã€‚

è€è§„çŸ©ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç”¨ä¸€ä¸ªå°ä¾‹å­æ¥çœ‹ä¸‹å‡½æ•°çš„ç”¨æ³•:

``` {.R}
library(blupADC)
genotype_data_QC_Imputation(
              input_data_path="root/genotype_data",  #ç”¨æˆ·è¾“å…¥çš„åŸºå› å‹æ–‡ä»¶è·¯å¾„
              input_data_name="data_hmp.txt",        #ç”¨æˆ·è¾“å…¥çš„åŸºå› å‹æ–‡ä»¶åç§°
              input_data_type="Hapmap",              #ç”¨æˆ·è¾“å…¥çš„åŸºå› å‹æ–‡ä»¶æ ¼å¼
              method="QC_Imputation",                #åŸºå› å‹æ•°æ®å¤„ç†æ–¹æ³•ï¼šè´¨æ§+å¡«å……
              plink_software_path="/root/software",  #plinkè½¯ä»¶çš„è·¯å¾„
              plink_software_name="plink",           #plinkè½¯ä»¶çš„åç§°
              beagle_software_path="root/software",  #beagleè½¯ä»¶çš„è·¯å¾„
              beagle_software_name="beagle.5.1.jar", #beagleè½¯ä»¶çš„åç§°
              output_data_path="/root/result",       #è¾“å‡ºåŸºå› å‹æ–‡ä»¶çš„è·¯å¾„
              output_data_name="YY_data",            #è¾“å‡ºåŸºå› å‹æ–‡ä»¶çš„åç§°
              output_data_type="Plink"               #è¾“å‡ºåŸºå› å‹æ–‡ä»¶çš„æ ¼å¼
              )
```

é€šè¿‡ä¸Šè¿°ä»£ç ï¼Œæˆ‘ä»¬å³å¯å¯¹æœ¬åœ°çš„**Hapmap**æ ¼å¼çš„åŸºå› å‹æ•°æ®è¿›è¡Œè´¨æ§å’Œå¡«å……ï¼Œå¹¶å°†å…¶ä»¥**Plink**æ ¼å¼å¹¶ä¿å­˜åˆ°æœ¬åœ°ã€‚

è¿›è¡Œè´¨æ§å’Œå¡«å……æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»è¦äº‹å…ˆæä¾›åŸºå› å‹æ•°æ®ï¼Œè¿™éƒ¨åˆ†çš„å‚æ•°ä¸`genotype_data_format_conversion`å‡½æ•°ä¸­çš„å‚æ•°ç”¨æ³•ä¸€è‡´ã€‚å…·ä½“å¤§å®¶å¯å‚é˜…ä¹‹å‰çš„ä»‹ç»: [R package:blupADC- ä½¿ç”¨è¯´æ˜1](https://qsmei.netlify.app/post/blupadc/)ã€‚

å®Œæˆäº†åŸºå› å‹æ•°æ®çš„æä¾›åï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä»¥ä¸‹å‚æ•°è¿›è¡Œè´¨æ§å¡«å……çš„ç›¸å…³åˆ†æã€‚

### ğŸ’™ä¸»è¦å‚æ•°

- **å‚æ•°1ï¼šdata_analysis_method**

  æŒ‡å®šåŸºå› å‹æ•°æ®çš„å¤„ç†æ–¹æ³•ï¼Œ`character`ç±»å‹ã€‚å¯é€‰æ–¹æ³•åŒ…æ‹¬ï¼š

  -   "QC" :è¿›è¡Œè´¨æ§
  -   "Imputation" :è¿›è¡Œå¡«å……

  -   "QC_Imputation" :å…ˆè´¨æ§ï¼Œåå¡«å……

-   **å‚æ•°2ï¼šplink_software_path**

Plinkè½¯ä»¶çš„è·¯å¾„,`character`ç±»å‹ã€‚

-   **å‚æ•°3ï¼šplink_software_name**

Plinkè½¯ä»¶çš„åç§°,`character`ç±»å‹ã€‚

-   **å‚æ•°4ï¼šbeagle_software_path**

Beagleè½¯ä»¶çš„è·¯å¾„,`character`ç±»å‹ã€‚

-   **å‚æ•°5ï¼šbeagle_software_name**

Beagleè½¯ä»¶çš„åç§°,`character`ç±»å‹ã€‚

### ğŸ’œå…¶ä»–å‚æ•°

-   **å‚æ•°6ï¼šqc_snp_rate**

ä½¿ç”¨Plinkè¿›è¡Œè´¨æ§æ—¶ï¼ŒSNP call rate çš„é˜ˆå€¼ï¼Œ`numeric`ç±»å‹ï¼Œé»˜è®¤ä¸º0.1ã€‚

-   **å‚æ•°6ï¼šqc_ind_rate**

ä½¿ç”¨Plinkè¿›è¡Œè´¨æ§æ—¶ï¼ŒIND call rate çš„é˜ˆå€¼ï¼Œ`numeric`ç±»å‹ï¼Œé»˜è®¤ä¸º0.1ã€‚

-   **å‚æ•°6ï¼šqc_maf**

ä½¿ç”¨Plinkè¿›è¡Œè´¨æ§æ—¶ï¼ŒMAF çš„é˜ˆå€¼ï¼Œ`numeric`ç±»å‹ï¼Œé»˜è®¤ä¸º0.05ã€‚

-   **å‚æ•°6ï¼šqc_hwe**

ä½¿ç”¨Plinkè¿›è¡Œè´¨æ§æ—¶ï¼Œå“ˆä»£æ¸©ä¼¯æ ¼å¹³è¡¡çš„é˜ˆå€¼,`numeric`ç±»å‹ï¼Œé»˜è®¤ä¸º1e-6ã€‚

-   **å‚æ•°6ï¼šbeagle_ref_data_path**

ä½¿ç”¨beagleè¿›è¡Œå¡«å……æ—¶ï¼Œæä¾›çš„reference dataçš„è·¯å¾„ï¼Œ`character`ç±»å‹ã€‚

-   **å‚æ•°7ï¼šbeagle_ref_data_name**

ä½¿ç”¨beagleè¿›è¡Œå¡«å……æ—¶ï¼Œæä¾›çš„reference dataçš„åç§°ï¼Œ`character`ç±»å‹ã€‚

-   **å‚æ•°8ï¼šbeagle_ped_path**

ä½¿ç”¨beagleè¿›è¡Œå¡«å……æ—¶ï¼Œæä¾›çš„ç³»è°±æ•°æ®çš„è·¯å¾„ï¼Œ`character`ç±»å‹ã€‚

-   **å‚æ•°9ï¼šbeagle_ped_name**

ä½¿ç”¨beagleè¿›è¡Œå¡«å……æ—¶ï¼Œæä¾›çš„ç³»è°±æ•°æ®çš„åç§°ï¼Œ`character`ç±»å‹ã€‚
