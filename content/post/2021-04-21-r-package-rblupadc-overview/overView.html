---
title: 'R package:blupADC- Overview'
author: qsmei
date: '2021-04-13'
slug: overView
categories:
  - blupADC
tags: []
subtitle: ''
summary: 'å¯¹R package:blupADC çš„åŠŸèƒ½è¿›è¡Œç®€å•çš„ä»‹ç»'
authors: []
lastmod: '2021-04-13T22:32:36+08:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p>å¤§å®¶å¥½,æœ¬èŠ‚æˆ‘ä»¬å°±æ­£å¼å¼€å§‹<code>blupADC</code>packageçš„å­¦ä¹ äº†ã€‚åœ¨æœ¬èŠ‚ï¼Œæˆ‘ä»¬ä¸»è¦æ˜¯å¯¹<code>blupADC</code>çš„åŠŸèƒ½åšä¸€ä¸ªç®€è¦çš„æ¦‚è¿°ã€‚ä¹‹åçš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šå¯¹å‡ ä¸ªé‡è¦çš„å‡½æ•°åˆ†åˆ«è¿›è¡Œè¿›ä¸€æ­¥çš„è®²è§£ã€‚</p>
<div id="å®‰è£…" class="section level3">
<h3>ğŸ™Š<strong>å®‰è£…</strong></h3>
<p>ç›®å‰ï¼Œ<code>blupADC</code> å·²ç»ä¸Šä¼ åˆ°äº†<strong>github</strong>ä¸Šï¼Œå› æ­¤å¤§å®¶å¯ä»¥åœ¨<strong>R</strong>é‡Œé€šè¿‡å¦‚ä¸‹ä»£ç è¿›è¡Œå®‰è£…ï¼š</p>
<p><code>devtools::install_github("qsmei/blupADC")</code></p>
<p>æˆ–è€…ç›´æ¥åœ¨å‘½ä»¤è¡Œè¿›è¡Œå®‰è£…ï¼š</p>
<p><code>R CMD INSTALL blupADC_1.0.tar.gz</code></p>
<p>ğŸ’–ä¸‹é¢ï¼Œæˆ‘ä»¬å°†å°±<code>blupADC</code> ä¸­çš„å‡ ä¸ªä¸»è¦çš„åŠŸèƒ½è¿›è¡Œè®²è§£ï¼š</p>
</div>
<div id="åŠŸèƒ½1åŸºå› å‹æ•°æ®é—´çš„æ ¼å¼è½¬æ¢" class="section level3">
<h3>åŠŸèƒ½1ï¼šåŸºå› å‹æ•°æ®é—´çš„æ ¼å¼è½¬æ¢</h3>
<pre class="R"><code>library(blupADC)
sum_data=genotype_data_format_conversion(
         input_data_plink_ped=data_ped,  #ç”¨æˆ·è¾“å…¥çš„ plink-pedæ ¼å¼æ•°æ®
         input_data_plink_map=data_map,  #ç”¨æˆ·è¾“å…¥çš„ plink-mapæ ¼å¼æ•°æ®
         output_data_type=c(&quot;Hapmap&quot;,&quot;Blupf90&quot;),#è¾“å‡ºçš„åŸºå› å‹æ•°æ®æ ¼å¼
         return_result = TRUE,      #åœ¨Rä¸­è¿”å›ç»“æœ
         cpu_cores=1                #è°ƒç”¨çš„cpuä¸ªæ•°
                  )</code></pre>
</div>
<div id="åŠŸèƒ½2é‡å¤åŸºå› å‹æ•°æ®æ£€æµ‹" class="section level3">
<h3>åŠŸèƒ½2ï¼šé‡å¤åŸºå› å‹æ•°æ®æ£€æµ‹</h3>
<pre class="R"><code>library(blupADC)
overlap_result=Calculate_genotype_overlap(
                  input_data_hmp=data_hmp,   #ç”¨æˆ·è¾“å…¥çš„hapmapæ ¼å¼çš„æ•°æ®
                  overlap_threshold=0.95,    #åˆ¤æ–­åŸºå› å‹é‡å¤çš„é˜ˆå€¼
                  return_result=TRUE         #åœ¨Rä¸­è¿”å›ç»“æœ
                  )</code></pre>
</div>
<div id="åŠŸèƒ½3ç³»è°±è¿½æº¯ä¸é‡å‘½å" class="section level3">
<h3>åŠŸèƒ½3ï¼šç³»è°±è¿½æº¯ä¸é‡å‘½å</h3>
<pre class="R"><code>library(blupADC)
pedigree_result=trace_pedigree(
                pedigree=data_pedigree,    #ç”¨æˆ·æä¾›çš„ç³»è°±æ•°æ®
                trace_generation=5ï¼Œ       #å‘ä¸Šè¿½æº¯çš„ç³»è°±ä»£æ•°
                output_pedigree_tree=TRUE  #è¾“å‡ºç³»è°±æ ‘çš„ç»“æœ
                )                 </code></pre>
</div>
<div id="åŠŸèƒ½4äº²ç¼˜å…³ç³»çŸ©é˜µçš„æ„å»ºag-and-h" class="section level3">
<h3>åŠŸèƒ½4ï¼šäº²ç¼˜å…³ç³»çŸ©é˜µçš„æ„å»º(A,G and H)</h3>
<pre class="R"><code>library(blupADC)
kinship_result=cal_kinship(
                input_data_hmp=data_hmp,           #ç”¨æˆ·è¾“å…¥çš„hapmapæ ¼å¼çš„æ•°æ®
                kinship_type=c(&quot;G_A&quot;,&quot;G_Domi&quot;),    #æ„å»ºçš„äº²ç¼˜å…³ç³»çŸ©é˜µçš„ç±»å‹
                inbred_type=c(&quot;Homozygous&quot;),       #è®¡ç®—çš„è¿‘äº¤ç³»æ•°çš„ç±»å‹
                output_matrix_type=c(&quot;col_three&quot;), #è¿”å›çš„äº²ç¼˜å…³ç³»çŸ©é˜µçš„æ ¼å¼ï¼š3åˆ—æ ¼å¼
                return_result=TRUE)                #åœ¨Rä¸­è¿”å›ç»“æœ               </code></pre>
</div>
<div id="åŠŸèƒ½5äº²ç¼˜å…³ç³»çŸ©é˜µçš„æ„å»ºag-and-h" class="section level3">
<h3>åŠŸèƒ½5ï¼šäº²ç¼˜å…³ç³»çŸ©é˜µçš„æ„å»º(A,G and H)</h3>
<pre class="R"><code>library(blupADC)
kinship_result=cal_kinship(
                input_data_hmp=data_hmp,           #ç”¨æˆ·è¾“å…¥çš„hapmapæ ¼å¼çš„æ•°æ®
                kinship_type=c(&quot;G_A&quot;,&quot;G_Domi&quot;),    #æ„å»ºçš„äº²ç¼˜å…³ç³»çŸ©é˜µçš„ç±»å‹
                inbred_type=c(&quot;Homozygous&quot;),       #è®¡ç®—çš„è¿‘äº¤ç³»æ•°çš„ç±»å‹
                output_matrix_type=c(&quot;col_three&quot;), #è¿”å›çš„äº²ç¼˜å…³ç³»çŸ©é˜µçš„æ ¼å¼ï¼š3åˆ—æ ¼å¼
                return_result=TRUE)                #åœ¨Rä¸­è¿”å›ç»“æœ               </code></pre>
</div>
<div id="åŠŸèƒ½6åŸºå› å‹æ•°æ®çš„è´¨æ§ä¸å¡«å……" class="section level3">
<h3>åŠŸèƒ½6ï¼šåŸºå› å‹æ•°æ®çš„è´¨æ§ä¸å¡«å……</h3>
<pre class="R"><code>library(blupADC)
genotype_data_QC_Imputation(
            input_data_path=&quot;root/genotype_data&quot;,   #ç”¨æˆ·è¾“å…¥çš„æœ¬åœ°åŸºå› å‹æ•°æ®çš„è·¯å¾„
            input_data_name=&quot;data_hmp.txt&quot;,         #ç”¨æˆ·è¾“å…¥çš„æœ¬åœ°åŸºå› å‹æ•°æ®çš„åç§°
            input_data_type=&quot;Hapmap&quot;,               #ç”¨æˆ·è¾“å…¥çš„åŸºå› å‹æ•°æ®çš„ç±»å‹
            method=&quot;QC_Imputation&quot;,                 #è´¨æ§å¡«å……æ–¹æ³•ï¼šè´¨æ§+å¡«å……
            plink_software_path=&quot;/root/software&quot;,   #plinkè½¯ä»¶çš„è·¯å¾„
            plink_software_name=&quot;plink&quot;,            #plinkè½¯ä»¶çš„åç§°
            beagle_software_path=&quot;root/software&quot;,   #beagleè½¯ä»¶çš„è·¯å¾„
            beagle_software_name=&quot;beagle.5.1.jar&quot;,  #beagleè½¯ä»¶çš„åç§°
            output_data_path=&quot;/root/result&quot;,        #è´¨æ§å¡«å……åï¼ŒåŸºå› å‹æ•°æ®ä¿å­˜åˆ°æœ¬åœ°çš„è·¯å¾„
            output_data_name=&quot;YY_data&quot;,             #è´¨æ§å¡«å……åï¼ŒåŸºå› å‹æ•°æ®ä¿å­˜åˆ°æœ¬åœ°çš„æ–‡ä»¶å
            output_data_type=&quot;Plink&quot;                #è´¨æ§å¡«å……åï¼ŒåŸºå› å‹æ•°æ®ä¿å­˜åˆ°æœ¬åœ°çš„ç±»å‹
            )                       </code></pre>
</div>
<div id="åŠŸèƒ½7åœ¨rä¸­è¿è¡Œdmuè½¯ä»¶å®Œæˆç›¸åº”çš„åˆ†æ" class="section level3">
<h3>åŠŸèƒ½7ï¼šåœ¨Rä¸­è¿è¡ŒDMUè½¯ä»¶ï¼Œå®Œæˆç›¸åº”çš„åˆ†æ</h3>
<pre class="R"><code>library(blupADC)
run_DMU(
        phe_col_names=c(&quot;Id&quot;,&quot;Sex&quot;,&quot;Herd_Year_Season&quot;,&quot;Litter&quot;, &quot;Trait1&quot;#,&quot;Trait2&quot;,&quot;Age&quot;),   #è¡¨å‹æ•°æ®çš„åˆ—å
        target_trait_name=c(&quot;Trait1&quot;),                               #ç›®æ ‡æ€§çŠ¶åç§°
        fixed_effect_name=list(c(&quot;Sex&quot;,&quot;Herd_Year_Season&quot;)),         #å›ºå®šæ•ˆåº”åç§°
        random_effect_name=list(c(&quot;Id&quot;,&quot;Litter&quot;)),                   #éšæœºæ•ˆåº”åç§°
        covariate_effect_name=list(c(&quot;Age&quot;)),                        #åå˜é‡åç§°
        phe_path=&quot;D:/test_code/BLUP_ADC_code/DMU_example&quot;,           #æœ¬åœ°è¡¨å‹æ•°æ®çš„è·¯å¾„
        phe_name=&quot;dmu_phe.txt&quot;,                                      #æœ¬åœ°è¡¨å‹æ•°æ®çš„åç§°
        integer_n=4,                                                 #æ•´å‹å˜é‡çš„ä¸ªæ•°
        analysis_model=&quot;PBLUP_A&quot;,                                    #é—ä¼ è¯„ä¼°çš„æ¨¡å‹
        dmu_module=&quot;dmuai&quot;,                                          #ä¼°è®¡æ–¹å·®ç»„åˆ†çš„DMUæ¨¡å—
        relationship_path=&quot;D:/test_code/BLUP_ADC_code/DMU_example&quot;,  #äº²ç¼˜å…³ç³»æ–‡ä»¶çš„æœ¬åœ°è·¯å¾„
        relationship_name=&quot;Dmu_ped.txt&quot;,                             #äº²ç¼˜å…³ç³»æ–‡ä»¶çš„æœ¬åœ°åç§°
        output_result_path=&quot;C:/Users/26564/Desktop&quot;,                 #DMUç»“æœä¿å­˜åˆ°æœ¬åœ°çš„è·¯å¾„
        output_ebv_path=&quot;C:/Users/26564/Desktop&quot;,                    #EBVç»“æœä¿å­˜åˆ°æœ¬åœ°çš„è·¯å¾„
        output_ebv_name=&quot;test&quot;,                                      #EBVç»“æœä¿å­˜åˆ°æœ¬åœ°çš„æ–‡ä»¶å
        DMU_software_path=&quot;D:/QGG-DMUv6-2/R5.2/bin&quot;                  #DMUè½¯ä»¶çš„æœ¬åœ°è·¯å¾„
        )</code></pre>
</div>
<div id="åŠŸèƒ½8åœ¨rä¸­è¿è¡Œblupf90è½¯ä»¶å®Œæˆç›¸åº”çš„åˆ†æ" class="section level3">
<h3>åŠŸèƒ½8ï¼šåœ¨Rä¸­è¿è¡ŒBLUPF90è½¯ä»¶ï¼Œå®Œæˆç›¸åº”çš„åˆ†æ</h3>
<pre class="R"><code>library(blupADC)
run_BLUPF90(        
            phe_col_names=c(&quot;Id&quot;,&quot;Sex&quot;,&quot;Herd_Year_Season&quot;,&quot;Litter&quot;, &quot;Trait1&quot;,&quot;Trait2&quot;,&quot;Age&quot;), #è¡¨å‹æ•°æ®çš„åˆ—å
            target_trait_name=c(&quot;Trait1&quot;),                               #ç›®æ ‡æ€§çŠ¶åç§°
            fixed_effect_name=list(c(&quot;Sex&quot;,&quot;Herd_Year_Season&quot;)),         #å›ºå®šæ•ˆåº”åç§°
            random_effect_name=list(c(&quot;Id&quot;,&quot;Litter&quot;)),                   #éšæœºæ•ˆåº”åç§°
            covariate_effect_name=list(c(&quot;Age&quot;)),                        #åå˜é‡æ•ˆåº”åç§°
            phe_path=&quot;D:/test_code/BLUP_ADC_code/DMU_example&quot;,           #æœ¬åœ°è¡¨å‹æ•°æ®çš„è·¯å¾„
            phe_name=&quot;dmu_phe.txt&quot;,                                      #æœ¬åœ°è¡¨å‹æ•°æ®çš„æ–‡ä»¶å
            analysis_model=&quot;PBLUP_A&quot;,                                    #é—ä¼ è¯„ä¼°çš„æ¨¡å‹ 
            relationship_path=&quot;D:/test_code/BLUP_ADC_code/DMU_example&quot;,  #äº²ç¼˜å…³ç³»æ–‡ä»¶çš„æœ¬åœ°è·¯å¾„
          relationship_name=&quot;Blupf90_ped.txt&quot;,                         #äº²ç¼˜å…³ç³»æ–‡ä»¶çš„æœ¬åœ°æ–‡ä»¶å
            output_result_path=&quot;C:/Users/26564/Desktop/BLUPF90&quot;,         #BLUPF90ç»“æœä¿å­˜åˆ°æœ¬åœ°çš„è·¯å¾„ 
            output_ebv_path=&quot;C:/Users/26564/Desktop/BLUPF90&quot;,            #EBVç»“æœä¿å­˜åˆ°æœ¬åœ°çš„è·¯å¾„
          output_ebv_name=&quot;test&quot;,                                        #EBVç»“æœä¿å­˜åˆ°æœ¬åœ°çš„æ–‡ä»¶å
            BLUPf90_software_path=&quot;D:/test_code/BLUPf90_software&quot;        #BLUPF90è½¯ä»¶çš„æœ¬åœ°è·¯å¾„
            )
            </code></pre>
</div>
