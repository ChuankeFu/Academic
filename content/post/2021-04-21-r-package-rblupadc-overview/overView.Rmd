---
title: 'R package:blupADC- Overview'
author: qsmei
date: '2021-04-13'
slug: overView
categories:
  - blupADC
tags: []
subtitle: ''
summary: 'å¯¹R package:blupADC çš„åŠŸèƒ½è¿›è¡Œç®€å•çš„ä»‹ç»'
authors: []
lastmod: '2021-04-13T22:32:36+08:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE)
```

å¤§å®¶å¥½,æœ¬èŠ‚æˆ‘ä»¬å°±æ­£å¼å¼€å§‹`blupADC`packageçš„å­¦ä¹ äº†ã€‚åœ¨æœ¬èŠ‚ï¼Œæˆ‘ä»¬ä¸»è¦æ˜¯å¯¹`blupADC`çš„åŠŸèƒ½åšä¸€ä¸ªç®€è¦çš„æ¦‚è¿°ã€‚ä¹‹åçš„ç« èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†ä¼šå¯¹å‡ ä¸ªé‡è¦çš„å‡½æ•°åˆ†åˆ«è¿›è¡Œè¿›ä¸€æ­¥çš„è®²è§£ã€‚

### ğŸ™Š**å®‰è£…**

ç›®å‰ï¼Œ`blupADC` å·²ç»ä¸Šä¼ åˆ°äº†**github**ä¸Šï¼Œå› æ­¤å¤§å®¶å¯ä»¥åœ¨**R**é‡Œé€šè¿‡å¦‚ä¸‹ä»£ç è¿›è¡Œå®‰è£…ï¼š

`devtools::install_github("qsmei/blupADC")`

æˆ–è€…ç›´æ¥åœ¨å‘½ä»¤è¡Œè¿›è¡Œå®‰è£…ï¼š

`R CMD INSTALL blupADC_1.0.tar.gz`

ğŸ’–ä¸‹é¢ï¼Œæˆ‘ä»¬å°†å°±`blupADC` ä¸­çš„å‡ ä¸ªä¸»è¦çš„åŠŸèƒ½è¿›è¡Œè®²è§£ï¼š

### åŠŸèƒ½1ï¼šåŸºå› å‹æ•°æ®é—´çš„æ ¼å¼è½¬æ¢

``` {.R}
library(blupADC)
sum_data=genotype_data_format_conversion(
         input_data_plink_ped=data_ped,  #ç”¨æˆ·è¾“å…¥çš„ plink-pedæ ¼å¼æ•°æ®
         input_data_plink_map=data_map,  #ç”¨æˆ·è¾“å…¥çš„ plink-mapæ ¼å¼æ•°æ®
         output_data_type=c("Hapmap","Blupf90"),#è¾“å‡ºçš„åŸºå› å‹æ•°æ®æ ¼å¼
         return_result = TRUE,      #åœ¨Rä¸­è¿”å›ç»“æœ
         cpu_cores=1                #è°ƒç”¨çš„cpuä¸ªæ•°
                  )
```

### åŠŸèƒ½2ï¼šé‡å¤åŸºå› å‹æ•°æ®æ£€æµ‹

``` {.R}
library(blupADC)
overlap_result=Calculate_genotype_overlap(
                  input_data_hmp=data_hmp,   #ç”¨æˆ·è¾“å…¥çš„hapmapæ ¼å¼çš„æ•°æ®
                  overlap_threshold=0.95,    #åˆ¤æ–­åŸºå› å‹é‡å¤çš„é˜ˆå€¼
                  return_result=TRUE         #åœ¨Rä¸­è¿”å›ç»“æœ
                  )
```

### åŠŸèƒ½3ï¼šç³»è°±è¿½æº¯ä¸é‡å‘½å

``` {.R}
library(blupADC)
pedigree_result=trace_pedigree(
                pedigree=data_pedigree,    #ç”¨æˆ·æä¾›çš„ç³»è°±æ•°æ®
                trace_generation=5ï¼Œ       #å‘ä¸Šè¿½æº¯çš„ç³»è°±ä»£æ•°
                output_pedigree_tree=TRUE  #è¾“å‡ºç³»è°±æ ‘çš„ç»“æœ
                )                 
```

### åŠŸèƒ½4ï¼šåŸºå› å‹æ•°æ®çš„è´¨æ§ä¸å¡«å……

``` {.R}
library(blupADC)
genotype_data_QC_Imputation(
            input_data_path="root/genotype_data",   #ç”¨æˆ·è¾“å…¥çš„æœ¬åœ°åŸºå› å‹æ•°æ®çš„è·¯å¾„
            input_data_name="data_hmp.txt",         #ç”¨æˆ·è¾“å…¥çš„æœ¬åœ°åŸºå› å‹æ•°æ®çš„åç§°
            input_data_type="Hapmap",               #ç”¨æˆ·è¾“å…¥çš„åŸºå› å‹æ•°æ®çš„ç±»å‹
            method="QC_Imputation",                 #è´¨æ§å¡«å……æ–¹æ³•ï¼šè´¨æ§+å¡«å……
            plink_software_path="/root/software",   #plinkè½¯ä»¶çš„è·¯å¾„
            plink_software_name="plink",            #plinkè½¯ä»¶çš„åç§°
            beagle_software_path="root/software",   #beagleè½¯ä»¶çš„è·¯å¾„
            beagle_software_name="beagle.5.1.jar",  #beagleè½¯ä»¶çš„åç§°
            output_data_path="/root/result",        #è´¨æ§å¡«å……åï¼ŒåŸºå› å‹æ•°æ®ä¿å­˜åˆ°æœ¬åœ°çš„è·¯å¾„
            output_data_name="YY_data",             #è´¨æ§å¡«å……åï¼ŒåŸºå› å‹æ•°æ®ä¿å­˜åˆ°æœ¬åœ°çš„æ–‡ä»¶å
            output_data_type="Plink"                #è´¨æ§å¡«å……åï¼ŒåŸºå› å‹æ•°æ®ä¿å­˜åˆ°æœ¬åœ°çš„ç±»å‹
			)                       
```

### åŠŸèƒ½5ï¼šäº²ç¼˜å…³ç³»çŸ©é˜µçš„æ„å»º(A,G and H)

``` {.R}
library(blupADC)
kinship_result=cal_kinship(
				input_data_hmp=data_hmp,           #ç”¨æˆ·è¾“å…¥çš„hapmapæ ¼å¼çš„æ•°æ®
                kinship_type=c("G_A","G_Domi"),    #æ„å»ºçš„äº²ç¼˜å…³ç³»çŸ©é˜µçš„ç±»å‹
                inbred_type=c("Homozygous"),       #è®¡ç®—çš„è¿‘äº¤ç³»æ•°çš„ç±»å‹
				output_matrix_type=c("col_three"), #è¿”å›çš„äº²ç¼˜å…³ç³»çŸ©é˜µçš„æ ¼å¼ï¼š3åˆ—æ ¼å¼
                return_result=TRUE)		           #åœ¨Rä¸­è¿”å›ç»“æœ	              
```

### åŠŸèƒ½6ï¼šåœ¨Rä¸­è¿è¡ŒDMUè½¯ä»¶ï¼Œå®Œæˆç›¸åº”çš„åˆ†æ

``` {.R}
library(blupADC)
run_DMU(
		phe_col_names=c("Id","Sex","Herd_Year_Season","Litter", "Trait1"#,"Trait2","Age"),   #è¡¨å‹æ•°æ®çš„åˆ—å
        target_trait_name=c("Trait1"),                               #ç›®æ ‡æ€§çŠ¶åç§°
        fixed_effect_name=list(c("Sex","Herd_Year_Season")),         #å›ºå®šæ•ˆåº”åç§°
        random_effect_name=list(c("Id","Litter")),                   #éšæœºæ•ˆåº”åç§°
        covariate_effect_name=list(c("Age")),                        #åå˜é‡åç§°
        phe_path="D:/test_code/BLUP_ADC_code/DMU_example",           #æœ¬åœ°è¡¨å‹æ•°æ®çš„è·¯å¾„
        phe_name="dmu_phe.txt",                                      #æœ¬åœ°è¡¨å‹æ•°æ®çš„åç§°
		integer_n=4,                                                 #æ•´å‹å˜é‡çš„ä¸ªæ•°
        analysis_model="PBLUP_A",                                    #é—ä¼ è¯„ä¼°çš„æ¨¡å‹
        dmu_module="dmuai",                                          #ä¼°è®¡æ–¹å·®ç»„åˆ†çš„DMUæ¨¡å—
        relationship_path="D:/test_code/BLUP_ADC_code/DMU_example",  #äº²ç¼˜å…³ç³»æ–‡ä»¶çš„æœ¬åœ°è·¯å¾„
		relationship_name="Dmu_ped.txt",                             #äº²ç¼˜å…³ç³»æ–‡ä»¶çš„æœ¬åœ°åç§°
        output_result_path="C:/Users/26564/Desktop",                 #DMUç»“æœä¿å­˜åˆ°æœ¬åœ°çš„è·¯å¾„
		output_ebv_path="C:/Users/26564/Desktop",                    #EBVç»“æœä¿å­˜åˆ°æœ¬åœ°çš„è·¯å¾„
		output_ebv_name="test",                                      #EBVç»“æœä¿å­˜åˆ°æœ¬åœ°çš„æ–‡ä»¶å
        DMU_software_path="D:/QGG-DMUv6-2/R5.2/bin"                  #DMUè½¯ä»¶çš„æœ¬åœ°è·¯å¾„
        )
```

### åŠŸèƒ½7ï¼šåœ¨Rä¸­è¿è¡ŒBLUPF90è½¯ä»¶ï¼Œå®Œæˆç›¸åº”çš„åˆ†æ

``` {.R}
library(blupADC)
run_BLUPF90(		
			phe_col_names=c("Id","Sex","Herd_Year_Season","Litter", "Trait1","Trait2","Age"), #è¡¨å‹æ•°æ®çš„åˆ—å
            target_trait_name=c("Trait1"),                               #ç›®æ ‡æ€§çŠ¶åç§°
            fixed_effect_name=list(c("Sex","Herd_Year_Season")),         #å›ºå®šæ•ˆåº”åç§°
            random_effect_name=list(c("Id","Litter")),                   #éšæœºæ•ˆåº”åç§°
            covariate_effect_name=list(c("Age")),                        #åå˜é‡æ•ˆåº”åç§°
            phe_path="D:/test_code/BLUP_ADC_code/DMU_example",           #æœ¬åœ°è¡¨å‹æ•°æ®çš„è·¯å¾„
            phe_name="dmu_phe.txt",                                      #æœ¬åœ°è¡¨å‹æ•°æ®çš„æ–‡ä»¶å
            analysis_model="PBLUP_A",                                    #é—ä¼ è¯„ä¼°çš„æ¨¡å‹ 
			relationship_path="D:/test_code/BLUP_ADC_code/DMU_example",  #äº²ç¼˜å…³ç³»æ–‡ä»¶çš„æœ¬åœ°è·¯å¾„
		  relationship_name="Blupf90_ped.txt",                         #äº²ç¼˜å…³ç³»æ–‡ä»¶çš„æœ¬åœ°æ–‡ä»¶å
			output_result_path="C:/Users/26564/Desktop/BLUPF90",         #BLUPF90ç»“æœä¿å­˜åˆ°æœ¬åœ°çš„è·¯å¾„ 
			output_ebv_path="C:/Users/26564/Desktop/BLUPF90",            #EBVç»“æœä¿å­˜åˆ°æœ¬åœ°çš„è·¯å¾„
		  output_ebv_name="test",					                     #EBVç»“æœä¿å­˜åˆ°æœ¬åœ°çš„æ–‡ä»¶å
			BLUPf90_software_path="D:/test_code/BLUPf90_software"        #BLUPF90è½¯ä»¶çš„æœ¬åœ°è·¯å¾„
			)
			
```
