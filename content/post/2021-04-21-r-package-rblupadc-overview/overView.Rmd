---
title: 'R package:blupADC- Overview'
author: qsmei
date: '2021-04-13'
slug: overView
categories:
  - blupADC
tags: []
subtitle: ''
summary: '对R package:blupADC 的功能进行简单的介绍'
authors: []
lastmod: '2021-04-13T22:32:36+08:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(collapse = TRUE)
```

大家好,本节我们就正式开始`blupADC`package的学习了。在本节，我们主要是对`blupADC`的功能做一个简要的概述。之后的章节中，我们将会对几个重要的函数分别进行进一步的讲解。

### 🙊**安装**

目前，`blupADC` 已经上传到了**github**上，因此大家可以在**R**里通过如下代码进行安装：

`devtools::install_github("qsmei/blupADC")`

或者直接在命令行进行安装：

`R CMD INSTALL blupADC_1.0.tar.gz`

💖下面，我们将就`blupADC` 中的几个主要的功能进行讲解：

### 功能1：基因型数据间的格式转换

``` {.R}
library(blupADC)
sum_data=genotype_data_format_conversion(
         input_data_plink_ped=data_ped,  #用户输入的 plink-ped格式数据
         input_data_plink_map=data_map,  #用户输入的 plink-map格式数据
         output_data_type=c("Hapmap","Blupf90"),#输出的基因型数据格式
         return_result = TRUE,      #在R中返回结果
         cpu_cores=1                #调用的cpu个数
                  )
```

### 功能2：重复基因型数据检测

``` {.R}
library(blupADC)
overlap_result=Calculate_genotype_overlap(
                  input_data_hmp=data_hmp,   #用户输入的hapmap格式的数据
                  overlap_threshold=0.95,    #判断基因型重复的阈值
                  return_result=TRUE         #在R中返回结果
                  )
```

### 功能3：系谱追溯与重命名

``` {.R}
library(blupADC)
pedigree_result=trace_pedigree(
                pedigree=data_pedigree,    #用户提供的系谱数据
                trace_generation=5，       #向上追溯的系谱代数
                output_pedigree_tree=TRUE  #输出系谱树的结果
                )                 
```

### 功能4：基因型数据的质控与填充

``` {.R}
library(blupADC)
genotype_data_QC_Imputation(
            input_data_path="root/genotype_data",   #用户输入的本地基因型数据的路径
            input_data_name="data_hmp.txt",         #用户输入的本地基因型数据的名称
            input_data_type="Hapmap",               #用户输入的基因型数据的类型
            method="QC_Imputation",                 #质控填充方法：质控+填充
            plink_software_path="/root/software",   #plink软件的路径
            plink_software_name="plink",            #plink软件的名称
            beagle_software_path="root/software",   #beagle软件的路径
            beagle_software_name="beagle.5.1.jar",  #beagle软件的名称
            output_data_path="/root/result",        #质控填充后，基因型数据保存到本地的路径
            output_data_name="YY_data",             #质控填充后，基因型数据保存到本地的文件名
            output_data_type="Plink"                #质控填充后，基因型数据保存到本地的类型
			)                       
```

### 功能5：亲缘关系矩阵的构建(A,G and H)

``` {.R}
library(blupADC)
kinship_result=cal_kinship(
				input_data_hmp=data_hmp,           #用户输入的hapmap格式的数据
                kinship_type=c("G_A","G_Domi"),    #构建的亲缘关系矩阵的类型
                inbred_type=c("Homozygous"),       #计算的近交系数的类型
				output_matrix_type=c("col_three"), #返回的亲缘关系矩阵的格式：3列格式
                return_result=TRUE)		           #在R中返回结果	              
```

### 功能6：在R中运行DMU软件，完成相应的分析

``` {.R}
library(blupADC)
run_DMU(
		phe_col_names=c("Id","Sex","Herd_Year_Season","Litter", "Trait1"#,"Trait2","Age"),   #表型数据的列名
        target_trait_name=c("Trait1"),                               #目标性状名称
        fixed_effect_name=list(c("Sex","Herd_Year_Season")),         #固定效应名称
        random_effect_name=list(c("Id","Litter")),                   #随机效应名称
        covariate_effect_name=list(c("Age")),                        #协变量名称
        phe_path="D:/test_code/BLUP_ADC_code/DMU_example",           #本地表型数据的路径
        phe_name="dmu_phe.txt",                                      #本地表型数据的名称
		integer_n=4,                                                 #整型变量的个数
        analysis_model="PBLUP_A",                                    #遗传评估的模型
        dmu_module="dmuai",                                          #估计方差组分的DMU模块
        relationship_path="D:/test_code/BLUP_ADC_code/DMU_example",  #亲缘关系文件的本地路径
		relationship_name="Dmu_ped.txt",                             #亲缘关系文件的本地名称
        output_result_path="C:/Users/26564/Desktop",                 #DMU结果保存到本地的路径
		output_ebv_path="C:/Users/26564/Desktop",                    #EBV结果保存到本地的路径
		output_ebv_name="test",                                      #EBV结果保存到本地的文件名
        DMU_software_path="D:/QGG-DMUv6-2/R5.2/bin"                  #DMU软件的本地路径
        )
```

### 功能7：在R中运行BLUPF90软件，完成相应的分析

``` {.R}
library(blupADC)
run_BLUPF90(		
			phe_col_names=c("Id","Sex","Herd_Year_Season","Litter", "Trait1","Trait2","Age"), #表型数据的列名
            target_trait_name=c("Trait1"),                               #目标性状名称
            fixed_effect_name=list(c("Sex","Herd_Year_Season")),         #固定效应名称
            random_effect_name=list(c("Id","Litter")),                   #随机效应名称
            covariate_effect_name=list(c("Age")),                        #协变量效应名称
            phe_path="D:/test_code/BLUP_ADC_code/DMU_example",           #本地表型数据的路径
            phe_name="dmu_phe.txt",                                      #本地表型数据的文件名
            analysis_model="PBLUP_A",                                    #遗传评估的模型 
			relationship_path="D:/test_code/BLUP_ADC_code/DMU_example",  #亲缘关系文件的本地路径
		  relationship_name="Blupf90_ped.txt",                         #亲缘关系文件的本地文件名
			output_result_path="C:/Users/26564/Desktop/BLUPF90",         #BLUPF90结果保存到本地的路径 
			output_ebv_path="C:/Users/26564/Desktop/BLUPF90",            #EBV结果保存到本地的路径
		  output_ebv_name="test",					                     #EBV结果保存到本地的文件名
			BLUPf90_software_path="D:/test_code/BLUPf90_software"        #BLUPF90软件的本地路径
			)
			
```
